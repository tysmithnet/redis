<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>redis: src/object.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">redis
   </div>
   <div id="projectbrief">Redis hacking</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">object.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="object_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* Redis Object implementation.</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Copyright (c) 2009-2012, Salvatore Sanfilippo &lt;antirez at gmail dot com&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * All rights reserved.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * Redistribution and use in source and binary forms, with or without</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * modification, are permitted provided that the following conditions are met:</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *   * Redistributions of source code must retain the above copyright notice,</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *     this list of conditions and the following disclaimer.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *   * Redistributions in binary form must reproduce the above copyright</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *     notice, this list of conditions and the following disclaimer in the</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *     documentation and/or other materials provided with the distribution.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *   * Neither the name of Redis nor the names of its contributors may be used</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *     to endorse or promote products derived from this software without</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *     specific prior written permission.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * POSSIBILITY OF SUCH DAMAGE.</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="server_8h.html">server.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;ctype.h&gt;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#ifdef __CYGWIN__</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#define strtold(a,b) ((long double)strtod((a),(b)))</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">/* ===================== Creation and parsing of objects ==================== */</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="server_8h.html#a5f534218574d15e8333875d10d7e7316">   41</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a5f534218574d15e8333875d10d7e7316">createObject</a>(<span class="keywordtype">int</span> type, <span class="keywordtype">void</span> *ptr) {</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *o = <a class="code" href="zmalloc_8c.html#a879ee0956348fd24dc2ac69c2d4f220b">zmalloc</a>(<span class="keyword">sizeof</span>(*o));</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> = type;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> = <a class="code" href="server_8h.html#a148bc85e3074e324a6dc5eebcad1bcd5">OBJ_ENCODING_RAW</a>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> = ptr;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#a6022c8a609170c7365fb96e83cb2df48">refcount</a> = 1;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">/* Set the LRU to the current lruclock (minutes resolution), or</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">     * alternatively the LFU counter. */</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a98440b0fba87820830ee90965c9f54f4">maxmemory_policy</a> &amp; <a class="code" href="server_8h.html#aac2d3ad7a604f87e06e25233dbd01c9b">MAXMEMORY_FLAG_LFU</a>) {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        o-&gt;<a class="code" href="structredis_object.html#abe5aec51795e89d8bdaf84d58d8eb00a">lru</a> = (<a class="code" href="evict_8c.html#a4b537077f1fe662170675678d354d93c">LFUGetTimeInMinutes</a>()&lt;&lt;8) | <a class="code" href="server_8h.html#a8cec44bf7da67aac58839ab5033bdc0a">LFU_INIT_VAL</a>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        o-&gt;<a class="code" href="structredis_object.html#abe5aec51795e89d8bdaf84d58d8eb00a">lru</a> = <a class="code" href="evict_8c.html#ae9e90615ee90c071a3fcade8ec7c72b3">LRU_CLOCK</a>();</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">/* Set a special refcount in the object to make it &quot;shared&quot;:</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"> * incrRefCount and decrRefCount() will test for this special refcount</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"> * and will not touch the object. This way it is free to access shared</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> * objects such as small integers from different threads without any</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> * mutex.</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"> * A common patter to create shared objects:</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> * robj *myobject = makeObjectShared(createObject(...));</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="server_8h.html#aa14f89ea2cc52c4e3d9ba91d85478a1c">   69</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#aa14f89ea2cc52c4e3d9ba91d85478a1c">makeObjectShared</a>(<a class="code" href="structredis_object.html">robj</a> *o) {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="server_8h.html#a88114b5169b4c382df6b56506285e56a">serverAssert</a>(o-&gt;<a class="code" href="structredis_object.html#a6022c8a609170c7365fb96e83cb2df48">refcount</a> == 1);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#a6022c8a609170c7365fb96e83cb2df48">refcount</a> = <a class="code" href="server_8h.html#a1dc2a137875b0c8ee0fa1df43684a7b8">OBJ_SHARED_REFCOUNT</a>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">/* Create a string object with encoding OBJ_ENCODING_RAW, that is a plain</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"> * string object where o-&gt;ptr points to a proper sds string. */</span></div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="server_8h.html#a85905658f263d18a5d422d275e5c18ac">   77</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a85905658f263d18a5d422d275e5c18ac">createRawStringObject</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *ptr, <span class="keywordtype">size_t</span> len) {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="object_8c.html#a5f534218574d15e8333875d10d7e7316">createObject</a>(<a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a>, <a class="code" href="sds_8c.html#a151062948f5ba54c50936e5d5317c417">sdsnewlen</a>(ptr,len));</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">/* Create a string object with encoding OBJ_ENCODING_EMBSTR, that is</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"> * an object where the sds string is actually an unmodifiable string</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"> * allocated in the same chunk as the object itself. */</span></div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="server_8h.html#afc552e6090cf7fa56b3db458078be7f1">   84</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#afc552e6090cf7fa56b3db458078be7f1">createEmbeddedStringObject</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *ptr, <span class="keywordtype">size_t</span> len) {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *o = <a class="code" href="zmalloc_8c.html#a879ee0956348fd24dc2ac69c2d4f220b">zmalloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="structredis_object.html">robj</a>)+<span class="keyword">sizeof</span>(<span class="keyword">struct</span> sdshdr8)+len+1);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keyword">struct </span>sdshdr8 *sh = (<span class="keywordtype">void</span>*)(o+1);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> = <a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a>;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> = <a class="code" href="server_8h.html#ac5bb76b546161fd0da4b0ff89b3142ee">OBJ_ENCODING_EMBSTR</a>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> = sh+1;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#a6022c8a609170c7365fb96e83cb2df48">refcount</a> = 1;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a98440b0fba87820830ee90965c9f54f4">maxmemory_policy</a> &amp; <a class="code" href="server_8h.html#aac2d3ad7a604f87e06e25233dbd01c9b">MAXMEMORY_FLAG_LFU</a>) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        o-&gt;<a class="code" href="structredis_object.html#abe5aec51795e89d8bdaf84d58d8eb00a">lru</a> = (<a class="code" href="evict_8c.html#a4b537077f1fe662170675678d354d93c">LFUGetTimeInMinutes</a>()&lt;&lt;8) | <a class="code" href="server_8h.html#a8cec44bf7da67aac58839ab5033bdc0a">LFU_INIT_VAL</a>;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        o-&gt;<a class="code" href="structredis_object.html#abe5aec51795e89d8bdaf84d58d8eb00a">lru</a> = <a class="code" href="evict_8c.html#ae9e90615ee90c071a3fcade8ec7c72b3">LRU_CLOCK</a>();</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    sh-&gt;len = len;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    sh-&gt;alloc = len;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    sh-&gt;flags = <a class="code" href="sds_8h.html#a504136356f04bfa2fd616dd4c8fdd71c">SDS_TYPE_8</a>;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">if</span> (ptr == <a class="code" href="sds_8c.html#a784d6789da0c845fdecf1c4caf49f9f7">SDS_NOINIT</a>)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        sh-&gt;buf[len] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ptr) {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        memcpy(sh-&gt;buf,ptr,len);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        sh-&gt;buf[len] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        memset(sh-&gt;buf,0,len+1);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">/* Create a string object with EMBSTR encoding if it is smaller than</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"> * OBJ_ENCODING_EMBSTR_SIZE_LIMIT, otherwise the RAW encoding is</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"> * used.</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"> * The current limit of 44 is chosen so that the biggest string object</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"> * we allocate as EMBSTR will still fit into the 64 byte arena of jemalloc. */</span></div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="object_8c.html#a3e762d5fac271c94b01875920ff57fb2">  118</a></span>&#160;<span class="preprocessor">#define OBJ_ENCODING_EMBSTR_SIZE_LIMIT 44</span></div><div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="server_8h.html#a58bf6fb802750d04c587b4d13a2f3c0a">  119</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a58bf6fb802750d04c587b4d13a2f3c0a">createStringObject</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *ptr, <span class="keywordtype">size_t</span> len) {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">if</span> (len &lt;= <a class="code" href="object_8c.html#a3e762d5fac271c94b01875920ff57fb2">OBJ_ENCODING_EMBSTR_SIZE_LIMIT</a>)</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="object_8c.html#afc552e6090cf7fa56b3db458078be7f1">createEmbeddedStringObject</a>(ptr,len);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="object_8c.html#a85905658f263d18a5d422d275e5c18ac">createRawStringObject</a>(ptr,len);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">/* Create a string object from a long long value. When possible returns a</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> * shared integer object, or at least an integer encoded one.</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"> * If valueobj is non zero, the function avoids returning a a shared</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"> * integer, because the object is going to be used as value in the Redis key</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"> * space (for instance when the INCR command is used), so we want LFU/LRU</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"> * values specific for each key. */</span></div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="object_8c.html#a49de04ba218b5603d00087cfc6029e82">  133</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a49de04ba218b5603d00087cfc6029e82">createStringObjectFromLongLongWithOptions</a>(<span class="keywordtype">long</span> <span class="keywordtype">long</span> value, <span class="keywordtype">int</span> valueobj) {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *o;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a7f900ab67c16f474082be15af9380a78">maxmemory</a> == 0 ||</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        !(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a98440b0fba87820830ee90965c9f54f4">maxmemory_policy</a> &amp; <a class="code" href="server_8h.html#a15f4654e0f62585fa6ea50ede84598d5">MAXMEMORY_FLAG_NO_SHARED_INTEGERS</a>))</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="comment">/* If the maxmemory policy permits, we can still return shared integers</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">         * even if valueobj is true. */</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        valueobj = 0;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">if</span> (value &gt;= 0 &amp;&amp; value &lt; <a class="code" href="server_8h.html#a311fc8b18b93af94e1ad418f1386b519">OBJ_SHARED_INTEGERS</a> &amp;&amp; valueobj == 0) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <a class="code" href="object_8c.html#aa84594b5dd7a5dda8201c15c85b1457a">incrRefCount</a>(<a class="code" href="server_8c.html#ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8">shared</a>.<a class="code" href="structshared_objects_struct.html#a0a900c43b0635b0afef2c83d7def52c7">integers</a>[value]);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        o = <a class="code" href="server_8c.html#ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8">shared</a>.<a class="code" href="structshared_objects_struct.html#a0a900c43b0635b0afef2c83d7def52c7">integers</a>[value];</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span> (value &gt;= LONG_MIN &amp;&amp; value &lt;= LONG_MAX) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            o = <a class="code" href="object_8c.html#a5f534218574d15e8333875d10d7e7316">createObject</a>(<a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a>, NULL);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> = <a class="code" href="server_8h.html#ae934cf008a0be0ef009c92c2d006a816">OBJ_ENCODING_INT</a>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> = (<span class="keywordtype">void</span>*)((<span class="keywordtype">long</span>)value);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            o = <a class="code" href="object_8c.html#a5f534218574d15e8333875d10d7e7316">createObject</a>(<a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a>,<a class="code" href="sds_8c.html#a500e60fc7a55cfcc571348ed422ba1de">sdsfromlonglong</a>(value));</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">/* Wrapper for createStringObjectFromLongLongWithOptions() always demanding</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"> * to create a shared object if possible. */</span></div><div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="server_8h.html#abb5873d69dbe9b2c5034c686d17d8c1d">  161</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#abb5873d69dbe9b2c5034c686d17d8c1d">createStringObjectFromLongLong</a>(<span class="keywordtype">long</span> <span class="keywordtype">long</span> value) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="object_8c.html#a49de04ba218b5603d00087cfc6029e82">createStringObjectFromLongLongWithOptions</a>(value,0);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">/* Wrapper for createStringObjectFromLongLongWithOptions() avoiding a shared</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> * object when LFU/LRU info are needed, that is, when the object is used</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> * as a value in the key space, and Redis is configured to evict based on</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"> * LFU/LRU. */</span></div><div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="server_8h.html#a94b3dee86e33a84f45d37fc957227559">  169</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a94b3dee86e33a84f45d37fc957227559">createStringObjectFromLongLongForValue</a>(<span class="keywordtype">long</span> <span class="keywordtype">long</span> value) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="object_8c.html#a49de04ba218b5603d00087cfc6029e82">createStringObjectFromLongLongWithOptions</a>(value,1);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">/* Create a string object from a long double. If humanfriendly is non-zero</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"> * it does not use exponential format and trims trailing zeroes at the end,</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"> * however this results in loss of precision. Otherwise exp format is used</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"> * and the output of snprintf() is not modified.</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"> * The &#39;humanfriendly&#39; option is used for INCRBYFLOAT and HINCRBYFLOAT. */</span></div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="server_8h.html#a828cbcce5d59a527c9a3d7c19bde3f3f">  179</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a828cbcce5d59a527c9a3d7c19bde3f3f">createStringObjectFromLongDouble</a>(<span class="keywordtype">long</span> <span class="keywordtype">double</span> value, <span class="keywordtype">int</span> humanfriendly) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordtype">char</span> buf[<a class="code" href="util_8h.html#a29779c072e924ef4e3c8186fd9748291">MAX_LONG_DOUBLE_CHARS</a>];</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">int</span> len = <a class="code" href="util_8c.html#a57f59b3ee2509f5ed9cae449e0a4d81a">ld2string</a>(buf,<span class="keyword">sizeof</span>(buf),value,humanfriendly);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="object_8c.html#a58bf6fb802750d04c587b4d13a2f3c0a">createStringObject</a>(buf,len);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;}</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">/* Duplicate a string object, with the guarantee that the returned object</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> * has the same encoding as the original one.</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"> * This function also guarantees that duplicating a small integere object</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"> * (or a string object that contains a representation of a small integer)</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"> * will always result in a fresh object that is unshared (refcount == 1).</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> * The resulting object always has refcount set to 1. */</span></div><div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="server_8h.html#a2b5eada89b890fd9bf2859c9bc7185d6">  193</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a2b5eada89b890fd9bf2859c9bc7185d6">dupStringObject</a>(<span class="keyword">const</span> <a class="code" href="structredis_object.html">robj</a> *o) {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *d;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="server_8h.html#a88114b5169b4c382df6b56506285e56a">serverAssert</a>(o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a>);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">switch</span>(o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a>) {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#a148bc85e3074e324a6dc5eebcad1bcd5">OBJ_ENCODING_RAW</a>:</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="object_8c.html#a85905658f263d18a5d422d275e5c18ac">createRawStringObject</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,sdslen(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>));</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#ac5bb76b546161fd0da4b0ff89b3142ee">OBJ_ENCODING_EMBSTR</a>:</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="object_8c.html#afc552e6090cf7fa56b3db458078be7f1">createEmbeddedStringObject</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,sdslen(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>));</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#ae934cf008a0be0ef009c92c2d006a816">OBJ_ENCODING_INT</a>:</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        d = <a class="code" href="object_8c.html#a5f534218574d15e8333875d10d7e7316">createObject</a>(<a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a>, NULL);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        d-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> = <a class="code" href="server_8h.html#ae934cf008a0be0ef009c92c2d006a816">OBJ_ENCODING_INT</a>;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        d-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> = o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">return</span> d;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Wrong encoding.&quot;</span>);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="server_8h.html#a2dcf3148f7c5b6631b3d42c3f6d1e29c">  214</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a2dcf3148f7c5b6631b3d42c3f6d1e29c">createQuicklistObject</a>(<span class="keywordtype">void</span>) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="structquicklist.html">quicklist</a> *l = <a class="code" href="quicklist_8c.html#ab4a7a85e7a80ef6cf36534f9c765f058">quicklistCreate</a>();</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *o = <a class="code" href="object_8c.html#a5f534218574d15e8333875d10d7e7316">createObject</a>(<a class="code" href="server_8h.html#a4a5f22a280949c97a0cb0d4213275126">OBJ_LIST</a>,l);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> = <a class="code" href="server_8h.html#aec792aeed6d4bf83966672e6a23043b8">OBJ_ENCODING_QUICKLIST</a>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="server_8h.html#a4a1211c9a32ce830f9f6682bc310357c">  221</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a4a1211c9a32ce830f9f6682bc310357c">createZiplistObject</a>(<span class="keywordtype">void</span>) {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *zl = <a class="code" href="ziplist_8c.html#a732833b234259c9c9b3d0dfd859f4f97">ziplistNew</a>();</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *o = <a class="code" href="object_8c.html#a5f534218574d15e8333875d10d7e7316">createObject</a>(<a class="code" href="server_8h.html#a4a5f22a280949c97a0cb0d4213275126">OBJ_LIST</a>,zl);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> = <a class="code" href="server_8h.html#aabf064ede983103f1fd0df2086e84eee">OBJ_ENCODING_ZIPLIST</a>;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;}</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="server_8h.html#a58920b17e6783e82f49a2baba4261093">  228</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a58920b17e6783e82f49a2baba4261093">createSetObject</a>(<span class="keywordtype">void</span>) {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="structdict.html">dict</a> *d = <a class="code" href="dict_8c.html#a2e3683dd52e527ad0df8d203d8943fb6">dictCreate</a>(&amp;<a class="code" href="server_8c.html#a6d37ca075aa0bff83305ecd2823ef744">setDictType</a>,NULL);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *o = <a class="code" href="object_8c.html#a5f534218574d15e8333875d10d7e7316">createObject</a>(<a class="code" href="server_8h.html#a8d179375a4aac33d3fa7aa80c8ccc75f">OBJ_SET</a>,d);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> = <a class="code" href="server_8h.html#a9c10219f68afc557d510d108257d238b">OBJ_ENCODING_HT</a>;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;}</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="server_8h.html#ab8fb80d55a55fc2fdaad8763b94c2207">  235</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#ab8fb80d55a55fc2fdaad8763b94c2207">createIntsetObject</a>(<span class="keywordtype">void</span>) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="structintset.html">intset</a> *is = <a class="code" href="intset_8c.html#a5f05ce0b2c1427fdc978b8a530d450eb">intsetNew</a>();</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *o = <a class="code" href="object_8c.html#a5f534218574d15e8333875d10d7e7316">createObject</a>(<a class="code" href="server_8h.html#a8d179375a4aac33d3fa7aa80c8ccc75f">OBJ_SET</a>,is);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> = <a class="code" href="server_8h.html#a214173987de21c3b7661fddd42b05873">OBJ_ENCODING_INTSET</a>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;}</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="server_8h.html#a5f0ed362e09930575ce97431dda2f987">  242</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a5f0ed362e09930575ce97431dda2f987">createHashObject</a>(<span class="keywordtype">void</span>) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *zl = <a class="code" href="ziplist_8c.html#a732833b234259c9c9b3d0dfd859f4f97">ziplistNew</a>();</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *o = <a class="code" href="object_8c.html#a5f534218574d15e8333875d10d7e7316">createObject</a>(<a class="code" href="server_8h.html#a87c05ba4f7f36741864277f02a4423fb">OBJ_HASH</a>, zl);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> = <a class="code" href="server_8h.html#aabf064ede983103f1fd0df2086e84eee">OBJ_ENCODING_ZIPLIST</a>;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;}</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="server_8h.html#ac18b9b0bcb75a95609aea70a882863d2">  249</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#ac18b9b0bcb75a95609aea70a882863d2">createZsetObject</a>(<span class="keywordtype">void</span>) {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="structzset.html">zset</a> *zs = <a class="code" href="zmalloc_8c.html#a879ee0956348fd24dc2ac69c2d4f220b">zmalloc</a>(<span class="keyword">sizeof</span>(*zs));</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *o;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    zs-&gt;<a class="code" href="structzset.html#aad961c2f260766ff3627bf363fef3551">dict</a> = <a class="code" href="dict_8c.html#a2e3683dd52e527ad0df8d203d8943fb6">dictCreate</a>(&amp;<a class="code" href="server_8c.html#a3b638a07aaedd8dc871d0bbd18a662b6">zsetDictType</a>,NULL);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    zs-&gt;<a class="code" href="structzset.html#a38454c6ad0755efc07170e913ec10b5a">zsl</a> = <a class="code" href="server_8h.html#ad139d741d814f1bf2927845ea6509e04">zslCreate</a>();</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    o = <a class="code" href="object_8c.html#a5f534218574d15e8333875d10d7e7316">createObject</a>(<a class="code" href="server_8h.html#a8c356422ddbc03bd77694880a30a1953">OBJ_ZSET</a>,zs);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> = <a class="code" href="server_8h.html#acfb35db5cb30ed113ed23aeb1a224c4c">OBJ_ENCODING_SKIPLIST</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="server_8h.html#a4163ff8fa0cd1864c6ea78bcffa54589">  260</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a4163ff8fa0cd1864c6ea78bcffa54589">createZsetZiplistObject</a>(<span class="keywordtype">void</span>) {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *zl = <a class="code" href="ziplist_8c.html#a732833b234259c9c9b3d0dfd859f4f97">ziplistNew</a>();</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *o = <a class="code" href="object_8c.html#a5f534218574d15e8333875d10d7e7316">createObject</a>(<a class="code" href="server_8h.html#a8c356422ddbc03bd77694880a30a1953">OBJ_ZSET</a>,zl);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> = <a class="code" href="server_8h.html#aabf064ede983103f1fd0df2086e84eee">OBJ_ENCODING_ZIPLIST</a>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;}</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="server_8h.html#a6ba807c719b2ce522847bd794a789c85">  267</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a6ba807c719b2ce522847bd794a789c85">createStreamObject</a>(<span class="keywordtype">void</span>) {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="structstream.html">stream</a> *s = <a class="code" href="stream_8h.html#a7feb7e95b8c6a01a8359be263f921eb9">streamNew</a>();</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *o = <a class="code" href="object_8c.html#a5f534218574d15e8333875d10d7e7316">createObject</a>(<a class="code" href="server_8h.html#a2c2cc41300ca6b9daca7ea8a6d66edc6">OBJ_STREAM</a>,s);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> = <a class="code" href="server_8h.html#a8ed2d5ecb3c5343c4286f9c3a2346045">OBJ_ENCODING_STREAM</a>;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="server_8h.html#a794a7928c34cfe1ae50146fe13e9179a">  274</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a794a7928c34cfe1ae50146fe13e9179a">createModuleObject</a>(<a class="code" href="struct_redis_module_type.html">moduleType</a> *mt, <span class="keywordtype">void</span> *value) {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="structmodule_value.html">moduleValue</a> *mv = <a class="code" href="zmalloc_8c.html#a879ee0956348fd24dc2ac69c2d4f220b">zmalloc</a>(<span class="keyword">sizeof</span>(*mv));</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    mv-&gt;<a class="code" href="structmodule_value.html#a05eee39e39e34439ea77af35b597b1ae">type</a> = mt;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    mv-&gt;<a class="code" href="structmodule_value.html#a0f61d63b009d0880a89c843bd50d8d76">value</a> = value;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="object_8c.html#a5f534218574d15e8333875d10d7e7316">createObject</a>(<a class="code" href="server_8h.html#a92c1fed85f709180fda0ff10d37d649b">OBJ_MODULE</a>,mv);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;}</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="server_8h.html#a7317d00fbb81c4cfe09e68ee60979cfb">  281</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="object_8c.html#a7317d00fbb81c4cfe09e68ee60979cfb">freeStringObject</a>(<a class="code" href="structredis_object.html">robj</a> *o) {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#a148bc85e3074e324a6dc5eebcad1bcd5">OBJ_ENCODING_RAW</a>) {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="sds_8c.html#a4d9266a6b2d5a98f0df0ac62f51324fd">sdsfree</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="server_8h.html#ab42800614721abadb142208f8e72cc9d">  287</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="object_8c.html#ab42800614721abadb142208f8e72cc9d">freeListObject</a>(<a class="code" href="structredis_object.html">robj</a> *o) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#aec792aeed6d4bf83966672e6a23043b8">OBJ_ENCODING_QUICKLIST</a>) {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="quicklist_8c.html#a75c42e6e2bf61575be3806910d0afea2">quicklistRelease</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Unknown list encoding type&quot;</span>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="server_8h.html#a9d03597c960b9cbed2bd71bd2d6fd5f1">  295</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="object_8c.html#a9d03597c960b9cbed2bd71bd2d6fd5f1">freeSetObject</a>(<a class="code" href="structredis_object.html">robj</a> *o) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">switch</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a>) {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#a9c10219f68afc557d510d108257d238b">OBJ_ENCODING_HT</a>:</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <a class="code" href="dict_8c.html#ad6a0d56f36a07445b16ffedcf5aec005">dictRelease</a>((<a class="code" href="structdict.html">dict</a>*) o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#a214173987de21c3b7661fddd42b05873">OBJ_ENCODING_INTSET</a>:</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <a class="code" href="zmalloc_8c.html#ae6638523882220721b9e7cdc7b2cd58d">zfree</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Unknown set encoding type&quot;</span>);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="server_8h.html#a860552c3f312632c9481eb8fdc5108bb">  308</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="object_8c.html#a860552c3f312632c9481eb8fdc5108bb">freeZsetObject</a>(<a class="code" href="structredis_object.html">robj</a> *o) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="structzset.html">zset</a> *zs;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">switch</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a>) {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#acfb35db5cb30ed113ed23aeb1a224c4c">OBJ_ENCODING_SKIPLIST</a>:</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        zs = o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="dict_8c.html#ad6a0d56f36a07445b16ffedcf5aec005">dictRelease</a>(zs-&gt;<a class="code" href="structzset.html#aad961c2f260766ff3627bf363fef3551">dict</a>);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <a class="code" href="server_8h.html#aa1a892baaa2587c7787c2e9bcf34abfd">zslFree</a>(zs-&gt;<a class="code" href="structzset.html#a38454c6ad0755efc07170e913ec10b5a">zsl</a>);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <a class="code" href="zmalloc_8c.html#ae6638523882220721b9e7cdc7b2cd58d">zfree</a>(zs);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#aabf064ede983103f1fd0df2086e84eee">OBJ_ENCODING_ZIPLIST</a>:</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <a class="code" href="zmalloc_8c.html#ae6638523882220721b9e7cdc7b2cd58d">zfree</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Unknown sorted set encoding&quot;</span>);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;}</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno"><a class="line" href="server_8h.html#aae30d790d50c2301ada8c68f9c554dd6">  325</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="object_8c.html#aae30d790d50c2301ada8c68f9c554dd6">freeHashObject</a>(<a class="code" href="structredis_object.html">robj</a> *o) {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">switch</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a>) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#a9c10219f68afc557d510d108257d238b">OBJ_ENCODING_HT</a>:</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <a class="code" href="dict_8c.html#ad6a0d56f36a07445b16ffedcf5aec005">dictRelease</a>((<a class="code" href="structdict.html">dict</a>*) o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#aabf064ede983103f1fd0df2086e84eee">OBJ_ENCODING_ZIPLIST</a>:</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <a class="code" href="zmalloc_8c.html#ae6638523882220721b9e7cdc7b2cd58d">zfree</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Unknown hash encoding type&quot;</span>);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;}</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="object_8c.html#a4678c8cf824a0745311c39fb8f300290">  339</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="object_8c.html#a4678c8cf824a0745311c39fb8f300290">freeModuleObject</a>(<a class="code" href="structredis_object.html">robj</a> *o) {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="structmodule_value.html">moduleValue</a> *mv = o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    mv-&gt;<a class="code" href="structmodule_value.html#a05eee39e39e34439ea77af35b597b1ae">type</a>-&gt;<a class="code" href="struct_redis_module_type.html#a966c47580ef5f4abf50e4109df7168ad">free</a>(mv-&gt;<a class="code" href="structmodule_value.html#a0f61d63b009d0880a89c843bd50d8d76">value</a>);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="zmalloc_8c.html#ae6638523882220721b9e7cdc7b2cd58d">zfree</a>(mv);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;}</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno"><a class="line" href="object_8c.html#a6bdcf469e2903315a2ecf46c2e058e1c">  345</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="object_8c.html#a6bdcf469e2903315a2ecf46c2e058e1c">freeStreamObject</a>(<a class="code" href="structredis_object.html">robj</a> *o) {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="stream_8h.html#a7273f6aa620d8e38a087bf59dd070547">freeStream</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;}</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="server_8h.html#aa84594b5dd7a5dda8201c15c85b1457a">  349</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="object_8c.html#aa84594b5dd7a5dda8201c15c85b1457a">incrRefCount</a>(<a class="code" href="structredis_object.html">robj</a> *o) {</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#a6022c8a609170c7365fb96e83cb2df48">refcount</a> != <a class="code" href="server_8h.html#a1dc2a137875b0c8ee0fa1df43684a7b8">OBJ_SHARED_REFCOUNT</a>) o-&gt;<a class="code" href="structredis_object.html#a6022c8a609170c7365fb96e83cb2df48">refcount</a>++;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="server_8h.html#a03474153296385df26f24b265d2a22eb">  353</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="object_8c.html#a03474153296385df26f24b265d2a22eb">decrRefCount</a>(<a class="code" href="structredis_object.html">robj</a> *o) {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#a6022c8a609170c7365fb96e83cb2df48">refcount</a> == 1) {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">switch</span>(o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a>) {</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a>: <a class="code" href="object_8c.html#a7317d00fbb81c4cfe09e68ee60979cfb">freeStringObject</a>(o); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="server_8h.html#a4a5f22a280949c97a0cb0d4213275126">OBJ_LIST</a>: <a class="code" href="object_8c.html#ab42800614721abadb142208f8e72cc9d">freeListObject</a>(o); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="server_8h.html#a8d179375a4aac33d3fa7aa80c8ccc75f">OBJ_SET</a>: <a class="code" href="object_8c.html#a9d03597c960b9cbed2bd71bd2d6fd5f1">freeSetObject</a>(o); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="server_8h.html#a8c356422ddbc03bd77694880a30a1953">OBJ_ZSET</a>: <a class="code" href="object_8c.html#a860552c3f312632c9481eb8fdc5108bb">freeZsetObject</a>(o); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="server_8h.html#a87c05ba4f7f36741864277f02a4423fb">OBJ_HASH</a>: <a class="code" href="object_8c.html#aae30d790d50c2301ada8c68f9c554dd6">freeHashObject</a>(o); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="server_8h.html#a92c1fed85f709180fda0ff10d37d649b">OBJ_MODULE</a>: <a class="code" href="object_8c.html#a4678c8cf824a0745311c39fb8f300290">freeModuleObject</a>(o); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="server_8h.html#a2c2cc41300ca6b9daca7ea8a6d66edc6">OBJ_STREAM</a>: <a class="code" href="object_8c.html#a6bdcf469e2903315a2ecf46c2e058e1c">freeStreamObject</a>(o); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">default</span>: <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Unknown object type&quot;</span>); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <a class="code" href="zmalloc_8c.html#ae6638523882220721b9e7cdc7b2cd58d">zfree</a>(o);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#a6022c8a609170c7365fb96e83cb2df48">refcount</a> &lt;= 0) <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;decrRefCount against refcount &lt;= 0&quot;</span>);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#a6022c8a609170c7365fb96e83cb2df48">refcount</a> != <a class="code" href="server_8h.html#a1dc2a137875b0c8ee0fa1df43684a7b8">OBJ_SHARED_REFCOUNT</a>) o-&gt;<a class="code" href="structredis_object.html#a6022c8a609170c7365fb96e83cb2df48">refcount</a>--;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;}</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">/* This variant of decrRefCount() gets its argument as void, and is useful</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"> * as free method in data structures that expect a &#39;void free_object(void*)&#39;</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"> * prototype for the free method. */</span></div><div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="server_8h.html#a8362c0e483b38b8debe5979f4dbe883b">  375</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="object_8c.html#a8362c0e483b38b8debe5979f4dbe883b">decrRefCountVoid</a>(<span class="keywordtype">void</span> *o) {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <a class="code" href="object_8c.html#a03474153296385df26f24b265d2a22eb">decrRefCount</a>(o);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;}</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">/* This function set the ref count to zero without freeing the object.</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"> * It is useful in order to pass a new object to functions incrementing</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment"> * the ref count of the received object. Example:</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"> *    functionThatWillIncrementRefCount(resetRefCount(CreateObject(...)));</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"> * Otherwise you need to resort to the less elegant pattern:</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"> *    *obj = createObject(...);</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"> *    functionThatWillIncrementRefCount(obj);</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment"> *    decrRefCount(obj);</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="server_8h.html#af22e46f03c49934062838d3208bd3fa1">  391</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#af22e46f03c49934062838d3208bd3fa1">resetRefCount</a>(<a class="code" href="structredis_object.html">robj</a> *obj) {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    obj-&gt;<a class="code" href="structredis_object.html#a6022c8a609170c7365fb96e83cb2df48">refcount</a> = 0;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">return</span> obj;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;}</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="server_8h.html#a8c2fcb5a9e55b784002397ecee2619d7">  396</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="object_8c.html#a8c2fcb5a9e55b784002397ecee2619d7">checkType</a>(<a class="code" href="structclient.html">client</a> *c, <a class="code" href="structredis_object.html">robj</a> *o, <span class="keywordtype">int</span> type) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> != type) {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <a class="code" href="networking_8c.html#ac47c2cfd2a6d524fcbfefa9a18e3a9a3">addReply</a>(c,<a class="code" href="server_8c.html#ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8">shared</a>.<a class="code" href="structshared_objects_struct.html#a72d93f8c752cbe76e225113137ac21ec">wrongtypeerr</a>);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="server_8h.html#a1404413f92cc603c272880c75415321b">  404</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="object_8c.html#a1404413f92cc603c272880c75415321b">isSdsRepresentableAsLongLong</a>(<a class="code" href="sds_8h.html#ad69abac3df4532879db9642c95f5ef6f">sds</a> s, <span class="keywordtype">long</span> <span class="keywordtype">long</span> *llval) {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="util_8c.html#a5c8ac146ff5b5323cacafbeb0e53cda0">string2ll</a>(s,sdslen(s),llval) ? <a class="code" href="server_8h.html#a303769ef1065076e68731584e758d3e1">C_OK</a> : <a class="code" href="server_8h.html#af98ac28d5f4d23d7ed5985188e6fb7d1">C_ERR</a>;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;}</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="server_8h.html#a5f37db6c8d0733b4057090ade306eb42">  408</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="object_8c.html#a6c17958992e396575864ce48574349c7">isObjectRepresentableAsLongLong</a>(<a class="code" href="structredis_object.html">robj</a> *o, <span class="keywordtype">long</span> <span class="keywordtype">long</span> *llval) {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="server_8h.html#a7308f76cbff9a8d3797fe78190b91282">serverAssertWithInfo</a>(NULL,o,o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#ae934cf008a0be0ef009c92c2d006a816">OBJ_ENCODING_INT</a>) {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">if</span> (llval) *llval = (long) o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="server_8h.html#a303769ef1065076e68731584e758d3e1">C_OK</a>;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="object_8c.html#a1404413f92cc603c272880c75415321b">isSdsRepresentableAsLongLong</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,llval);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;}</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">/* Try to encode a string object in order to save space */</span></div><div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="server_8h.html#a69038fedc976828a3dfc5f106c478544">  419</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a69038fedc976828a3dfc5f106c478544">tryObjectEncoding</a>(<a class="code" href="structredis_object.html">robj</a> *o) {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordtype">long</span> value;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="sds_8h.html#ad69abac3df4532879db9642c95f5ef6f">sds</a> s = o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordtype">size_t</span> len;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">/* Make sure this is a string object, the only type we encode</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">     * in this function. Other types use encoded memory efficient</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">     * representations but are handled by the commands implementing</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">     * the type. */</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="server_8h.html#a7308f76cbff9a8d3797fe78190b91282">serverAssertWithInfo</a>(NULL,o,o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a>);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">/* We try some specialized encoding only for objects that are</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">     * RAW or EMBSTR encoded, in other words objects that are still</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">     * in represented by an actually array of chars. */</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="server_8h.html#afcfb5bd97af52d1dbce331745cae030c">sdsEncodedObject</a>(o)) <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">/* It&#39;s not safe to encode shared objects: shared objects can be shared</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">     * everywhere in the &quot;object space&quot; of Redis and may end in places where</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">     * they are not handled. We handle them only as values in the keyspace. */</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;     <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#a6022c8a609170c7365fb96e83cb2df48">refcount</a> &gt; 1) <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">/* Check if we can represent this string as a long integer.</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">     * Note that we are sure that a string larger than 20 chars is not</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">     * representable as a 32 nor 64 bit integer. */</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    len = sdslen(s);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> (len &lt;= 20 &amp;&amp; <a class="code" href="util_8c.html#a6d96e71d47983f1e1e41448dd912e4e1">string2l</a>(s,len,&amp;value)) {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="comment">/* This object is encodable as a long. Try to use a shared object.</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">         * Note that we avoid using shared integers when maxmemory is used</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">         * because every object needs to have a private LRU field for the LRU</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">         * algorithm to work well. */</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a7f900ab67c16f474082be15af9380a78">maxmemory</a> == 0 ||</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            !(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a98440b0fba87820830ee90965c9f54f4">maxmemory_policy</a> &amp; <a class="code" href="server_8h.html#a15f4654e0f62585fa6ea50ede84598d5">MAXMEMORY_FLAG_NO_SHARED_INTEGERS</a>)) &amp;&amp;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            value &gt;= 0 &amp;&amp;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            value &lt; <a class="code" href="server_8h.html#a311fc8b18b93af94e1ad418f1386b519">OBJ_SHARED_INTEGERS</a>)</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <a class="code" href="object_8c.html#a03474153296385df26f24b265d2a22eb">decrRefCount</a>(o);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <a class="code" href="object_8c.html#aa84594b5dd7a5dda8201c15c85b1457a">incrRefCount</a>(<a class="code" href="server_8c.html#ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8">shared</a>.<a class="code" href="structshared_objects_struct.html#a0a900c43b0635b0afef2c83d7def52c7">integers</a>[value]);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="server_8c.html#ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8">shared</a>.<a class="code" href="structshared_objects_struct.html#a0a900c43b0635b0afef2c83d7def52c7">integers</a>[value];</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#a148bc85e3074e324a6dc5eebcad1bcd5">OBJ_ENCODING_RAW</a>) <a class="code" href="sds_8c.html#a4d9266a6b2d5a98f0df0ac62f51324fd">sdsfree</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> = <a class="code" href="server_8h.html#ae934cf008a0be0ef009c92c2d006a816">OBJ_ENCODING_INT</a>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> = (<span class="keywordtype">void</span>*) value;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">/* If the string is small and is still RAW encoded,</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">     * try the EMBSTR encoding which is more efficient.</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">     * In this representation the object and the SDS string are allocated</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">     * in the same chunk of memory to save space and cache misses. */</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">if</span> (len &lt;= <a class="code" href="object_8c.html#a3e762d5fac271c94b01875920ff57fb2">OBJ_ENCODING_EMBSTR_SIZE_LIMIT</a>) {</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <a class="code" href="structredis_object.html">robj</a> *emb;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#ac5bb76b546161fd0da4b0ff89b3142ee">OBJ_ENCODING_EMBSTR</a>) <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        emb = <a class="code" href="object_8c.html#afc552e6090cf7fa56b3db458078be7f1">createEmbeddedStringObject</a>(s,sdslen(s));</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <a class="code" href="object_8c.html#a03474153296385df26f24b265d2a22eb">decrRefCount</a>(o);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="keywordflow">return</span> emb;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">/* We can&#39;t encode the object...</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">     * Do the last try, and at least optimize the SDS string inside</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">     * the string object to require little space, in case there</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">     * is more than 10% of free space at the end of the SDS string.</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">     * We do that only for relatively large strings as this branch</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">     * is only entered if the length of the string is greater than</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">     * OBJ_ENCODING_EMBSTR_SIZE_LIMIT. */</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#a148bc85e3074e324a6dc5eebcad1bcd5">OBJ_ENCODING_RAW</a> &amp;&amp;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        sdsavail(s) &gt; len/10)</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> = <a class="code" href="sds_8c.html#a12cf0d8aca38e55eef468cc0265ef473">sdsRemoveFreeSpace</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">/* Return the original object. */</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">/* Get a decoded version of an encoded object (returned as a new object).</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment"> * If the object is already raw-encoded just increment the ref count. */</span></div><div class="line"><a name="l00499"></a><span class="lineno"><a class="line" href="server_8h.html#a42d455241ac5e34b9db676b6e7a23cef">  499</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a42d455241ac5e34b9db676b6e7a23cef">getDecodedObject</a>(<a class="code" href="structredis_object.html">robj</a> *o) {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *dec;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="server_8h.html#afcfb5bd97af52d1dbce331745cae030c">sdsEncodedObject</a>(o)) {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <a class="code" href="object_8c.html#aa84594b5dd7a5dda8201c15c85b1457a">incrRefCount</a>(o);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">return</span> o;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a> &amp;&amp; o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#ae934cf008a0be0ef009c92c2d006a816">OBJ_ENCODING_INT</a>) {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordtype">char</span> buf[32];</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <a class="code" href="util_8c.html#a0ec291923d3b4034b8200ac45b97d1b6">ll2string</a>(buf,32,(<span class="keywordtype">long</span>)o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        dec = <a class="code" href="object_8c.html#a58bf6fb802750d04c587b4d13a2f3c0a">createStringObject</a>(buf,strlen(buf));</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keywordflow">return</span> dec;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Unknown encoding type&quot;</span>);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    }</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;}</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">/* Compare two string objects via strcmp() or strcoll() depending on flags.</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"> * Note that the objects may be integer-encoded. In such a case we</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment"> * use ll2string() to get a string representation of the numbers on the stack</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment"> * and compare the strings, it&#39;s much faster than calling getDecodedObject().</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment"> * Important note: when REDIS_COMPARE_BINARY is used a binary-safe comparison</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment"> * is used. */</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno"><a class="line" href="object_8c.html#ac672f1c478e4a045035444729510d946">  525</a></span>&#160;<span class="preprocessor">#define REDIS_COMPARE_BINARY (1&lt;&lt;0)</span></div><div class="line"><a name="l00526"></a><span class="lineno"><a class="line" href="object_8c.html#aa471c38fc2e9e96a23693e7ff5e73209">  526</a></span>&#160;<span class="preprocessor">#define REDIS_COMPARE_COLL (1&lt;&lt;1)</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno"><a class="line" href="object_8c.html#ae6b84426afc2eaecaffcaa0628fa5a47">  528</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="object_8c.html#ae6b84426afc2eaecaffcaa0628fa5a47">compareStringObjectsWithFlags</a>(<a class="code" href="structredis_object.html">robj</a> *a, <a class="code" href="structredis_object.html">robj</a> *b, <span class="keywordtype">int</span> flags) {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <a class="code" href="server_8h.html#a7308f76cbff9a8d3797fe78190b91282">serverAssertWithInfo</a>(NULL,a,a-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a> &amp;&amp; b-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a>);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordtype">char</span> bufa[128], bufb[128], *astr, *bstr;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordtype">size_t</span> alen, blen, minlen;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordflow">if</span> (a == b) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="server_8h.html#afcfb5bd97af52d1dbce331745cae030c">sdsEncodedObject</a>(a)) {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        astr = a-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        alen = sdslen(astr);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        alen = <a class="code" href="util_8c.html#a0ec291923d3b4034b8200ac45b97d1b6">ll2string</a>(bufa,<span class="keyword">sizeof</span>(bufa),(<span class="keywordtype">long</span>) a-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        astr = bufa;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="server_8h.html#afcfb5bd97af52d1dbce331745cae030c">sdsEncodedObject</a>(b)) {</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        bstr = b-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        blen = sdslen(bstr);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        blen = <a class="code" href="util_8c.html#a0ec291923d3b4034b8200ac45b97d1b6">ll2string</a>(bufb,<span class="keyword">sizeof</span>(bufb),(<span class="keywordtype">long</span>) b-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        bstr = bufb;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="object_8c.html#aa471c38fc2e9e96a23693e7ff5e73209">REDIS_COMPARE_COLL</a>) {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="keywordflow">return</span> strcoll(astr,bstr);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordtype">int</span> cmp;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        minlen = (alen &lt; blen) ? alen : blen;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        cmp = memcmp(astr,bstr,minlen);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordflow">if</span> (cmp == 0) <span class="keywordflow">return</span> alen-blen;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordflow">return</span> cmp;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;}</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">/* Wrapper for compareStringObjectsWithFlags() using binary comparison. */</span></div><div class="line"><a name="l00561"></a><span class="lineno"><a class="line" href="server_8h.html#a1b107d21fcb90b8c57203904e96c02f3">  561</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="object_8c.html#a1b107d21fcb90b8c57203904e96c02f3">compareStringObjects</a>(<a class="code" href="structredis_object.html">robj</a> *a, <a class="code" href="structredis_object.html">robj</a> *b) {</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="object_8c.html#ae6b84426afc2eaecaffcaa0628fa5a47">compareStringObjectsWithFlags</a>(a,b,<a class="code" href="object_8c.html#ac672f1c478e4a045035444729510d946">REDIS_COMPARE_BINARY</a>);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;}</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">/* Wrapper for compareStringObjectsWithFlags() using collation. */</span></div><div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="server_8h.html#a27f308f6b75cf83cde04d51399a6e014">  566</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="object_8c.html#a27f308f6b75cf83cde04d51399a6e014">collateStringObjects</a>(<a class="code" href="structredis_object.html">robj</a> *a, <a class="code" href="structredis_object.html">robj</a> *b) {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="object_8c.html#ae6b84426afc2eaecaffcaa0628fa5a47">compareStringObjectsWithFlags</a>(a,b,<a class="code" href="object_8c.html#aa471c38fc2e9e96a23693e7ff5e73209">REDIS_COMPARE_COLL</a>);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;}</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">/* Equal string objects return 1 if the two objects are the same from the</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"> * point of view of a string comparison, otherwise 0 is returned. Note that</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment"> * this function is faster then checking for (compareStringObject(a,b) == 0)</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"> * because it can perform some more optimization. */</span></div><div class="line"><a name="l00574"></a><span class="lineno"><a class="line" href="server_8h.html#a0fb3848777c9ddaac670a2ee174546dd">  574</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="object_8c.html#a0fb3848777c9ddaac670a2ee174546dd">equalStringObjects</a>(<a class="code" href="structredis_object.html">robj</a> *a, <a class="code" href="structredis_object.html">robj</a> *b) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#ae934cf008a0be0ef009c92c2d006a816">OBJ_ENCODING_INT</a> &amp;&amp;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        b-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#ae934cf008a0be0ef009c92c2d006a816">OBJ_ENCODING_INT</a>){</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="comment">/* If both strings are integer encoded just check if the stored</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">         * long is the same. */</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">return</span> a-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> == b-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="object_8c.html#a1b107d21fcb90b8c57203904e96c02f3">compareStringObjects</a>(a,b) == 0;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    }</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;}</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno"><a class="line" href="server_8h.html#a869b8cea49f26cb18bf1138839696480">  585</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="object_8c.html#a869b8cea49f26cb18bf1138839696480">stringObjectLen</a>(<a class="code" href="structredis_object.html">robj</a> *o) {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="server_8h.html#a7308f76cbff9a8d3797fe78190b91282">serverAssertWithInfo</a>(NULL,o,o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a>);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="server_8h.html#afcfb5bd97af52d1dbce331745cae030c">sdsEncodedObject</a>(o)) {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordflow">return</span> sdslen(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="util_8c.html#ae96ca73089ed65eac700a6241bd52266">sdigits10</a>((<span class="keywordtype">long</span>)o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;}</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno"><a class="line" href="server_8h.html#a45ffbf979c99e0a0985141ae4d9316a2">  594</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="object_8c.html#a45ffbf979c99e0a0985141ae4d9316a2">getDoubleFromObject</a>(<span class="keyword">const</span> <a class="code" href="structredis_object.html">robj</a> *o, <span class="keywordtype">double</span> *target) {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordtype">double</span> value;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordtype">char</span> *eptr;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">if</span> (o == NULL) {</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        value = 0;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <a class="code" href="server_8h.html#a7308f76cbff9a8d3797fe78190b91282">serverAssertWithInfo</a>(NULL,o,o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a>);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="server_8h.html#afcfb5bd97af52d1dbce331745cae030c">sdsEncodedObject</a>(o)) {</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            errno = 0;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            value = strtod(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, &amp;eptr);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keywordflow">if</span> (sdslen(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>) == 0 ||</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                isspace(((<span class="keyword">const</span> <span class="keywordtype">char</span>*)o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>)[0]) ||</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                (<span class="keywordtype">size_t</span>)(eptr-(<span class="keywordtype">char</span>*)o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>) != sdslen(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>) ||</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                (errno == ERANGE &amp;&amp;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                    (value == HUGE_VAL || value == -HUGE_VAL || value == 0)) ||</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                isnan(value))</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="server_8h.html#af98ac28d5f4d23d7ed5985188e6fb7d1">C_ERR</a>;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#ae934cf008a0be0ef009c92c2d006a816">OBJ_ENCODING_INT</a>) {</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            value = (long)o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Unknown string encoding&quot;</span>);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    *target = value;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="server_8h.html#a303769ef1065076e68731584e758d3e1">C_OK</a>;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;}</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno"><a class="line" href="server_8h.html#a7a7968bc470b0da48ead4e8191c454d8">  622</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="object_8c.html#a7a7968bc470b0da48ead4e8191c454d8">getDoubleFromObjectOrReply</a>(<a class="code" href="structclient.html">client</a> *c, <a class="code" href="structredis_object.html">robj</a> *o, <span class="keywordtype">double</span> *target, <span class="keyword">const</span> <span class="keywordtype">char</span> *msg) {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordtype">double</span> value;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="object_8c.html#a45ffbf979c99e0a0985141ae4d9316a2">getDoubleFromObject</a>(o, &amp;value) != <a class="code" href="server_8h.html#a303769ef1065076e68731584e758d3e1">C_OK</a>) {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">if</span> (msg != NULL) {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <a class="code" href="networking_8c.html#a0ea8df2930509a88eb4e98348b85a51d">addReplyError</a>(c,(<span class="keywordtype">char</span>*)msg);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <a class="code" href="networking_8c.html#a0ea8df2930509a88eb4e98348b85a51d">addReplyError</a>(c,<span class="stringliteral">&quot;value is not a valid float&quot;</span>);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="server_8h.html#af98ac28d5f4d23d7ed5985188e6fb7d1">C_ERR</a>;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    *target = value;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="server_8h.html#a303769ef1065076e68731584e758d3e1">C_OK</a>;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;}</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno"><a class="line" href="server_8h.html#ab1682abd71cd968dc006d34d20550e9f">  636</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="object_8c.html#ab1682abd71cd968dc006d34d20550e9f">getLongDoubleFromObject</a>(<a class="code" href="structredis_object.html">robj</a> *o, <span class="keywordtype">long</span> <span class="keywordtype">double</span> *target) {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">double</span> value;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordtype">char</span> *eptr;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">if</span> (o == NULL) {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        value = 0;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <a class="code" href="server_8h.html#a7308f76cbff9a8d3797fe78190b91282">serverAssertWithInfo</a>(NULL,o,o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a>);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="server_8h.html#afcfb5bd97af52d1dbce331745cae030c">sdsEncodedObject</a>(o)) {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            errno = 0;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            value = strtold(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, &amp;eptr);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordflow">if</span> (sdslen(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>) == 0 ||</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                isspace(((<span class="keyword">const</span> <span class="keywordtype">char</span>*)o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>)[0]) ||</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                (<span class="keywordtype">size_t</span>)(eptr-(<span class="keywordtype">char</span>*)o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>) != sdslen(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>) ||</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                (errno == ERANGE &amp;&amp;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                    (value == HUGE_VAL || value == -HUGE_VAL || value == 0)) ||</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                isnan(value))</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="server_8h.html#af98ac28d5f4d23d7ed5985188e6fb7d1">C_ERR</a>;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#ae934cf008a0be0ef009c92c2d006a816">OBJ_ENCODING_INT</a>) {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            value = (long)o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Unknown string encoding&quot;</span>);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    }</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    *target = value;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="server_8h.html#a303769ef1065076e68731584e758d3e1">C_OK</a>;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;}</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno"><a class="line" href="server_8h.html#a2fbd492cd9e05cd09febb2d82aeb695b">  664</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="object_8c.html#a2fbd492cd9e05cd09febb2d82aeb695b">getLongDoubleFromObjectOrReply</a>(<a class="code" href="structclient.html">client</a> *c, <a class="code" href="structredis_object.html">robj</a> *o, <span class="keywordtype">long</span> <span class="keywordtype">double</span> *target, <span class="keyword">const</span> <span class="keywordtype">char</span> *msg) {</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">double</span> value;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="object_8c.html#ab1682abd71cd968dc006d34d20550e9f">getLongDoubleFromObject</a>(o, &amp;value) != <a class="code" href="server_8h.html#a303769ef1065076e68731584e758d3e1">C_OK</a>) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordflow">if</span> (msg != NULL) {</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <a class="code" href="networking_8c.html#a0ea8df2930509a88eb4e98348b85a51d">addReplyError</a>(c,(<span class="keywordtype">char</span>*)msg);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            <a class="code" href="networking_8c.html#a0ea8df2930509a88eb4e98348b85a51d">addReplyError</a>(c,<span class="stringliteral">&quot;value is not a valid float&quot;</span>);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="server_8h.html#af98ac28d5f4d23d7ed5985188e6fb7d1">C_ERR</a>;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    }</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    *target = value;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="server_8h.html#a303769ef1065076e68731584e758d3e1">C_OK</a>;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;}</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div><div class="line"><a name="l00678"></a><span class="lineno"><a class="line" href="server_8h.html#ade9e166ea7caa357b0f742e63ba37c7f">  678</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="object_8c.html#ade9e166ea7caa357b0f742e63ba37c7f">getLongLongFromObject</a>(<a class="code" href="structredis_object.html">robj</a> *o, <span class="keywordtype">long</span> <span class="keywordtype">long</span> *target) {</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> value;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">if</span> (o == NULL) {</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        value = 0;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <a class="code" href="server_8h.html#a7308f76cbff9a8d3797fe78190b91282">serverAssertWithInfo</a>(NULL,o,o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a>);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="server_8h.html#afcfb5bd97af52d1dbce331745cae030c">sdsEncodedObject</a>(o)) {</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="util_8c.html#a5c8ac146ff5b5323cacafbeb0e53cda0">string2ll</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,sdslen(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>),&amp;value) == 0) <span class="keywordflow">return</span> <a class="code" href="server_8h.html#af98ac28d5f4d23d7ed5985188e6fb7d1">C_ERR</a>;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#ae934cf008a0be0ef009c92c2d006a816">OBJ_ENCODING_INT</a>) {</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            value = (long)o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Unknown string encoding&quot;</span>);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        }</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    }</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">if</span> (target) *target = value;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="server_8h.html#a303769ef1065076e68731584e758d3e1">C_OK</a>;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;}</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno"><a class="line" href="server_8h.html#a39155431bb51f438f1e38f0ec06366a2">  697</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="object_8c.html#a39155431bb51f438f1e38f0ec06366a2">getLongLongFromObjectOrReply</a>(<a class="code" href="structclient.html">client</a> *c, <a class="code" href="structredis_object.html">robj</a> *o, <span class="keywordtype">long</span> <span class="keywordtype">long</span> *target, <span class="keyword">const</span> <span class="keywordtype">char</span> *msg) {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> value;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="object_8c.html#ade9e166ea7caa357b0f742e63ba37c7f">getLongLongFromObject</a>(o, &amp;value) != <a class="code" href="server_8h.html#a303769ef1065076e68731584e758d3e1">C_OK</a>) {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="keywordflow">if</span> (msg != NULL) {</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <a class="code" href="networking_8c.html#a0ea8df2930509a88eb4e98348b85a51d">addReplyError</a>(c,(<span class="keywordtype">char</span>*)msg);</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <a class="code" href="networking_8c.html#a0ea8df2930509a88eb4e98348b85a51d">addReplyError</a>(c,<span class="stringliteral">&quot;value is not an integer or out of range&quot;</span>);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="server_8h.html#af98ac28d5f4d23d7ed5985188e6fb7d1">C_ERR</a>;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    }</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    *target = value;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="server_8h.html#a303769ef1065076e68731584e758d3e1">C_OK</a>;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;}</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno"><a class="line" href="server_8h.html#ae39b213c26365e47c49958ca36400533">  711</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="object_8c.html#ae39b213c26365e47c49958ca36400533">getLongFromObjectOrReply</a>(<a class="code" href="structclient.html">client</a> *c, <a class="code" href="structredis_object.html">robj</a> *o, <span class="keywordtype">long</span> *target, <span class="keyword">const</span> <span class="keywordtype">char</span> *msg) {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> value;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="object_8c.html#a39155431bb51f438f1e38f0ec06366a2">getLongLongFromObjectOrReply</a>(c, o, &amp;value, msg) != <a class="code" href="server_8h.html#a303769ef1065076e68731584e758d3e1">C_OK</a>) <span class="keywordflow">return</span> <a class="code" href="server_8h.html#af98ac28d5f4d23d7ed5985188e6fb7d1">C_ERR</a>;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">if</span> (value &lt; LONG_MIN || value &gt; LONG_MAX) {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keywordflow">if</span> (msg != NULL) {</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <a class="code" href="networking_8c.html#a0ea8df2930509a88eb4e98348b85a51d">addReplyError</a>(c,(<span class="keywordtype">char</span>*)msg);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            <a class="code" href="networking_8c.html#a0ea8df2930509a88eb4e98348b85a51d">addReplyError</a>(c,<span class="stringliteral">&quot;value is out of range&quot;</span>);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        }</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="server_8h.html#af98ac28d5f4d23d7ed5985188e6fb7d1">C_ERR</a>;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    *target = value;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="server_8h.html#a303769ef1065076e68731584e758d3e1">C_OK</a>;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;}</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno"><a class="line" href="server_8h.html#a89772282d38fe17fe42ec0087c0e9bd5">  727</a></span>&#160;<span class="keywordtype">char</span> *<a class="code" href="object_8c.html#a89772282d38fe17fe42ec0087c0e9bd5">strEncoding</a>(<span class="keywordtype">int</span> encoding) {</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">switch</span>(encoding) {</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#a148bc85e3074e324a6dc5eebcad1bcd5">OBJ_ENCODING_RAW</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;raw&quot;</span>;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#ae934cf008a0be0ef009c92c2d006a816">OBJ_ENCODING_INT</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;int&quot;</span>;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#a9c10219f68afc557d510d108257d238b">OBJ_ENCODING_HT</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;hashtable&quot;</span>;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#aec792aeed6d4bf83966672e6a23043b8">OBJ_ENCODING_QUICKLIST</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;quicklist&quot;</span>;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#aabf064ede983103f1fd0df2086e84eee">OBJ_ENCODING_ZIPLIST</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;ziplist&quot;</span>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#a214173987de21c3b7661fddd42b05873">OBJ_ENCODING_INTSET</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;intset&quot;</span>;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#acfb35db5cb30ed113ed23aeb1a224c4c">OBJ_ENCODING_SKIPLIST</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;skiplist&quot;</span>;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="server_8h.html#ac5bb76b546161fd0da4b0ff89b3142ee">OBJ_ENCODING_EMBSTR</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;embstr&quot;</span>;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">default</span>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;unknown&quot;</span>;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    }</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;}</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">/* =========================== Memory introspection ========================= */</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">/* This is an helper function with the goal of estimating the memory</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment"> * size of a radix tree that is used to store Stream IDs.</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment"> * Note: to guess the size of the radix tree is not trivial, so we</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment"> * approximate it considering 16 bytes of data overhead for each</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment"> * key (the ID), and then adding the number of bare nodes, plus some</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment"> * overhead due by the data and child pointers. This secret recipe</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment"> * was obtained by checking the average radix tree created by real</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment"> * workloads, and then adjusting the constants to get numbers that</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment"> * more or less match the real memory usage.</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment"> * Actually the number of nodes and keys may be different depending</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment"> * on the insertion speed and thus the ability of the radix tree</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment"> * to compress prefixes. */</span></div><div class="line"><a name="l00758"></a><span class="lineno"><a class="line" href="object_8c.html#a4dceec0f005ea221a5ee41659297ce30">  758</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="object_8c.html#a4dceec0f005ea221a5ee41659297ce30">streamRadixTreeMemoryUsage</a>(<a class="code" href="structrax.html">rax</a> *<a class="code" href="structrax.html">rax</a>) {</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordtype">size_t</span> size;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    size = rax-&gt;<a class="code" href="structrax.html#aeb57ec87f1c4514577f9ed22bfc1041d">numele</a> * <span class="keyword">sizeof</span>(<a class="code" href="stream_8h.html#ad7e8b00284de80524315e851a3027ac2">streamID</a>);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    size += rax-&gt;<a class="code" href="structrax.html#abbdb3a945f35e1cd7a50bcabf1bb6828">numnodes</a> * <span class="keyword">sizeof</span>(<a class="code" href="rax_8h.html#a4430f1fc12afa59bcca60a2cb39b6ab2">raxNode</a>);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="comment">/* Add a fixed overhead due to the aux data pointer, children, ... */</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    size += rax-&gt;<a class="code" href="structrax.html#abbdb3a945f35e1cd7a50bcabf1bb6828">numnodes</a> * <span class="keyword">sizeof</span>(long)*30;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">return</span> size;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;}</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">/* Returns the size in bytes consumed by the key&#39;s value in RAM.</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment"> * Note that the returned value is just an approximation, especially in the</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment"> * case of aggregated data types where only &quot;sample_size&quot; elements</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment"> * are checked and averaged to estimate the total size. */</span></div><div class="line"><a name="l00771"></a><span class="lineno"><a class="line" href="object_8c.html#a46d9ae99d237582e21c70e7de56a032e">  771</a></span>&#160;<span class="preprocessor">#define OBJ_COMPUTE_SIZE_DEF_SAMPLES 5 </span><span class="comment">/* Default sample size. */</span><span class="preprocessor"></span></div><div class="line"><a name="l00772"></a><span class="lineno"><a class="line" href="object_8c.html#a3f9054ae0c2ce0a1fd35c1863d14177c">  772</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="object_8c.html#a3f9054ae0c2ce0a1fd35c1863d14177c">objectComputeSize</a>(<a class="code" href="structredis_object.html">robj</a> *o, <span class="keywordtype">size_t</span> sample_size) {</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <a class="code" href="sds_8h.html#ad69abac3df4532879db9642c95f5ef6f">sds</a> ele, ele2;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <a class="code" href="structdict.html">dict</a> *d;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <a class="code" href="structdict_iterator.html">dictIterator</a> *di;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keyword">struct </span><a class="code" href="structdict_entry.html">dictEntry</a> *de;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordtype">size_t</span> asize = 0, elesize = 0, samples = 0;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a>) {</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordflow">if</span>(o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#ae934cf008a0be0ef009c92c2d006a816">OBJ_ENCODING_INT</a>) {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            asize = <span class="keyword">sizeof</span>(*o);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#a148bc85e3074e324a6dc5eebcad1bcd5">OBJ_ENCODING_RAW</a>) {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            asize = <a class="code" href="sds_8c.html#a8633545cba735b390afad7bf8b5a9833">sdsAllocSize</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>)+<span class="keyword">sizeof</span>(*o);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#ac5bb76b546161fd0da4b0ff89b3142ee">OBJ_ENCODING_EMBSTR</a>) {</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            asize = sdslen(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>)+2+<span class="keyword">sizeof</span>(*o);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Unknown string encoding&quot;</span>);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        }</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a4a5f22a280949c97a0cb0d4213275126">OBJ_LIST</a>) {</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#aec792aeed6d4bf83966672e6a23043b8">OBJ_ENCODING_QUICKLIST</a>) {</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <a class="code" href="structquicklist.html">quicklist</a> *ql = o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <a class="code" href="structquicklist_node.html">quicklistNode</a> *node = ql-&gt;<a class="code" href="structquicklist.html#a9768476640799c4dc25850d7dfb5f436">head</a>;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            asize = <span class="keyword">sizeof</span>(*o)+<span class="keyword">sizeof</span>(<a class="code" href="quicklist_8h.html#af7ba3e3c181ca13bfc890a7de367ee84">quicklist</a>);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <span class="keywordflow">do</span> {</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                elesize += <span class="keyword">sizeof</span>(<a class="code" href="quicklist_8h.html#ad4ba8011cebbeb7d38053e29638c3e05">quicklistNode</a>)+<a class="code" href="ziplist_8c.html#a2fc699da80e3b5dfe10057ecfbdb3fa1">ziplistBlobLen</a>(node-&gt;<a class="code" href="structquicklist_node.html#a1ae48f85ded0fe46acd8864ac807f6b8">zl</a>);</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                samples++;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            } <span class="keywordflow">while</span> ((node = node-&gt;<a class="code" href="structquicklist_node.html#aa4be5244c2097b8fc8bdf053a0793ac8">next</a>) &amp;&amp; samples &lt; sample_size);</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            asize += (double)elesize/samples*ql-&gt;<a class="code" href="structquicklist.html#af2e72f8a5bf4bcdb77566c2936d5f13d">len</a>;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#aabf064ede983103f1fd0df2086e84eee">OBJ_ENCODING_ZIPLIST</a>) {</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            asize = <span class="keyword">sizeof</span>(*o)+<a class="code" href="ziplist_8c.html#a2fc699da80e3b5dfe10057ecfbdb3fa1">ziplistBlobLen</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Unknown list encoding&quot;</span>);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        }</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a8d179375a4aac33d3fa7aa80c8ccc75f">OBJ_SET</a>) {</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#a9c10219f68afc557d510d108257d238b">OBJ_ENCODING_HT</a>) {</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            d = o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            di = <a class="code" href="dict_8c.html#a63b2ad9054199271795e33d67fb6d6da">dictGetIterator</a>(d);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            asize = <span class="keyword">sizeof</span>(*o)+<span class="keyword">sizeof</span>(<a class="code" href="dict_8h.html#a5fcb59103f176d193e100c23c998bae5">dict</a>)+(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structdict_entry.html">dictEntry</a>*)*<a class="code" href="dict_8h.html#aca9596be4bcc2caa07c17dd8cebcceec">dictSlots</a>(d));</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <span class="keywordflow">while</span>((de = <a class="code" href="dict_8c.html#ab51f7613d1fe7b63edecd24efbcc7d2b">dictNext</a>(di)) != NULL &amp;&amp; samples &lt; sample_size) {</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                ele = <a class="code" href="dict_8h.html#a3271c334309904a3086deca94f96e46e">dictGetKey</a>(de);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                elesize += <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structdict_entry.html">dictEntry</a>) + sdsAllocSize(ele);</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                samples++;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            }</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            <a class="code" href="dict_8c.html#a8bfc6c2908c66772c09a1315c078bf06">dictReleaseIterator</a>(di);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            <span class="keywordflow">if</span> (samples) asize += (double)elesize/samples*<a class="code" href="dict_8h.html#af193430dd3d5579a52b194512f72c1f0">dictSize</a>(d);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#a214173987de21c3b7661fddd42b05873">OBJ_ENCODING_INTSET</a>) {</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            <a class="code" href="structintset.html">intset</a> *is = o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            asize = <span class="keyword">sizeof</span>(*o)+<span class="keyword">sizeof</span>(*is)+is-&gt;<a class="code" href="structintset.html#abf20f154dd41a6f1b64b0cbfbfb05052">encoding</a>*is-&gt;<a class="code" href="structintset.html#aebb70c2aab3407a9f05334c47131a43b">length</a>;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Unknown set encoding&quot;</span>);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        }</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a8c356422ddbc03bd77694880a30a1953">OBJ_ZSET</a>) {</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#aabf064ede983103f1fd0df2086e84eee">OBJ_ENCODING_ZIPLIST</a>) {</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            asize = <span class="keyword">sizeof</span>(*o)+(<a class="code" href="ziplist_8c.html#a2fc699da80e3b5dfe10057ecfbdb3fa1">ziplistBlobLen</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>));</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#acfb35db5cb30ed113ed23aeb1a224c4c">OBJ_ENCODING_SKIPLIST</a>) {</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            d = ((<a class="code" href="structzset.html">zset</a>*)o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>)-&gt;dict;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            <a class="code" href="structzskiplist.html">zskiplist</a> *zsl = ((<a class="code" href="structzset.html">zset</a>*)o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>)-&gt;zsl;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <a class="code" href="structzskiplist_node.html">zskiplistNode</a> *znode = zsl-&gt;<a class="code" href="structzskiplist.html#ade3018e820093435bd6592a7e5667dd4">header</a>-&gt;<a class="code" href="structzskiplist_node.html#ab6e002b167ff0de655b16debe293180c">level</a>[0].<a class="code" href="structzskiplist_node_1_1zskiplist_level.html#aaa7319c399716d20dfa04890a648f04a">forward</a>;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            asize = <span class="keyword">sizeof</span>(*o)+<span class="keyword">sizeof</span>(<a class="code" href="server_8h.html#afc6f1280f32cbb707bf231806ea3b884">zset</a>)+(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structdict_entry.html">dictEntry</a>*)*<a class="code" href="dict_8h.html#aca9596be4bcc2caa07c17dd8cebcceec">dictSlots</a>(d));</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            <span class="keywordflow">while</span>(znode != NULL &amp;&amp; samples &lt; sample_size) {</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                elesize += <a class="code" href="sds_8c.html#a8633545cba735b390afad7bf8b5a9833">sdsAllocSize</a>(znode-&gt;<a class="code" href="structzskiplist_node.html#ac99cd495189c228ff8d538f04489805e">ele</a>);</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                elesize += <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structdict_entry.html">dictEntry</a>) + zmalloc_size(znode);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                samples++;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                znode = znode-&gt;level[0].forward;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            }</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            <span class="keywordflow">if</span> (samples) asize += (double)elesize/samples*<a class="code" href="dict_8h.html#af193430dd3d5579a52b194512f72c1f0">dictSize</a>(d);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Unknown sorted set encoding&quot;</span>);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        }</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a87c05ba4f7f36741864277f02a4423fb">OBJ_HASH</a>) {</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#aabf064ede983103f1fd0df2086e84eee">OBJ_ENCODING_ZIPLIST</a>) {</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            asize = <span class="keyword">sizeof</span>(*o)+(<a class="code" href="ziplist_8c.html#a2fc699da80e3b5dfe10057ecfbdb3fa1">ziplistBlobLen</a>(o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>));</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a> == <a class="code" href="server_8h.html#a9c10219f68afc557d510d108257d238b">OBJ_ENCODING_HT</a>) {</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            d = o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            di = <a class="code" href="dict_8c.html#a63b2ad9054199271795e33d67fb6d6da">dictGetIterator</a>(d);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            asize = <span class="keyword">sizeof</span>(*o)+<span class="keyword">sizeof</span>(<a class="code" href="dict_8h.html#a5fcb59103f176d193e100c23c998bae5">dict</a>)+(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structdict_entry.html">dictEntry</a>*)*<a class="code" href="dict_8h.html#aca9596be4bcc2caa07c17dd8cebcceec">dictSlots</a>(d));</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="keywordflow">while</span>((de = <a class="code" href="dict_8c.html#ab51f7613d1fe7b63edecd24efbcc7d2b">dictNext</a>(di)) != NULL &amp;&amp; samples &lt; sample_size) {</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                ele = <a class="code" href="dict_8h.html#a3271c334309904a3086deca94f96e46e">dictGetKey</a>(de);</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                ele2 = <a class="code" href="dict_8h.html#ae8d2cc391873b2bea2b87c4f80f43120">dictGetVal</a>(de);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                elesize += <a class="code" href="sds_8c.html#a8633545cba735b390afad7bf8b5a9833">sdsAllocSize</a>(ele) + <a class="code" href="sds_8c.html#a8633545cba735b390afad7bf8b5a9833">sdsAllocSize</a>(ele2);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                elesize += <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structdict_entry.html">dictEntry</a>);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                samples++;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            }</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <a class="code" href="dict_8c.html#a8bfc6c2908c66772c09a1315c078bf06">dictReleaseIterator</a>(di);</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            <span class="keywordflow">if</span> (samples) asize += (double)elesize/samples*<a class="code" href="dict_8h.html#af193430dd3d5579a52b194512f72c1f0">dictSize</a>(d);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Unknown hash encoding&quot;</span>);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        }</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a2c2cc41300ca6b9daca7ea8a6d66edc6">OBJ_STREAM</a>) {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <a class="code" href="structstream.html">stream</a> *s = o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        asize = <span class="keyword">sizeof</span>(*o);</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        asize += <a class="code" href="object_8c.html#a4dceec0f005ea221a5ee41659297ce30">streamRadixTreeMemoryUsage</a>(s-&gt;<a class="code" href="structstream.html#a5e94d4d7ba0112aeda6ee7b1ec15cf54">rax</a>);</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <span class="comment">/* Now we have to add the listpacks. The last listpack is often non</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">         * complete, so we estimate the size of the first N listpacks, and</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">         * use the average to compute the size of the first N-1 listpacks, and</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">         * finally add the real size of the last node. */</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <a class="code" href="structrax_iterator.html">raxIterator</a> ri;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <a class="code" href="rax_8c.html#a89bfe37114c7be78b37f5f669c7e690e">raxStart</a>(&amp;ri,s-&gt;<a class="code" href="structstream.html#a5e94d4d7ba0112aeda6ee7b1ec15cf54">rax</a>);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <a class="code" href="rax_8c.html#a4ad909fa19602d916b8781ad11444803">raxSeek</a>(&amp;ri,<span class="stringliteral">&quot;^&quot;</span>,NULL,0);</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <span class="keywordtype">size_t</span> lpsize = 0, samples = 0;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordflow">while</span>(samples &lt; sample_size &amp;&amp; <a class="code" href="rax_8c.html#abafdb51bd58d96e97618cfefc83f3737">raxNext</a>(&amp;ri)) {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *lp = ri.<a class="code" href="structrax_iterator.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            lpsize += <a class="code" href="listpack_8c.html#a087b2b4c2fcb972fb8c4b9466828d2e6">lpBytes</a>(lp);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            samples++;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        }</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordflow">if</span> (s-&gt;<a class="code" href="structstream.html#a5e94d4d7ba0112aeda6ee7b1ec15cf54">rax</a>-&gt;<a class="code" href="structrax.html#aeb57ec87f1c4514577f9ed22bfc1041d">numele</a> &lt;= samples) {</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            asize += lpsize;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            <span class="keywordflow">if</span> (samples) lpsize /= samples; <span class="comment">/* Compute the average. */</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            asize += lpsize * (s-&gt;<a class="code" href="structstream.html#a5e94d4d7ba0112aeda6ee7b1ec15cf54">rax</a>-&gt;<a class="code" href="structrax.html#aeb57ec87f1c4514577f9ed22bfc1041d">numele</a>-1);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            <span class="comment">/* No need to check if seek succeeded, we enter this branch only</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">             * if there are a few elements in the radix tree. */</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            <a class="code" href="rax_8c.html#a4ad909fa19602d916b8781ad11444803">raxSeek</a>(&amp;ri,<span class="stringliteral">&quot;$&quot;</span>,NULL,0);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            <a class="code" href="rax_8c.html#abafdb51bd58d96e97618cfefc83f3737">raxNext</a>(&amp;ri);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            asize += <a class="code" href="listpack_8c.html#a087b2b4c2fcb972fb8c4b9466828d2e6">lpBytes</a>(ri.<a class="code" href="structrax_iterator.html#a735984d41155bc1032e09bece8f8d66d">data</a>);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        }</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <a class="code" href="rax_8c.html#afd5c0fce25aea0c4003bbb65b9108520">raxStop</a>(&amp;ri);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="comment">/* Consumer groups also have a non trivial memory overhead if there</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">         * are many consumers and many groups, let&#39;s count at least the</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">         * overhead of the pending entries in the groups and consumers</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">         * PELs. */</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">if</span> (s-&gt;<a class="code" href="structstream.html#a16c7dae1e1c61411ffe37afabe67de80">cgroups</a>) {</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            <a class="code" href="rax_8c.html#a89bfe37114c7be78b37f5f669c7e690e">raxStart</a>(&amp;ri,s-&gt;<a class="code" href="structstream.html#a16c7dae1e1c61411ffe37afabe67de80">cgroups</a>);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <a class="code" href="rax_8c.html#a4ad909fa19602d916b8781ad11444803">raxSeek</a>(&amp;ri,<span class="stringliteral">&quot;^&quot;</span>,NULL,0);</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="keywordflow">while</span>(<a class="code" href="rax_8c.html#abafdb51bd58d96e97618cfefc83f3737">raxNext</a>(&amp;ri)) {</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                <a class="code" href="structstream_c_g.html">streamCG</a> *cg = ri.<a class="code" href="structrax_iterator.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                asize += <span class="keyword">sizeof</span>(*cg);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                asize += <a class="code" href="object_8c.html#a4dceec0f005ea221a5ee41659297ce30">streamRadixTreeMemoryUsage</a>(cg-&gt;<a class="code" href="structstream_c_g.html#a2fc8aed22096d11568cb29885cf08cb2">pel</a>);</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                asize += <span class="keyword">sizeof</span>(<a class="code" href="stream_8h.html#ae56cb2569f04ff411da836b3e13b486d">streamNACK</a>)*<a class="code" href="rax_8c.html#ac44bf6b27f6af45dd9b3b7308161322c">raxSize</a>(cg-&gt;<a class="code" href="structstream_c_g.html#a2fc8aed22096d11568cb29885cf08cb2">pel</a>);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                <span class="comment">/* For each consumer we also need to add the basic data</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">                 * structures and the PEL memory usage. */</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                <a class="code" href="structrax_iterator.html">raxIterator</a> cri;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                <a class="code" href="rax_8c.html#a89bfe37114c7be78b37f5f669c7e690e">raxStart</a>(&amp;cri,cg-&gt;<a class="code" href="structstream_c_g.html#a7773ab32d924c957c1db3ba8986cb963">consumers</a>);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                <a class="code" href="rax_8c.html#a4ad909fa19602d916b8781ad11444803">raxSeek</a>(&amp;cri,<span class="stringliteral">&quot;^&quot;</span>,NULL,0);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                <span class="keywordflow">while</span>(<a class="code" href="rax_8c.html#abafdb51bd58d96e97618cfefc83f3737">raxNext</a>(&amp;cri)) {</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                    <a class="code" href="structstream_consumer.html">streamConsumer</a> *consumer = cri.<a class="code" href="structrax_iterator.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                    asize += <span class="keyword">sizeof</span>(*consumer);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                    asize += sdslen(consumer-&gt;<a class="code" href="structstream_consumer.html#a78d661a433637c5e0fac8a377e3ddeb6">name</a>);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                    asize += <a class="code" href="object_8c.html#a4dceec0f005ea221a5ee41659297ce30">streamRadixTreeMemoryUsage</a>(consumer-&gt;<a class="code" href="structstream_consumer.html#a2fc8aed22096d11568cb29885cf08cb2">pel</a>);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                    <span class="comment">/* Don&#39;t count NACKs again, they are shared with the</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">                     * consumer group PEL. */</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                }</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                <a class="code" href="rax_8c.html#afd5c0fce25aea0c4003bbb65b9108520">raxStop</a>(&amp;cri);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            }</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            <a class="code" href="rax_8c.html#afd5c0fce25aea0c4003bbb65b9108520">raxStop</a>(&amp;ri);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">type</a> == <a class="code" href="server_8h.html#a92c1fed85f709180fda0ff10d37d649b">OBJ_MODULE</a>) {</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <a class="code" href="structmodule_value.html">moduleValue</a> *mv = o-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <a class="code" href="struct_redis_module_type.html">moduleType</a> *mt = mv-&gt;<a class="code" href="structmodule_value.html#a05eee39e39e34439ea77af35b597b1ae">type</a>;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="keywordflow">if</span> (mt-&gt;<a class="code" href="struct_redis_module_type.html#ae3702833db2444b2ec958b5116dc00d3">mem_usage</a> != NULL) {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            asize = mt-&gt;<a class="code" href="struct_redis_module_type.html#ae3702833db2444b2ec958b5116dc00d3">mem_usage</a>(mv-&gt;<a class="code" href="structmodule_value.html#a0f61d63b009d0880a89c843bd50d8d76">value</a>);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            asize = 0;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        }</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <a class="code" href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a>(<span class="stringliteral">&quot;Unknown object type&quot;</span>);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    }</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">return</span> asize;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;}</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">/* Release data obtained with getMemoryOverheadData(). */</span></div><div class="line"><a name="l00935"></a><span class="lineno"><a class="line" href="server_8h.html#ab09baeae3f0b14d5e0f36b7a8af2bdcf">  935</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="object_8c.html#ab09baeae3f0b14d5e0f36b7a8af2bdcf">freeMemoryOverheadData</a>(<span class="keyword">struct</span> <a class="code" href="structredis_mem_overhead.html">redisMemOverhead</a> *mh) {</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <a class="code" href="zmalloc_8c.html#ae6638523882220721b9e7cdc7b2cd58d">zfree</a>(mh-&gt;<a class="code" href="structredis_mem_overhead.html#a92e2261ab8290fdc2955b81e5901203d">db</a>);</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <a class="code" href="zmalloc_8c.html#ae6638523882220721b9e7cdc7b2cd58d">zfree</a>(mh);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;}</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">/* Return a struct redisMemOverhead filled with memory overhead</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment"> * information used for the MEMORY OVERHEAD and INFO command. The returned</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment"> * structure pointer should be freed calling freeMemoryOverheadData(). */</span></div><div class="line"><a name="l00943"></a><span class="lineno"><a class="line" href="server_8h.html#a1032572b4b3b6e9425744bb86d98ec15">  943</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structredis_mem_overhead.html">redisMemOverhead</a> *<a class="code" href="object_8c.html#a1032572b4b3b6e9425744bb86d98ec15">getMemoryOverheadData</a>(<span class="keywordtype">void</span>) {</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordtype">int</span> j;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordtype">size_t</span> mem_total = 0;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordtype">size_t</span> mem = 0;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordtype">size_t</span> zmalloc_used = <a class="code" href="zmalloc_8c.html#a16542aef4062c19198acc9231406bd0f">zmalloc_used_memory</a>();</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keyword">struct </span><a class="code" href="structredis_mem_overhead.html">redisMemOverhead</a> *mh = <a class="code" href="zmalloc_8c.html#a027ae46ed3662b0911304294f218d0b9">zcalloc</a>(<span class="keyword">sizeof</span>(*mh));</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#a3bb14855f7c280e92d0c01bbbc9b4c3c">total_allocated</a> = zmalloc_used;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#a0e982a0e14543ef6e17073a6d4afe191">startup_allocated</a> = <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a1e552149c10f70ef055718ed88837bc3">initial_memory_usage</a>;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#a52004d56324eaeaabb6686b05052ca55">peak_allocated</a> = <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a9153369284c79d6fcf505c5882ec29ab">stat_peak_memory</a>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#ac8bdd246c25c91aa5ae7af8362ff9188">total_frag</a> =</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        (float)<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#a93e17e92b02c3ad2a4e6bf903154b3d2">process_rss</a> / <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#a24fe6607486bb69f2f446830dbf6c8fb">zmalloc_used</a>;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#a5e5705378e7ceb2bcfa33b637a7a6fd2">total_frag_bytes</a> =</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#a93e17e92b02c3ad2a4e6bf903154b3d2">process_rss</a> - <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#a24fe6607486bb69f2f446830dbf6c8fb">zmalloc_used</a>;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#a6191ede96ce40757b7eb73d4bcc597f0">allocator_frag</a> =</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        (<span class="keywordtype">float</span>)<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#a78e452f18e74cbf8be28858f49c0ff0b">allocator_active</a> / <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#a35a8adbf64bc20a4ab20cf3872ea5e54">allocator_allocated</a>;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#a7dcfd2bdf329730a992f30f52b145dbb">allocator_frag_bytes</a> =</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#a78e452f18e74cbf8be28858f49c0ff0b">allocator_active</a> - <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#a35a8adbf64bc20a4ab20cf3872ea5e54">allocator_allocated</a>;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#a213b026c5bb4a2421289b34e620eb4ef">allocator_rss</a> =</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        (float)<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#abaf85ea7348d3c27fea44dcc7cebd639">allocator_resident</a> / <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#a78e452f18e74cbf8be28858f49c0ff0b">allocator_active</a>;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#a988880d896f03571a137a828ef96531a">allocator_rss_bytes</a> =</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#abaf85ea7348d3c27fea44dcc7cebd639">allocator_resident</a> - <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#a78e452f18e74cbf8be28858f49c0ff0b">allocator_active</a>;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#ae1d7b7b42904d9ebb1698ab3ac79a2e9">rss_extra</a> =</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        (<span class="keywordtype">float</span>)<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#a93e17e92b02c3ad2a4e6bf903154b3d2">process_rss</a> / <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#abaf85ea7348d3c27fea44dcc7cebd639">allocator_resident</a>;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#a9cafe99c292b52f795f9ceef838f4249">rss_extra_bytes</a> =</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#a93e17e92b02c3ad2a4e6bf903154b3d2">process_rss</a> - <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#abaf85ea7348d3c27fea44dcc7cebd639">allocator_resident</a>;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    mem_total += <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a1e552149c10f70ef055718ed88837bc3">initial_memory_usage</a>;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    mem = 0;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#acabb38054cd6d1d619d7c19d3e57bf28">repl_backlog</a>)</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        mem += <a class="code" href="zmalloc_8c.html#aa841265e1d698c82d390308cb5dd0051">zmalloc_size</a>(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#acabb38054cd6d1d619d7c19d3e57bf28">repl_backlog</a>);</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#a4377a6a963ee32e22c7c7f14180a4a31">repl_backlog</a> = mem;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    mem_total += mem;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    mem = 0;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="adlist_8h.html#afde0ab079f934670e82119b43120e94b">listLength</a>(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a6a317d8f5c5ed50aa4c4756bb5e95ee9">slaves</a>)) {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <a class="code" href="structlist_iter.html">listIter</a> li;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <a class="code" href="structlist_node.html">listNode</a> *ln;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <a class="code" href="adlist_8c.html#ae35a3ee8d5580afa77f9f5430837d8a4">listRewind</a>(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a6a317d8f5c5ed50aa4c4756bb5e95ee9">slaves</a>,&amp;li);</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="keywordflow">while</span>((ln = <a class="code" href="adlist_8c.html#a722ffca86d8746e6c68a146359683dfa">listNext</a>(&amp;li))) {</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <a class="code" href="structclient.html">client</a> *c = <a class="code" href="adlist_8h.html#af84cae230e7180ebcda1e2736fce9f65">listNodeValue</a>(ln);</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            mem += <a class="code" href="networking_8c.html#ada74196bbcb069635697ca0d3183e183">getClientOutputBufferMemoryUsage</a>(c);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            mem += <a class="code" href="sds_8c.html#a8633545cba735b390afad7bf8b5a9833">sdsAllocSize</a>(c-&gt;<a class="code" href="structclient.html#accf8e4a2bc6b80403d3f0f024eaa8a1b">querybuf</a>);</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            mem += <span class="keyword">sizeof</span>(<a class="code" href="redis-benchmark_8c.html#a6bf8c3f34a9af09c5f641d813a37d0a7">client</a>);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        }</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    }</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#ace2b062189925c36433d3a8e68062d6e">clients_slaves</a> = mem;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    mem_total+=mem;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    mem = 0;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="adlist_8h.html#afde0ab079f934670e82119b43120e94b">listLength</a>(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a268febb2b0b1add2594f2d7c8999567e">clients</a>)) {</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <a class="code" href="structlist_iter.html">listIter</a> li;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <a class="code" href="structlist_node.html">listNode</a> *ln;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <a class="code" href="adlist_8c.html#ae35a3ee8d5580afa77f9f5430837d8a4">listRewind</a>(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a268febb2b0b1add2594f2d7c8999567e">clients</a>,&amp;li);</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <span class="keywordflow">while</span>((ln = <a class="code" href="adlist_8c.html#a722ffca86d8746e6c68a146359683dfa">listNext</a>(&amp;li))) {</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            <a class="code" href="structclient.html">client</a> *c = <a class="code" href="adlist_8h.html#af84cae230e7180ebcda1e2736fce9f65">listNodeValue</a>(ln);</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structclient.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="server_8h.html#ae9f6995948253652bc9454d79a72f4a7">CLIENT_SLAVE</a> &amp;&amp; !(c-&gt;<a class="code" href="structclient.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="server_8h.html#a7724350e4f0ddbf1c80740699fac78be">CLIENT_MONITOR</a>))</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            mem += <a class="code" href="networking_8c.html#ada74196bbcb069635697ca0d3183e183">getClientOutputBufferMemoryUsage</a>(c);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            mem += <a class="code" href="sds_8c.html#a8633545cba735b390afad7bf8b5a9833">sdsAllocSize</a>(c-&gt;<a class="code" href="structclient.html#accf8e4a2bc6b80403d3f0f024eaa8a1b">querybuf</a>);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            mem += <span class="keyword">sizeof</span>(<a class="code" href="redis-benchmark_8c.html#a6bf8c3f34a9af09c5f641d813a37d0a7">client</a>);</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        }</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    }</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#af21382aaf8f931d992586bbfe5f8aca2">clients_normal</a> = mem;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    mem_total+=mem;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    mem = 0;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a9142dcad31984d994f392be24e91daff">aof_state</a> != <a class="code" href="server_8h.html#a5226306fbcebcb6d5d02e0fef3c213c2">AOF_OFF</a>) {</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        mem += sdslen(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a4546e03b0256d4d50b71681b6cd45f52">aof_buf</a>);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        mem += <a class="code" href="aof_8c.html#ac13e9eab03e6ba37d7567e805b54e12f">aofRewriteBufferSize</a>();</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    }</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#ad441a7ae10a5fee32c6d0b0dbfc92791">aof_buffer</a> = mem;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    mem_total+=mem;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    mem = <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a412e66c4f2ef9fdb6601bcc2e09b5da9">lua_scripts_mem</a>;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    mem += <a class="code" href="dict_8h.html#af193430dd3d5579a52b194512f72c1f0">dictSize</a>(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a7f3d3d90cccad86c685008f3f02492fe">lua_scripts</a>) * <span class="keyword">sizeof</span>(<a class="code" href="dict_8h.html#a950194070759a1e4bbdf8e107bec7df1">dictEntry</a>) +</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <a class="code" href="dict_8h.html#aca9596be4bcc2caa07c17dd8cebcceec">dictSlots</a>(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a7f3d3d90cccad86c685008f3f02492fe">lua_scripts</a>) * <span class="keyword">sizeof</span>(<a class="code" href="structdict_entry.html">dictEntry</a>*);</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    mem += <a class="code" href="dict_8h.html#af193430dd3d5579a52b194512f72c1f0">dictSize</a>(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ade120d8eb790ebd186e7c4468002177f">repl_scriptcache_dict</a>) * <span class="keyword">sizeof</span>(<a class="code" href="dict_8h.html#a950194070759a1e4bbdf8e107bec7df1">dictEntry</a>) +</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        <a class="code" href="dict_8h.html#aca9596be4bcc2caa07c17dd8cebcceec">dictSlots</a>(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ade120d8eb790ebd186e7c4468002177f">repl_scriptcache_dict</a>) * <span class="keyword">sizeof</span>(<a class="code" href="structdict_entry.html">dictEntry</a>*);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="adlist_8h.html#afde0ab079f934670e82119b43120e94b">listLength</a>(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a61642879c8697309e0a0b1f8e27d79a0">repl_scriptcache_fifo</a>) &gt; 0) {</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        mem += <a class="code" href="adlist_8h.html#afde0ab079f934670e82119b43120e94b">listLength</a>(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a61642879c8697309e0a0b1f8e27d79a0">repl_scriptcache_fifo</a>) * (<span class="keyword">sizeof</span>(<a class="code" href="adlist_8h.html#af109d357e4f8eabf6ebb533ca9e45ab9">listNode</a>) + </div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            <a class="code" href="networking_8c.html#a774d738883e0b621147923b2b4d44282">sdsZmallocSize</a>(<a class="code" href="adlist_8h.html#af84cae230e7180ebcda1e2736fce9f65">listNodeValue</a>(<a class="code" href="adlist_8h.html#aa8dc514bbe217bb2e87c1c77cfa84690">listFirst</a>(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a61642879c8697309e0a0b1f8e27d79a0">repl_scriptcache_fifo</a>))));</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    }</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#aede1fc4f53c4e19111df241fe70fb77c">lua_caches</a> = mem;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    mem_total+=mem;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a4a23db6c6bac41afb7aee155283dbf9b">dbnum</a>; j++) {</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        <a class="code" href="structredis_db.html">redisDb</a> *<a class="code" href="structredis_mem_overhead.html#a92e2261ab8290fdc2955b81e5901203d">db</a> = <a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a9bee04e09635a42fef289e42a89f5502">db</a>+j;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> keyscount = <a class="code" href="dict_8h.html#af193430dd3d5579a52b194512f72c1f0">dictSize</a>(db-&gt;<a class="code" href="structredis_db.html#aad961c2f260766ff3627bf363fef3551">dict</a>);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        <span class="keywordflow">if</span> (keyscount==0) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        mh-&gt;<a class="code" href="structredis_mem_overhead.html#ab0dd532666871698a3e8dc420ec74b28">total_keys</a> += keyscount;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        mh-&gt;<a class="code" href="structredis_mem_overhead.html#a92e2261ab8290fdc2955b81e5901203d">db</a> = <a class="code" href="zmalloc_8c.html#ac24423a93cab2fbf18e28cc2f42f7f97">zrealloc</a>(mh-&gt;<a class="code" href="structredis_mem_overhead.html#a92e2261ab8290fdc2955b81e5901203d">db</a>,<span class="keyword">sizeof</span>(mh-&gt;<a class="code" href="structredis_mem_overhead.html#a92e2261ab8290fdc2955b81e5901203d">db</a>[0])*(mh-&gt;<a class="code" href="structredis_mem_overhead.html#a5fff22cf574851b502f713e7db2980fe">num_dbs</a>+1));</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        mh-&gt;<a class="code" href="structredis_mem_overhead.html#a92e2261ab8290fdc2955b81e5901203d">db</a>[mh-&gt;<a class="code" href="structredis_mem_overhead.html#a5fff22cf574851b502f713e7db2980fe">num_dbs</a>].<a class="code" href="structredis_mem_overhead.html#a8379ee7de31460d30fac72e27c81fd7a">dbid</a> = j;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        mem = <a class="code" href="dict_8h.html#af193430dd3d5579a52b194512f72c1f0">dictSize</a>(db-&gt;<a class="code" href="structredis_db.html#aad961c2f260766ff3627bf363fef3551">dict</a>) * <span class="keyword">sizeof</span>(<a class="code" href="dict_8h.html#a950194070759a1e4bbdf8e107bec7df1">dictEntry</a>) +</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;              <a class="code" href="dict_8h.html#aca9596be4bcc2caa07c17dd8cebcceec">dictSlots</a>(db-&gt;<a class="code" href="structredis_db.html#aad961c2f260766ff3627bf363fef3551">dict</a>) * <span class="keyword">sizeof</span>(<a class="code" href="structdict_entry.html">dictEntry</a>*) +</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;              <a class="code" href="dict_8h.html#af193430dd3d5579a52b194512f72c1f0">dictSize</a>(db-&gt;<a class="code" href="structredis_db.html#aad961c2f260766ff3627bf363fef3551">dict</a>) * <span class="keyword">sizeof</span>(<a class="code" href="server_8h.html#a540f174d2685422fbd7d12e3cd44c8e2">robj</a>);</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        mh-&gt;<a class="code" href="structredis_mem_overhead.html#a92e2261ab8290fdc2955b81e5901203d">db</a>[mh-&gt;<a class="code" href="structredis_mem_overhead.html#a5fff22cf574851b502f713e7db2980fe">num_dbs</a>].<a class="code" href="structredis_mem_overhead.html#a1a15c326f9a9953cd14a0ba78aaea439">overhead_ht_main</a> = mem;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        mem_total+=mem;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        mem = <a class="code" href="dict_8h.html#af193430dd3d5579a52b194512f72c1f0">dictSize</a>(db-&gt;<a class="code" href="structredis_db.html#af8dcf36ca4b084db164becc8e1c71b67">expires</a>) * <span class="keyword">sizeof</span>(<a class="code" href="dict_8h.html#a950194070759a1e4bbdf8e107bec7df1">dictEntry</a>) +</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;              <a class="code" href="dict_8h.html#aca9596be4bcc2caa07c17dd8cebcceec">dictSlots</a>(db-&gt;<a class="code" href="structredis_db.html#af8dcf36ca4b084db164becc8e1c71b67">expires</a>) * <span class="keyword">sizeof</span>(<a class="code" href="structdict_entry.html">dictEntry</a>*);</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        mh-&gt;<a class="code" href="structredis_mem_overhead.html#a92e2261ab8290fdc2955b81e5901203d">db</a>[mh-&gt;<a class="code" href="structredis_mem_overhead.html#a5fff22cf574851b502f713e7db2980fe">num_dbs</a>].<a class="code" href="structredis_mem_overhead.html#a26a9170a61aa6eb593f9e57a2396a706">overhead_ht_expires</a> = mem;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        mem_total+=mem;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        mh-&gt;<a class="code" href="structredis_mem_overhead.html#a5fff22cf574851b502f713e7db2980fe">num_dbs</a>++;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    }</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#a2a959b51b26f4ced3ab179af23f19fba">overhead_total</a> = mem_total;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#a8747868103d88dad18f00837aaeca24a">dataset</a> = zmalloc_used - mem_total;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#ab748e7839b4db27ca41f802fb4deb3e1">peak_perc</a> = (float)zmalloc_used*100/mh-&gt;<a class="code" href="structredis_mem_overhead.html#a52004d56324eaeaabb6686b05052ca55">peak_allocated</a>;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="comment">/* Metrics computed after subtracting the startup memory from</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">     * the total memory. */</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordtype">size_t</span> net_usage = 1;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    if (zmalloc_used &gt; mh-&gt;<a class="code" href="structredis_mem_overhead.html#a0e982a0e14543ef6e17073a6d4afe191">startup_allocated</a>)</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        net_usage = zmalloc_used - mh-&gt;<a class="code" href="structredis_mem_overhead.html#a0e982a0e14543ef6e17073a6d4afe191">startup_allocated</a>;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#ad413cc014759c00757b5fda0d4c94c2e">dataset_perc</a> = (float)mh-&gt;<a class="code" href="structredis_mem_overhead.html#a8747868103d88dad18f00837aaeca24a">dataset</a>*100/net_usage;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    mh-&gt;<a class="code" href="structredis_mem_overhead.html#aa8888087ab630e5da0b3a0e179298d86">bytes_per_key</a> = mh-&gt;<a class="code" href="structredis_mem_overhead.html#ab0dd532666871698a3e8dc420ec74b28">total_keys</a> ? (net_usage / mh-&gt;<a class="code" href="structredis_mem_overhead.html#ab0dd532666871698a3e8dc420ec74b28">total_keys</a>) : 0;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">return</span> mh;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;}</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">/* Helper for &quot;MEMORY allocator-stats&quot;, used as a callback for the jemalloc</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment"> * stats output. */</span></div><div class="line"><a name="l01072"></a><span class="lineno"><a class="line" href="object_8c.html#a3157a90055dab4dce92cc76500c3a51b"> 1072</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="object_8c.html#a3157a90055dab4dce92cc76500c3a51b">inputCatSds</a>(<span class="keywordtype">void</span> *result, <span class="keyword">const</span> <span class="keywordtype">char</span> *str) {</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="comment">/* result is actually a (sds *), so re-cast it here */</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <a class="code" href="sds_8h.html#ad69abac3df4532879db9642c95f5ef6f">sds</a> *info = (<a class="code" href="sds_8h.html#ad69abac3df4532879db9642c95f5ef6f">sds</a> *)result;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    *info = <a class="code" href="sds_8c.html#a9153a5245ad08630651c7f4f212b5c6f">sdscat</a>(*info, str);</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;}</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">/* This implements MEMORY DOCTOR. An human readable analysis of the Redis</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment"> * memory condition. */</span></div><div class="line"><a name="l01080"></a><span class="lineno"><a class="line" href="object_8c.html#a946acba4fa7f28a34f3435bb98b452e0"> 1080</a></span>&#160;<a class="code" href="sds_8h.html#ad69abac3df4532879db9642c95f5ef6f">sds</a> <a class="code" href="object_8c.html#a946acba4fa7f28a34f3435bb98b452e0">getMemoryDoctorReport</a>(<span class="keywordtype">void</span>) {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordtype">int</span> empty = 0;          <span class="comment">/* Instance is empty or almost empty. */</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordtype">int</span> big_peak = 0;       <span class="comment">/* Memory peak is much larger than used mem. */</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordtype">int</span> high_frag = 0;      <span class="comment">/* High fragmentation. */</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="keywordtype">int</span> high_alloc_frag = 0;<span class="comment">/* High allocator fragmentation. */</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordtype">int</span> high_proc_rss = 0;  <span class="comment">/* High process rss overhead. */</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keywordtype">int</span> high_alloc_rss = 0; <span class="comment">/* High rss overhead. */</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keywordtype">int</span> big_slave_buf = 0;  <span class="comment">/* Slave buffers are too big. */</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="keywordtype">int</span> big_client_buf = 0; <span class="comment">/* Client buffers are too big. */</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="keywordtype">int</span> many_scripts = 0;   <span class="comment">/* Script cache has too many scripts. */</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keywordtype">int</span> num_reports = 0;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="keyword">struct </span><a class="code" href="structredis_mem_overhead.html">redisMemOverhead</a> *mh = <a class="code" href="object_8c.html#a1032572b4b3b6e9425744bb86d98ec15">getMemoryOverheadData</a>();</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordflow">if</span> (mh-&gt;<a class="code" href="structredis_mem_overhead.html#a3bb14855f7c280e92d0c01bbbc9b4c3c">total_allocated</a> &lt; (1024*1024*5)) {</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        empty = 1;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        num_reports++;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <span class="comment">/* Peak is &gt; 150% of current used memory? */</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <span class="keywordflow">if</span> (((<span class="keywordtype">float</span>)mh-&gt;<a class="code" href="structredis_mem_overhead.html#a52004d56324eaeaabb6686b05052ca55">peak_allocated</a> / mh-&gt;<a class="code" href="structredis_mem_overhead.html#a3bb14855f7c280e92d0c01bbbc9b4c3c">total_allocated</a>) &gt; 1.5) {</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            big_peak = 1;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            num_reports++;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        }</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <span class="comment">/* Fragmentation is higher than 1.4 and 10MB ?*/</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="keywordflow">if</span> (mh-&gt;<a class="code" href="structredis_mem_overhead.html#ac8bdd246c25c91aa5ae7af8362ff9188">total_frag</a> &gt; 1.4 &amp;&amp; mh-&gt;<a class="code" href="structredis_mem_overhead.html#a5e5705378e7ceb2bcfa33b637a7a6fd2">total_frag_bytes</a> &gt; 10&lt;&lt;20) {</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            high_frag = 1;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            num_reports++;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        }</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        <span class="comment">/* External fragmentation is higher than 1.1 and 10MB? */</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        <span class="keywordflow">if</span> (mh-&gt;<a class="code" href="structredis_mem_overhead.html#a6191ede96ce40757b7eb73d4bcc597f0">allocator_frag</a> &gt; 1.1 &amp;&amp; mh-&gt;<a class="code" href="structredis_mem_overhead.html#a7dcfd2bdf329730a992f30f52b145dbb">allocator_frag_bytes</a> &gt; 10&lt;&lt;20) {</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            high_alloc_frag = 1;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            num_reports++;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        }</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="comment">/* Allocator fss is higher than 1.1 and 10MB ? */</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <span class="keywordflow">if</span> (mh-&gt;<a class="code" href="structredis_mem_overhead.html#a213b026c5bb4a2421289b34e620eb4ef">allocator_rss</a> &gt; 1.1 &amp;&amp; mh-&gt;<a class="code" href="structredis_mem_overhead.html#a988880d896f03571a137a828ef96531a">allocator_rss_bytes</a> &gt; 10&lt;&lt;20) {</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            high_alloc_rss = 1;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            num_reports++;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        }</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="comment">/* Non-Allocator fss is higher than 1.1 and 10MB ? */</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        <span class="keywordflow">if</span> (mh-&gt;<a class="code" href="structredis_mem_overhead.html#ae1d7b7b42904d9ebb1698ab3ac79a2e9">rss_extra</a> &gt; 1.1 &amp;&amp; mh-&gt;<a class="code" href="structredis_mem_overhead.html#a9cafe99c292b52f795f9ceef838f4249">rss_extra_bytes</a> &gt; 10&lt;&lt;20) {</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;            high_proc_rss = 1;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            num_reports++;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        }</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="comment">/* Clients using more than 200k each average? */</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        <span class="keywordtype">long</span> numslaves = <a class="code" href="adlist_8h.html#afde0ab079f934670e82119b43120e94b">listLength</a>(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a6a317d8f5c5ed50aa4c4756bb5e95ee9">slaves</a>);</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="keywordtype">long</span> numclients = <a class="code" href="adlist_8h.html#afde0ab079f934670e82119b43120e94b">listLength</a>(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a268febb2b0b1add2594f2d7c8999567e">clients</a>)-numslaves;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        <span class="keywordflow">if</span> (mh-&gt;<a class="code" href="structredis_mem_overhead.html#af21382aaf8f931d992586bbfe5f8aca2">clients_normal</a> / numclients &gt; (1024*200)) {</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            big_client_buf = 1;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            num_reports++;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        }</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <span class="comment">/* Slaves using more than 10 MB each? */</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keywordflow">if</span> (numslaves &gt; 0 &amp;&amp; mh-&gt;<a class="code" href="structredis_mem_overhead.html#ace2b062189925c36433d3a8e68062d6e">clients_slaves</a> / numslaves &gt; (1024*1024*10)) {</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            big_slave_buf = 1;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            num_reports++;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        }</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="comment">/* Too many scripts are cached? */</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="dict_8h.html#af193430dd3d5579a52b194512f72c1f0">dictSize</a>(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a7f3d3d90cccad86c685008f3f02492fe">lua_scripts</a>) &gt; 1000) {</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            many_scripts = 1;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            num_reports++;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        }</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    }</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <a class="code" href="sds_8h.html#ad69abac3df4532879db9642c95f5ef6f">sds</a> s;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keywordflow">if</span> (num_reports == 0) {</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        s = <a class="code" href="sds_8c.html#a8924a4a105d0f6dc359685357ceaef57">sdsnew</a>(</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        <span class="stringliteral">&quot;Hi Sam, I can&#39;t find any memory issue in your instance. &quot;</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <span class="stringliteral">&quot;I can only account for what occurs on this base.\n&quot;</span>);</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (empty == 1) {</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        s = <a class="code" href="sds_8c.html#a8924a4a105d0f6dc359685357ceaef57">sdsnew</a>(</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <span class="stringliteral">&quot;Hi Sam, this instance is empty or is using very little memory, &quot;</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        <span class="stringliteral">&quot;my issues detector can&#39;t be used in these conditions. &quot;</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        <span class="stringliteral">&quot;Please, leave for your mission on Earth and fill it with some data. &quot;</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="stringliteral">&quot;The new Sam and I will be back to our programming as soon as I &quot;</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        <span class="stringliteral">&quot;finished rebooting.\n&quot;</span>);</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        s = <a class="code" href="sds_8c.html#a8924a4a105d0f6dc359685357ceaef57">sdsnew</a>(<span class="stringliteral">&quot;Sam, I detected a few issues in this Redis instance memory implants:\n\n&quot;</span>);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="keywordflow">if</span> (big_peak) {</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            s = <a class="code" href="sds_8c.html#a9153a5245ad08630651c7f4f212b5c6f">sdscat</a>(s,<span class="stringliteral">&quot; * Peak memory: In the past this instance used more than 150% the memory that is currently using. The allocator is normally not able to release memory after a peak, so you can expect to see a big fragmentation ratio, however this is actually harmless and is only due to the memory peak, and if the Redis instance Resident Set Size (RSS) is currently bigger than expected, the memory will be used as soon as you fill the Redis instance with more data. If the memory peak was only occasional and you want to try to reclaim memory, please try the MEMORY PURGE command, otherwise the only other option is to shutdown and restart the instance.\n\n&quot;</span>);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        }</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        <span class="keywordflow">if</span> (high_frag) {</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            s = <a class="code" href="sds_8c.html#a2f541b6443d075056a706b5b666066af">sdscatprintf</a>(s,<span class="stringliteral">&quot; * High total RSS: This instance has a memory fragmentation and RSS overhead greater than 1.4 (this means that the Resident Set Size of the Redis process is much larger than the sum of the logical allocations Redis performed). This problem is usually due either to a large peak memory (check if there is a peak memory entry above in the report) or may result from a workload that causes the allocator to fragment memory a lot. If the problem is a large peak memory, then there is no issue. Otherwise, make sure you are using the Jemalloc allocator and not the default libc malloc. Note: The currently used allocator is \&quot;%s\&quot;.\n\n&quot;</span>, <a class="code" href="zmalloc_8h.html#a374c6d7cf6c9817e1243093e03df7319">ZMALLOC_LIB</a>);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        }</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;        <span class="keywordflow">if</span> (high_alloc_frag) {</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            s = <a class="code" href="sds_8c.html#a2f541b6443d075056a706b5b666066af">sdscatprintf</a>(s,<span class="stringliteral">&quot; * High allocator fragmentation: This instance has an allocator external fragmentation greater than 1.1. This problem is usually due either to a large peak memory (check if there is a peak memory entry above in the report) or may result from a workload that causes the allocator to fragment memory a lot. You can try enabling &#39;activedefrag&#39; config option.\n\n&quot;</span>);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        }</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        <span class="keywordflow">if</span> (high_alloc_rss) {</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            s = <a class="code" href="sds_8c.html#a2f541b6443d075056a706b5b666066af">sdscatprintf</a>(s,<span class="stringliteral">&quot; * High allocator RSS overhead: This instance has an RSS memory overhead is greater than 1.1 (this means that the Resident Set Size of the allocator is much larger than the sum what the allocator actually holds). This problem is usually due to a large peak memory (check if there is a peak memory entry above in the report), you can try the MEMORY PURGE command to reclaim it.\n\n&quot;</span>);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        }</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <span class="keywordflow">if</span> (high_proc_rss) {</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            s = <a class="code" href="sds_8c.html#a2f541b6443d075056a706b5b666066af">sdscatprintf</a>(s,<span class="stringliteral">&quot; * High process RSS overhead: This instance has non-allocator RSS memory overhead is greater than 1.1 (this means that the Resident Set Size of the Redis process is much larger than the RSS the allocator holds). This problem may be due to Lua scripts or Modules.\n\n&quot;</span>);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        }</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        <span class="keywordflow">if</span> (big_slave_buf) {</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            s = <a class="code" href="sds_8c.html#a9153a5245ad08630651c7f4f212b5c6f">sdscat</a>(s,<span class="stringliteral">&quot; * Big replica buffers: The replica output buffers in this instance are greater than 10MB for each replica (on average). This likely means that there is some replica instance that is struggling receiving data, either because it is too slow or because of networking issues. As a result, data piles on the master output buffers. Please try to identify what replica is not receiving data correctly and why. You can use the INFO output in order to check the replicas delays and the CLIENT LIST command to check the output buffers of each replica.\n\n&quot;</span>);</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        }</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        <span class="keywordflow">if</span> (big_client_buf) {</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            s = <a class="code" href="sds_8c.html#a9153a5245ad08630651c7f4f212b5c6f">sdscat</a>(s,<span class="stringliteral">&quot; * Big client buffers: The clients output buffers in this instance are greater than 200K per client (on average). This may result from different causes, like Pub/Sub clients subscribed to channels bot not receiving data fast enough, so that data piles on the Redis instance output buffer, or clients sending commands with large replies or very large sequences of commands in the same pipeline. Please use the CLIENT LIST command in order to investigate the issue if it causes problems in your instance, or to understand better why certain clients are using a big amount of memory.\n\n&quot;</span>);</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        <span class="keywordflow">if</span> (many_scripts) {</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;            s = <a class="code" href="sds_8c.html#a9153a5245ad08630651c7f4f212b5c6f">sdscat</a>(s,<span class="stringliteral">&quot; * Many scripts: There seem to be many cached scripts in this instance (more than 1000). This may be because scripts are generated and `EVAL`ed, instead of being parameterized (with KEYS and ARGV), `SCRIPT LOAD`ed and `EVALSHA`ed. Unless `SCRIPT FLUSH` is called periodically, the scripts&#39; caches may end up consuming most of your memory.\n\n&quot;</span>);</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        }</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        s = <a class="code" href="sds_8c.html#a9153a5245ad08630651c7f4f212b5c6f">sdscat</a>(s,<span class="stringliteral">&quot;I&#39;m here to keep you safe, Sam. I want to help you.\n&quot;</span>);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    }</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <a class="code" href="object_8c.html#ab09baeae3f0b14d5e0f36b7a8af2bdcf">freeMemoryOverheadData</a>(mh);</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordflow">return</span> s;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;}</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">/* Set the object LRU/LFU depending on server.maxmemory_policy.</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment"> * The lfu_freq arg is only relevant if policy is MAXMEMORY_FLAG_LFU.</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment"> * The lru_idle and lru_clock args are only relevant if policy </span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment"> * is MAXMEMORY_FLAG_LRU.</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment"> * Either or both of them may be &lt;0, in that case, nothing is set. */</span></div><div class="line"><a name="l01197"></a><span class="lineno"><a class="line" href="server_8h.html#ae793c69b79f7e18a50ec3ee4a9cb4d3a"> 1197</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="object_8c.html#ae793c69b79f7e18a50ec3ee4a9cb4d3a">objectSetLRUOrLFU</a>(<a class="code" href="structredis_object.html">robj</a> *val, <span class="keywordtype">long</span> <span class="keywordtype">long</span> lfu_freq, <span class="keywordtype">long</span> <span class="keywordtype">long</span> lru_idle,</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                       <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="server_8c.html#a9ace62050a85a5451725d854408867df">lru_clock</a>) {</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a98440b0fba87820830ee90965c9f54f4">maxmemory_policy</a> &amp; <a class="code" href="server_8h.html#aac2d3ad7a604f87e06e25233dbd01c9b">MAXMEMORY_FLAG_LFU</a>) {</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="keywordflow">if</span> (lfu_freq &gt;= 0) {</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            <a class="code" href="server_8h.html#a88114b5169b4c382df6b56506285e56a">serverAssert</a>(lfu_freq &lt;= 255);</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            val-&gt;<a class="code" href="structredis_object.html#abe5aec51795e89d8bdaf84d58d8eb00a">lru</a> = (<a class="code" href="evict_8c.html#a4b537077f1fe662170675678d354d93c">LFUGetTimeInMinutes</a>()&lt;&lt;8) | lfu_freq;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        }</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lru_idle &gt;= 0) {</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        <span class="comment">/* Serialized LRU idle time is in seconds. Scale</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">         * according to the LRU clock resolution this Redis</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">         * instance was compiled with (normally 1000 ms, so the</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">         * below statement will expand to lru_idle*1000/1000. */</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        lru_idle = lru_idle*1000/<a class="code" href="server_8h.html#ace9135e475fa92a1d52f0c5782687efe">LRU_CLOCK_RESOLUTION</a>;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        val-&gt;<a class="code" href="structredis_object.html#abe5aec51795e89d8bdaf84d58d8eb00a">lru</a> = lru_clock - lru_idle;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        <span class="comment">/* If the lru field overflows (since LRU it is a wrapping</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment">         * clock), the best we can do is to provide the maximum</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">         * representable idle time. */</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="keywordflow">if</span> (val-&gt;<a class="code" href="structredis_object.html#abe5aec51795e89d8bdaf84d58d8eb00a">lru</a> &lt; 0) val-&gt;<a class="code" href="structredis_object.html#abe5aec51795e89d8bdaf84d58d8eb00a">lru</a> = lru_clock+1;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    }</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;}</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">/* ======================= The OBJECT and MEMORY commands =================== */</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">/* This is a helper function for the OBJECT command. We need to lookup keys</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment"> * without any modification of LRU or other parameters. */</span></div><div class="line"><a name="l01222"></a><span class="lineno"><a class="line" href="server_8h.html#a9137654b1169778bf6c8b8439667e44e"> 1222</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a9137654b1169778bf6c8b8439667e44e">objectCommandLookup</a>(<a class="code" href="structclient.html">client</a> *c, <a class="code" href="structredis_object.html">robj</a> *<a class="code" href="redis-check-rdb_8c.html#adc0ee0ed345db513fb6fac27511be4f1">key</a>) {</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <a class="code" href="structdict_entry.html">dictEntry</a> *de;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keywordflow">if</span> ((de = <a class="code" href="dict_8c.html#a4d5d9616ce7b918632afcc9bd03f6a90">dictFind</a>(c-&gt;<a class="code" href="structclient.html#a9bee04e09635a42fef289e42a89f5502">db</a>-&gt;<a class="code" href="structredis_db.html#aad961c2f260766ff3627bf363fef3551">dict</a>,key-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>)) == NULL) <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="structredis_object.html">robj</a>*) <a class="code" href="dict_8h.html#ae8d2cc391873b2bea2b87c4f80f43120">dictGetVal</a>(de);</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;}</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"><a class="line" href="server_8h.html#a4b47bf3e99f2b333ee7f6106c532d6b5"> 1229</a></span>&#160;<a class="code" href="structredis_object.html">robj</a> *<a class="code" href="object_8c.html#a4b47bf3e99f2b333ee7f6106c532d6b5">objectCommandLookupOrReply</a>(<a class="code" href="structclient.html">client</a> *c, <a class="code" href="structredis_object.html">robj</a> *<a class="code" href="redis-check-rdb_8c.html#adc0ee0ed345db513fb6fac27511be4f1">key</a>, <a class="code" href="structredis_object.html">robj</a> *reply) {</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *o = <a class="code" href="object_8c.html#a9137654b1169778bf6c8b8439667e44e">objectCommandLookup</a>(c,key);</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordflow">if</span> (!o) <a class="code" href="networking_8c.html#ac47c2cfd2a6d524fcbfefa9a18e3a9a3">addReply</a>(c, reply);</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordflow">return</span> o;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;}</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">/* Object command allows to inspect the internals of an Redis Object.</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="comment"> * Usage: OBJECT &lt;refcount|encoding|idletime|freq&gt; &lt;key&gt; */</span></div><div class="line"><a name="l01238"></a><span class="lineno"><a class="line" href="server_8h.html#af4babb9f5d489b16aebeafedfa0ee244"> 1238</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="object_8c.html#af4babb9f5d489b16aebeafedfa0ee244">objectCommand</a>(<a class="code" href="structclient.html">client</a> *c) {</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *o;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structclient.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 2 &amp;&amp; !strcasecmp(c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[1]-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,<span class="stringliteral">&quot;help&quot;</span>)) {</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *help[] = {</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="stringliteral">&quot;ENCODING &lt;key&gt; -- Return the kind of internal representation used in order to store the value associated with a key.&quot;</span>,</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="stringliteral">&quot;FREQ &lt;key&gt; -- Return the access frequency index of the key. The returned integer is proportional to the logarithm of the recent access frequency of the key.&quot;</span>,</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="stringliteral">&quot;IDLETIME &lt;key&gt; -- Return the idle time of the key, that is the approximated number of seconds elapsed since the last access to the key.&quot;</span>,</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="stringliteral">&quot;REFCOUNT &lt;key&gt; -- Return the number of references of the value associated with the specified key.&quot;</span>,</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;NULL</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        };</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <a class="code" href="networking_8c.html#a1212877b63a97d8b0e209e441d998704">addReplyHelp</a>(c, help);</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[1]-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,<span class="stringliteral">&quot;refcount&quot;</span>) &amp;&amp; c-&gt;<a class="code" href="structclient.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 3) {</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <span class="keywordflow">if</span> ((o = <a class="code" href="object_8c.html#a4b47bf3e99f2b333ee7f6106c532d6b5">objectCommandLookupOrReply</a>(c,c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[2],<a class="code" href="server_8c.html#ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8">shared</a>.<a class="code" href="structshared_objects_struct.html#a9b39b9335155d55eb2e631def6827b82">nullbulk</a>))</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                == NULL) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,o-&gt;<a class="code" href="structredis_object.html#a6022c8a609170c7365fb96e83cb2df48">refcount</a>);</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[1]-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,<span class="stringliteral">&quot;encoding&quot;</span>) &amp;&amp; c-&gt;<a class="code" href="structclient.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 3) {</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="keywordflow">if</span> ((o = <a class="code" href="object_8c.html#a4b47bf3e99f2b333ee7f6106c532d6b5">objectCommandLookupOrReply</a>(c,c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[2],<a class="code" href="server_8c.html#ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8">shared</a>.<a class="code" href="structshared_objects_struct.html#a9b39b9335155d55eb2e631def6827b82">nullbulk</a>))</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                == NULL) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<a class="code" href="object_8c.html#a89772282d38fe17fe42ec0087c0e9bd5">strEncoding</a>(o-&gt;<a class="code" href="structredis_object.html#adecc103e438ee35843ae312812d974a0">encoding</a>));</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[1]-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,<span class="stringliteral">&quot;idletime&quot;</span>) &amp;&amp; c-&gt;<a class="code" href="structclient.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 3) {</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="keywordflow">if</span> ((o = <a class="code" href="object_8c.html#a4b47bf3e99f2b333ee7f6106c532d6b5">objectCommandLookupOrReply</a>(c,c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[2],<a class="code" href="server_8c.html#ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8">shared</a>.<a class="code" href="structshared_objects_struct.html#a9b39b9335155d55eb2e631def6827b82">nullbulk</a>))</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                == NULL) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a98440b0fba87820830ee90965c9f54f4">maxmemory_policy</a> &amp; <a class="code" href="server_8h.html#aac2d3ad7a604f87e06e25233dbd01c9b">MAXMEMORY_FLAG_LFU</a>) {</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            <a class="code" href="networking_8c.html#a0ea8df2930509a88eb4e98348b85a51d">addReplyError</a>(c,<span class="stringliteral">&quot;An LFU maxmemory policy is selected, idle time not tracked. Please note that when switching between policies at runtime LRU and LFU data will take some time to adjust.&quot;</span>);</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        }</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,<a class="code" href="evict_8c.html#a88b01fac0bdcdbf799459a4046b18067">estimateObjectIdleTime</a>(o)/1000);</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[1]-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,<span class="stringliteral">&quot;freq&quot;</span>) &amp;&amp; c-&gt;<a class="code" href="structclient.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 3) {</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="keywordflow">if</span> ((o = <a class="code" href="object_8c.html#a4b47bf3e99f2b333ee7f6106c532d6b5">objectCommandLookupOrReply</a>(c,c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[2],<a class="code" href="server_8c.html#ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8">shared</a>.<a class="code" href="structshared_objects_struct.html#a9b39b9335155d55eb2e631def6827b82">nullbulk</a>))</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                == NULL) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <span class="keywordflow">if</span> (!(<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#a98440b0fba87820830ee90965c9f54f4">maxmemory_policy</a> &amp; <a class="code" href="server_8h.html#aac2d3ad7a604f87e06e25233dbd01c9b">MAXMEMORY_FLAG_LFU</a>)) {</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            <a class="code" href="networking_8c.html#a0ea8df2930509a88eb4e98348b85a51d">addReplyError</a>(c,<span class="stringliteral">&quot;An LFU maxmemory policy is not selected, access frequency not tracked. Please note that when switching between policies at runtime LRU and LFU data will take some time to adjust.&quot;</span>);</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        }</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        <span class="comment">/* LFUDecrAndReturn should be called</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">         * in case of the key has not been accessed for a long time,</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">         * because we update the access time only</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">         * when the key is read or overwritten. */</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,<a class="code" href="evict_8c.html#a9f342de41fcca27af0539524ab2cf97d">LFUDecrAndReturn</a>(o));</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <a class="code" href="networking_8c.html#a366061d66aea3d3d043f1a49af18ffcc">addReplySubcommandSyntaxError</a>(c);</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    }</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;}</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">/* The memory command will eventually be a complete interface for the</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment"> * memory introspection capabilities of Redis.</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment"> * Usage: MEMORY usage &lt;key&gt; */</span></div><div class="line"><a name="l01287"></a><span class="lineno"><a class="line" href="server_8h.html#a082ea922419a3d6fe58a9b369e89f359"> 1287</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="object_8c.html#a082ea922419a3d6fe58a9b369e89f359">memoryCommand</a>(<a class="code" href="structclient.html">client</a> *c) {</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <a class="code" href="structredis_object.html">robj</a> *o;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordflow">if</span> (!strcasecmp(c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[1]-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,<span class="stringliteral">&quot;usage&quot;</span>) &amp;&amp; c-&gt;<a class="code" href="structclient.html#ad1447518f4372828b8435ae82e48499e">argc</a> &gt;= 3) {</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> samples = <a class="code" href="object_8c.html#a46d9ae99d237582e21c70e7de56a032e">OBJ_COMPUTE_SIZE_DEF_SAMPLES</a>;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 3; j &lt; c-&gt;<a class="code" href="structclient.html#ad1447518f4372828b8435ae82e48499e">argc</a>; j++) {</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            <span class="keywordflow">if</span> (!strcasecmp(c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[j]-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,<span class="stringliteral">&quot;samples&quot;</span>) &amp;&amp;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                j+1 &lt; c-&gt;<a class="code" href="structclient.html#ad1447518f4372828b8435ae82e48499e">argc</a>)</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;            {</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="object_8c.html#a39155431bb51f438f1e38f0ec06366a2">getLongLongFromObjectOrReply</a>(c,c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[j+1],&amp;samples,NULL)</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                     == <a class="code" href="server_8h.html#af98ac28d5f4d23d7ed5985188e6fb7d1">C_ERR</a>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                <span class="keywordflow">if</span> (samples &lt; 0) {</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                    <a class="code" href="networking_8c.html#ac47c2cfd2a6d524fcbfefa9a18e3a9a3">addReply</a>(c,<a class="code" href="server_8c.html#ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8">shared</a>.<a class="code" href="structshared_objects_struct.html#aff4b27537592388d89ec9788325cc134">syntaxerr</a>);</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                }</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                <span class="keywordflow">if</span> (samples == 0) samples = LLONG_MAX;;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                j++; <span class="comment">/* skip option argument. */</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                <a class="code" href="networking_8c.html#ac47c2cfd2a6d524fcbfefa9a18e3a9a3">addReply</a>(c,<a class="code" href="server_8c.html#ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8">shared</a>.<a class="code" href="structshared_objects_struct.html#aff4b27537592388d89ec9788325cc134">syntaxerr</a>);</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            }</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        }</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <span class="keywordflow">if</span> ((o = <a class="code" href="object_8c.html#a4b47bf3e99f2b333ee7f6106c532d6b5">objectCommandLookupOrReply</a>(c,c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[2],<a class="code" href="server_8c.html#ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8">shared</a>.<a class="code" href="structshared_objects_struct.html#a9b39b9335155d55eb2e631def6827b82">nullbulk</a>))</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                == NULL) <span class="keywordflow">return</span>;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="server_8c.html#ae8605e2b78cd4a81b6c6b5c30cb7366a">usage</a> = <a class="code" href="object_8c.html#a3f9054ae0c2ce0a1fd35c1863d14177c">objectComputeSize</a>(o,samples);</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        usage += <a class="code" href="sds_8c.html#a8633545cba735b390afad7bf8b5a9833">sdsAllocSize</a>(c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[2]-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        usage += <span class="keyword">sizeof</span>(<a class="code" href="dict_8h.html#a950194070759a1e4bbdf8e107bec7df1">dictEntry</a>);</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,usage);</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[1]-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,<span class="stringliteral">&quot;stats&quot;</span>) &amp;&amp; c-&gt;<a class="code" href="structclient.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 2) {</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        <span class="keyword">struct </span><a class="code" href="structredis_mem_overhead.html">redisMemOverhead</a> *mh = <a class="code" href="object_8c.html#a1032572b4b3b6e9425744bb86d98ec15">getMemoryOverheadData</a>();</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <a class="code" href="networking_8c.html#abe873add36c720d962820c00176f7490">addReplyMultiBulkLen</a>(c,(25+mh-&gt;<a class="code" href="structredis_mem_overhead.html#a5fff22cf574851b502f713e7db2980fe">num_dbs</a>)*2);</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;peak.allocated&quot;</span>);</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#a52004d56324eaeaabb6686b05052ca55">peak_allocated</a>);</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;total.allocated&quot;</span>);</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#a3bb14855f7c280e92d0c01bbbc9b4c3c">total_allocated</a>);</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;startup.allocated&quot;</span>);</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#a0e982a0e14543ef6e17073a6d4afe191">startup_allocated</a>);</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;replication.backlog&quot;</span>);</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#a4377a6a963ee32e22c7c7f14180a4a31">repl_backlog</a>);</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;clients.slaves&quot;</span>);</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#ace2b062189925c36433d3a8e68062d6e">clients_slaves</a>);</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;clients.normal&quot;</span>);</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#af21382aaf8f931d992586bbfe5f8aca2">clients_normal</a>);</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;aof.buffer&quot;</span>);</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#ad441a7ae10a5fee32c6d0b0dbfc92791">aof_buffer</a>);</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;lua.caches&quot;</span>);</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#aede1fc4f53c4e19111df241fe70fb77c">lua_caches</a>);</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; mh-&gt;<a class="code" href="structredis_mem_overhead.html#a5fff22cf574851b502f713e7db2980fe">num_dbs</a>; j++) {</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;            <span class="keywordtype">char</span> dbname[32];</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            snprintf(dbname,<span class="keyword">sizeof</span>(dbname),<span class="stringliteral">&quot;db.%zd&quot;</span>,mh-&gt;<a class="code" href="structredis_mem_overhead.html#a92e2261ab8290fdc2955b81e5901203d">db</a>[j].<a class="code" href="structredis_mem_overhead.html#a8379ee7de31460d30fac72e27c81fd7a">dbid</a>);</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,dbname);</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            <a class="code" href="networking_8c.html#abe873add36c720d962820c00176f7490">addReplyMultiBulkLen</a>(c,4);</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;            <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;overhead.hashtable.main&quot;</span>);</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#a92e2261ab8290fdc2955b81e5901203d">db</a>[j].<a class="code" href="structredis_mem_overhead.html#a1a15c326f9a9953cd14a0ba78aaea439">overhead_ht_main</a>);</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;overhead.hashtable.expires&quot;</span>);</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#a92e2261ab8290fdc2955b81e5901203d">db</a>[j].<a class="code" href="structredis_mem_overhead.html#a26a9170a61aa6eb593f9e57a2396a706">overhead_ht_expires</a>);</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        }</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;overhead.total&quot;</span>);</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#a2a959b51b26f4ced3ab179af23f19fba">overhead_total</a>);</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;keys.count&quot;</span>);</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#ab0dd532666871698a3e8dc420ec74b28">total_keys</a>);</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;keys.bytes-per-key&quot;</span>);</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#aa8888087ab630e5da0b3a0e179298d86">bytes_per_key</a>);</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;dataset.bytes&quot;</span>);</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#a8747868103d88dad18f00837aaeca24a">dataset</a>);</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;dataset.percentage&quot;</span>);</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        <a class="code" href="networking_8c.html#a22f3761ad780e2f1a0d7bcd213f34eb1">addReplyDouble</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#ad413cc014759c00757b5fda0d4c94c2e">dataset_perc</a>);</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;peak.percentage&quot;</span>);</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        <a class="code" href="networking_8c.html#a22f3761ad780e2f1a0d7bcd213f34eb1">addReplyDouble</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#ab748e7839b4db27ca41f802fb4deb3e1">peak_perc</a>);</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;allocator.allocated&quot;</span>);</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#a35a8adbf64bc20a4ab20cf3872ea5e54">allocator_allocated</a>);</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;allocator.active&quot;</span>);</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#a78e452f18e74cbf8be28858f49c0ff0b">allocator_active</a>);</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;allocator.resident&quot;</span>);</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,<a class="code" href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a>.<a class="code" href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">cron_malloc_stats</a>.<a class="code" href="structmalloc__stats.html#abaf85ea7348d3c27fea44dcc7cebd639">allocator_resident</a>);</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;allocator-fragmentation.ratio&quot;</span>);</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        <a class="code" href="networking_8c.html#a22f3761ad780e2f1a0d7bcd213f34eb1">addReplyDouble</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#a6191ede96ce40757b7eb73d4bcc597f0">allocator_frag</a>);</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;allocator-fragmentation.bytes&quot;</span>);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#a7dcfd2bdf329730a992f30f52b145dbb">allocator_frag_bytes</a>);</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;allocator-rss.ratio&quot;</span>);</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        <a class="code" href="networking_8c.html#a22f3761ad780e2f1a0d7bcd213f34eb1">addReplyDouble</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#a213b026c5bb4a2421289b34e620eb4ef">allocator_rss</a>);</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;allocator-rss.bytes&quot;</span>);</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#a988880d896f03571a137a828ef96531a">allocator_rss_bytes</a>);</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;rss-overhead.ratio&quot;</span>);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        <a class="code" href="networking_8c.html#a22f3761ad780e2f1a0d7bcd213f34eb1">addReplyDouble</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#ae1d7b7b42904d9ebb1698ab3ac79a2e9">rss_extra</a>);</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;rss-overhead.bytes&quot;</span>);</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#a9cafe99c292b52f795f9ceef838f4249">rss_extra_bytes</a>);</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;fragmentation&quot;</span>); <span class="comment">/* this is the total RSS overhead, including fragmentation */</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        <a class="code" href="networking_8c.html#a22f3761ad780e2f1a0d7bcd213f34eb1">addReplyDouble</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#ac8bdd246c25c91aa5ae7af8362ff9188">total_frag</a>); <span class="comment">/* it is kept here for backwards compatibility */</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;fragmentation.bytes&quot;</span>);</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;        <a class="code" href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a>(c,mh-&gt;<a class="code" href="structredis_mem_overhead.html#a5e5705378e7ceb2bcfa33b637a7a6fd2">total_frag_bytes</a>);</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <a class="code" href="object_8c.html#ab09baeae3f0b14d5e0f36b7a8af2bdcf">freeMemoryOverheadData</a>(mh);</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[1]-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,<span class="stringliteral">&quot;malloc-stats&quot;</span>) &amp;&amp; c-&gt;<a class="code" href="structclient.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 2) {</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="preprocessor">#if defined(USE_JEMALLOC)</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        <a class="code" href="sds_8h.html#ad69abac3df4532879db9642c95f5ef6f">sds</a> info = <a class="code" href="sds_8c.html#af0bb695d269439f719caca4129989090">sdsempty</a>();</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        je_malloc_stats_print(<a class="code" href="object_8c.html#a3157a90055dab4dce92cc76500c3a51b">inputCatSds</a>, &amp;info, NULL);</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        <a class="code" href="networking_8c.html#aa9a8085743464110cd10338fa89d22cd">addReplyBulkSds</a>(c, info);</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,<span class="stringliteral">&quot;Stats not supported for the current allocator&quot;</span>);</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[1]-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,<span class="stringliteral">&quot;doctor&quot;</span>) &amp;&amp; c-&gt;<a class="code" href="structclient.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 2) {</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <a class="code" href="sds_8h.html#ad69abac3df4532879db9642c95f5ef6f">sds</a> report = <a class="code" href="object_8c.html#a946acba4fa7f28a34f3435bb98b452e0">getMemoryDoctorReport</a>();</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        <a class="code" href="networking_8c.html#aa9a8085743464110cd10338fa89d22cd">addReplyBulkSds</a>(c,report);</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[1]-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,<span class="stringliteral">&quot;purge&quot;</span>) &amp;&amp; c-&gt;<a class="code" href="structclient.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 2) {</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="preprocessor">#if defined(USE_JEMALLOC)</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <span class="keywordtype">char</span> tmp[32];</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        <span class="keywordtype">unsigned</span> narenas = 0;</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        <span class="keywordtype">size_t</span> sz = <span class="keyword">sizeof</span>(unsigned);</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        <span class="keywordflow">if</span> (!je_mallctl(<span class="stringliteral">&quot;arenas.narenas&quot;</span>, &amp;narenas, &amp;sz, NULL, 0)) {</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;            sprintf(tmp, <span class="stringliteral">&quot;arena.%d.purge&quot;</span>, narenas);</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            <span class="keywordflow">if</span> (!je_mallctl(tmp, NULL, 0, NULL, 0)) {</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                <a class="code" href="networking_8c.html#ac47c2cfd2a6d524fcbfefa9a18e3a9a3">addReply</a>(c, <a class="code" href="server_8c.html#ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8">shared</a>.<a class="code" href="structshared_objects_struct.html#adf30e1960aaa30991c8cc6f5d1b8f1f5">ok</a>);</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;            }</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        }</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <a class="code" href="networking_8c.html#a0ea8df2930509a88eb4e98348b85a51d">addReplyError</a>(c, <span class="stringliteral">&quot;Error purging dirty pages&quot;</span>);</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <a class="code" href="networking_8c.html#ac47c2cfd2a6d524fcbfefa9a18e3a9a3">addReply</a>(c, <a class="code" href="server_8c.html#ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8">shared</a>.<a class="code" href="structshared_objects_struct.html#adf30e1960aaa30991c8cc6f5d1b8f1f5">ok</a>);</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="comment">/* Nothing to do for other allocators. */</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(c-&gt;<a class="code" href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">argv</a>[1]-&gt;<a class="code" href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>,<span class="stringliteral">&quot;help&quot;</span>) &amp;&amp; c-&gt;<a class="code" href="structclient.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 2) {</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        <a class="code" href="networking_8c.html#abe873add36c720d962820c00176f7490">addReplyMultiBulkLen</a>(c,5);</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="stringliteral">&quot;MEMORY DOCTOR                        - Outputs memory problems report&quot;</span>);</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="stringliteral">&quot;MEMORY USAGE &lt;key&gt; [SAMPLES &lt;count&gt;] - Estimate memory usage of key&quot;</span>);</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="stringliteral">&quot;MEMORY STATS                         - Show memory usage details&quot;</span>);</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="stringliteral">&quot;MEMORY PURGE                         - Ask the allocator to release memory&quot;</span>);</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        <a class="code" href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a>(c,</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="stringliteral">&quot;MEMORY MALLOC-STATS                  - Show allocator internal stats&quot;</span>);</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <a class="code" href="networking_8c.html#a0ea8df2930509a88eb4e98348b85a51d">addReplyError</a>(c,<span class="stringliteral">&quot;Syntax error. Try MEMORY HELP&quot;</span>);</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    }</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;}</div><div class="ttc" id="structredis_mem_overhead_html_a6191ede96ce40757b7eb73d4bcc597f0"><div class="ttname"><a href="structredis_mem_overhead.html#a6191ede96ce40757b7eb73d4bcc597f0">redisMemOverhead::allocator_frag</a></div><div class="ttdeci">float allocator_frag</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00868">server.h:868</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_ad413cc014759c00757b5fda0d4c94c2e"><div class="ttname"><a href="structredis_mem_overhead.html#ad413cc014759c00757b5fda0d4c94c2e">redisMemOverhead::dataset_perc</a></div><div class="ttdeci">float dataset_perc</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00864">server.h:864</a></div></div>
<div class="ttc" id="server_8h_html_ace9135e475fa92a1d52f0c5782687efe"><div class="ttname"><a href="server_8h.html#ace9135e475fa92a1d52f0c5782687efe">LRU_CLOCK_RESOLUTION</a></div><div class="ttdeci">#define LRU_CLOCK_RESOLUTION</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00600">server.h:600</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a988880d896f03571a137a828ef96531a"><div class="ttname"><a href="structredis_mem_overhead.html#a988880d896f03571a137a828ef96531a">redisMemOverhead::allocator_rss_bytes</a></div><div class="ttdeci">size_t allocator_rss_bytes</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00871">server.h:871</a></div></div>
<div class="ttc" id="structredis_server_html_ac781bc597dbf0ec72337e6c648a55817"><div class="ttname"><a href="structredis_server.html#ac781bc597dbf0ec72337e6c648a55817">redisServer::cron_malloc_stats</a></div><div class="ttdeci">struct malloc_stats cron_malloc_stats</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l01021">server.h:1021</a></div></div>
<div class="ttc" id="structredis_object_html"><div class="ttname"><a href="structredis_object.html">redisObject</a></div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00603">server.h:603</a></div></div>
<div class="ttc" id="object_8c_html_a49de04ba218b5603d00087cfc6029e82"><div class="ttname"><a href="object_8c.html#a49de04ba218b5603d00087cfc6029e82">createStringObjectFromLongLongWithOptions</a></div><div class="ttdeci">robj * createStringObjectFromLongLongWithOptions(long long value, int valueobj)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00133">object.c:133</a></div></div>
<div class="ttc" id="dict_8c_html_a8bfc6c2908c66772c09a1315c078bf06"><div class="ttname"><a href="dict_8c.html#a8bfc6c2908c66772c09a1315c078bf06">dictReleaseIterator</a></div><div class="ttdeci">void dictReleaseIterator(dictIterator *iter)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8c_source.html#l00597">dict.c:597</a></div></div>
<div class="ttc" id="util_8h_html_a29779c072e924ef4e3c8186fd9748291"><div class="ttname"><a href="util_8h.html#a29779c072e924ef4e3c8186fd9748291">MAX_LONG_DOUBLE_CHARS</a></div><div class="ttdeci">#define MAX_LONG_DOUBLE_CHARS</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00039">util.h:39</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_ace2b062189925c36433d3a8e68062d6e"><div class="ttname"><a href="structredis_mem_overhead.html#ace2b062189925c36433d3a8e68062d6e">redisMemOverhead::clients_slaves</a></div><div class="ttdeci">size_t clients_slaves</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00856">server.h:856</a></div></div>
<div class="ttc" id="structzskiplist_html_ade3018e820093435bd6592a7e5667dd4"><div class="ttname"><a href="structzskiplist.html#ade3018e820093435bd6592a7e5667dd4">zskiplist::header</a></div><div class="ttdeci">struct zskiplistNode * header</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00807">server.h:807</a></div></div>
<div class="ttc" id="structclient_html_ad1447518f4372828b8435ae82e48499e"><div class="ttname"><a href="structclient.html#ad1447518f4372828b8435ae82e48499e">client::argc</a></div><div class="ttdeci">int argc</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00721">server.h:721</a></div></div>
<div class="ttc" id="util_8c_html_a5c8ac146ff5b5323cacafbeb0e53cda0"><div class="ttname"><a href="util_8c.html#a5c8ac146ff5b5323cacafbeb0e53cda0">string2ll</a></div><div class="ttdeci">int string2ll(const char *s, size_t slen, long long *value)</div><div class="ttdef"><b>Definition:</b> <a href="util_8c_source.html#l00343">util.c:343</a></div></div>
<div class="ttc" id="object_8c_html_a082ea922419a3d6fe58a9b369e89f359"><div class="ttname"><a href="object_8c.html#a082ea922419a3d6fe58a9b369e89f359">memoryCommand</a></div><div class="ttdeci">void memoryCommand(client *c)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l01287">object.c:1287</a></div></div>
<div class="ttc" id="structrax_iterator_html"><div class="ttname"><a href="structrax_iterator.html">raxIterator</a></div><div class="ttdef"><b>Definition:</b> <a href="rax_8h_source.html#l00175">rax.h:175</a></div></div>
<div class="ttc" id="networking_8c_html_a366061d66aea3d3d043f1a49af18ffcc"><div class="ttname"><a href="networking_8c.html#a366061d66aea3d3d043f1a49af18ffcc">addReplySubcommandSyntaxError</a></div><div class="ttdeci">void addReplySubcommandSyntaxError(client *c)</div><div class="ttdef"><b>Definition:</b> <a href="networking_8c_source.html#l00628">networking.c:628</a></div></div>
<div class="ttc" id="quicklist_8c_html_ab4a7a85e7a80ef6cf36534f9c765f058"><div class="ttname"><a href="quicklist_8c.html#ab4a7a85e7a80ef6cf36534f9c765f058">quicklistCreate</a></div><div class="ttdeci">quicklist * quicklistCreate(void)</div><div class="ttdef"><b>Definition:</b> <a href="quicklist_8c_source.html#l00094">quicklist.c:94</a></div></div>
<div class="ttc" id="object_8c_html_ab42800614721abadb142208f8e72cc9d"><div class="ttname"><a href="object_8c.html#ab42800614721abadb142208f8e72cc9d">freeListObject</a></div><div class="ttdeci">void freeListObject(robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00287">object.c:287</a></div></div>
<div class="ttc" id="object_8c_html_a946acba4fa7f28a34f3435bb98b452e0"><div class="ttname"><a href="object_8c.html#a946acba4fa7f28a34f3435bb98b452e0">getMemoryDoctorReport</a></div><div class="ttdeci">sds getMemoryDoctorReport(void)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l01080">object.c:1080</a></div></div>
<div class="ttc" id="server_8c_html_ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8"><div class="ttname"><a href="server_8c.html#ad92fdd9d5f8f9dbf3a0e0ca9848b6eb8">shared</a></div><div class="ttdeci">struct sharedObjectsStruct shared</div><div class="ttdef"><b>Definition:</b> <a href="server_8c_source.html#l00061">server.c:61</a></div></div>
<div class="ttc" id="server_8h_html_a11cc378e7778a830b41240578de3b204"><div class="ttname"><a href="server_8h.html#a11cc378e7778a830b41240578de3b204">serverPanic</a></div><div class="ttdeci">#define serverPanic(...)</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00457">server.h:457</a></div></div>
<div class="ttc" id="object_8c_html_a4dceec0f005ea221a5ee41659297ce30"><div class="ttname"><a href="object_8c.html#a4dceec0f005ea221a5ee41659297ce30">streamRadixTreeMemoryUsage</a></div><div class="ttdeci">size_t streamRadixTreeMemoryUsage(rax *rax)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00758">object.c:758</a></div></div>
<div class="ttc" id="intset_8c_html_a5f05ce0b2c1427fdc978b8a530d450eb"><div class="ttname"><a href="intset_8c.html#a5f05ce0b2c1427fdc978b8a530d450eb">intsetNew</a></div><div class="ttdeci">intset * intsetNew(void)</div><div class="ttdef"><b>Definition:</b> <a href="intset_8c_source.html#l00097">intset.c:97</a></div></div>
<div class="ttc" id="server_8h_html_a5226306fbcebcb6d5d02e0fef3c213c2"><div class="ttname"><a href="server_8h.html#a5226306fbcebcb6d5d02e0fef3c213c2">AOF_OFF</a></div><div class="ttdeci">#define AOF_OFF</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00223">server.h:223</a></div></div>
<div class="ttc" id="structredis_server_html_a9153369284c79d6fcf505c5882ec29ab"><div class="ttname"><a href="structredis_server.html#a9153369284c79d6fcf505c5882ec29ab">redisServer::stat_peak_memory</a></div><div class="ttdeci">size_t stat_peak_memory</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l01010">server.h:1010</a></div></div>
<div class="ttc" id="object_8c_html_a5f0ed362e09930575ce97431dda2f987"><div class="ttname"><a href="object_8c.html#a5f0ed362e09930575ce97431dda2f987">createHashObject</a></div><div class="ttdeci">robj * createHashObject(void)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00242">object.c:242</a></div></div>
<div class="ttc" id="structquicklist_node_html"><div class="ttname"><a href="structquicklist_node.html">quicklistNode</a></div><div class="ttdef"><b>Definition:</b> <a href="quicklist_8h_source.html#l00044">quicklist.h:44</a></div></div>
<div class="ttc" id="zmalloc_8c_html_a16542aef4062c19198acc9231406bd0f"><div class="ttname"><a href="zmalloc_8c.html#a16542aef4062c19198acc9231406bd0f">zmalloc_used_memory</a></div><div class="ttdeci">size_t zmalloc_used_memory(void)</div><div class="ttdef"><b>Definition:</b> <a href="zmalloc_8c_source.html#l00216">zmalloc.c:216</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_ab0dd532666871698a3e8dc420ec74b28"><div class="ttname"><a href="structredis_mem_overhead.html#ab0dd532666871698a3e8dc420ec74b28">redisMemOverhead::total_keys</a></div><div class="ttdeci">size_t total_keys</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00862">server.h:862</a></div></div>
<div class="ttc" id="util_8c_html_a6d96e71d47983f1e1e41448dd912e4e1"><div class="ttname"><a href="util_8c.html#a6d96e71d47983f1e1e41448dd912e4e1">string2l</a></div><div class="ttdeci">int string2l(const char *s, size_t slen, long *lval)</div><div class="ttdef"><b>Definition:</b> <a href="util_8c_source.html#l00412">util.c:412</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_ab748e7839b4db27ca41f802fb4deb3e1"><div class="ttname"><a href="structredis_mem_overhead.html#ab748e7839b4db27ca41f802fb4deb3e1">redisMemOverhead::peak_perc</a></div><div class="ttdeci">float peak_perc</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00865">server.h:865</a></div></div>
<div class="ttc" id="networking_8c_html_ac47c2cfd2a6d524fcbfefa9a18e3a9a3"><div class="ttname"><a href="networking_8c.html#ac47c2cfd2a6d524fcbfefa9a18e3a9a3">addReply</a></div><div class="ttdeci">void addReply(client *c, robj *obj)</div><div class="ttdef"><b>Definition:</b> <a href="networking_8c_source.html#l00297">networking.c:297</a></div></div>
<div class="ttc" id="structzskiplist_html"><div class="ttname"><a href="structzskiplist.html">zskiplist</a></div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00806">server.h:806</a></div></div>
<div class="ttc" id="structshared_objects_struct_html_adf30e1960aaa30991c8cc6f5d1b8f1f5"><div class="ttname"><a href="structshared_objects_struct.html#adf30e1960aaa30991c8cc6f5d1b8f1f5">sharedObjectsStruct::ok</a></div><div class="ttdeci">robj * ok</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00780">server.h:780</a></div></div>
<div class="ttc" id="sds_8c_html_a8633545cba735b390afad7bf8b5a9833"><div class="ttname"><a href="sds_8c.html#a8633545cba735b390afad7bf8b5a9833">sdsAllocSize</a></div><div class="ttdeci">size_t sdsAllocSize(sds s)</div><div class="ttdef"><b>Definition:</b> <a href="sds_8c_source.html#l00295">sds.c:295</a></div></div>
<div class="ttc" id="object_8c_html_a7317d00fbb81c4cfe09e68ee60979cfb"><div class="ttname"><a href="object_8c.html#a7317d00fbb81c4cfe09e68ee60979cfb">freeStringObject</a></div><div class="ttdeci">void freeStringObject(robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00281">object.c:281</a></div></div>
<div class="ttc" id="structredis_db_html"><div class="ttname"><a href="structredis_db.html">redisDb</a></div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00636">server.h:636</a></div></div>
<div class="ttc" id="object_8c_html_af4babb9f5d489b16aebeafedfa0ee244"><div class="ttname"><a href="object_8c.html#af4babb9f5d489b16aebeafedfa0ee244">objectCommand</a></div><div class="ttdeci">void objectCommand(client *c)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l01238">object.c:1238</a></div></div>
<div class="ttc" id="object_8c_html_ab8fb80d55a55fc2fdaad8763b94c2207"><div class="ttname"><a href="object_8c.html#ab8fb80d55a55fc2fdaad8763b94c2207">createIntsetObject</a></div><div class="ttdeci">robj * createIntsetObject(void)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00235">object.c:235</a></div></div>
<div class="ttc" id="server_8h_html_ac5bb76b546161fd0da4b0ff89b3142ee"><div class="ttname"><a href="server_8h.html#ac5bb76b546161fd0da4b0ff89b3142ee">OBJ_ENCODING_EMBSTR</a></div><div class="ttdeci">#define OBJ_ENCODING_EMBSTR</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00594">server.h:594</a></div></div>
<div class="ttc" id="adlist_8h_html_afde0ab079f934670e82119b43120e94b"><div class="ttname"><a href="adlist_8h.html#afde0ab079f934670e82119b43120e94b">listLength</a></div><div class="ttdeci">#define listLength(l)</div><div class="ttdef"><b>Definition:</b> <a href="adlist_8h_source.html#l00057">adlist.h:57</a></div></div>
<div class="ttc" id="rax_8c_html_afd5c0fce25aea0c4003bbb65b9108520"><div class="ttname"><a href="rax_8c.html#afd5c0fce25aea0c4003bbb65b9108520">raxStop</a></div><div class="ttdeci">void raxStop(raxIterator *it)</div><div class="ttdef"><b>Definition:</b> <a href="rax_8c_source.html#l01802">rax.c:1802</a></div></div>
<div class="ttc" id="adlist_8h_html_af84cae230e7180ebcda1e2736fce9f65"><div class="ttname"><a href="adlist_8h.html#af84cae230e7180ebcda1e2736fce9f65">listNodeValue</a></div><div class="ttdeci">#define listNodeValue(n)</div><div class="ttdef"><b>Definition:</b> <a href="adlist_8h_source.html#l00062">adlist.h:62</a></div></div>
<div class="ttc" id="structlist_node_html"><div class="ttname"><a href="structlist_node.html">listNode</a></div><div class="ttdef"><b>Definition:</b> <a href="adlist_8h_source.html#l00036">adlist.h:36</a></div></div>
<div class="ttc" id="object_8c_html_a58bf6fb802750d04c587b4d13a2f3c0a"><div class="ttname"><a href="object_8c.html#a58bf6fb802750d04c587b4d13a2f3c0a">createStringObject</a></div><div class="ttdeci">robj * createStringObject(const char *ptr, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00119">object.c:119</a></div></div>
<div class="ttc" id="structclient_html_a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9"><div class="ttname"><a href="structclient.html#a5c75dd3cb8eb8a3f5be7d4fdf48a9ef9">client::argv</a></div><div class="ttdeci">robj ** argv</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00722">server.h:722</a></div></div>
<div class="ttc" id="object_8c_html_ae39b213c26365e47c49958ca36400533"><div class="ttname"><a href="object_8c.html#ae39b213c26365e47c49958ca36400533">getLongFromObjectOrReply</a></div><div class="ttdeci">int getLongFromObjectOrReply(client *c, robj *o, long *target, const char *msg)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00711">object.c:711</a></div></div>
<div class="ttc" id="ziplist_8c_html_a2fc699da80e3b5dfe10057ecfbdb3fa1"><div class="ttname"><a href="ziplist_8c.html#a2fc699da80e3b5dfe10057ecfbdb3fa1">ziplistBlobLen</a></div><div class="ttdeci">size_t ziplistBlobLen(unsigned char *zl)</div><div class="ttdef"><b>Definition:</b> <a href="ziplist_8c_source.html#l01186">ziplist.c:1186</a></div></div>
<div class="ttc" id="networking_8c_html_ada74196bbcb069635697ca0d3183e183"><div class="ttname"><a href="networking_8c.html#ada74196bbcb069635697ca0d3183e183">getClientOutputBufferMemoryUsage</a></div><div class="ttdeci">unsigned long getClientOutputBufferMemoryUsage(client *c)</div><div class="ttdef"><b>Definition:</b> <a href="networking_8c_source.html#l02019">networking.c:2019</a></div></div>
<div class="ttc" id="structstream_c_g_html_a7773ab32d924c957c1db3ba8986cb963"><div class="ttname"><a href="structstream_c_g.html#a7773ab32d924c957c1db3ba8986cb963">streamCG::consumers</a></div><div class="ttdeci">rax * consumers</div><div class="ttdef"><b>Definition:</b> <a href="stream_8h_source.html#l00061">stream.h:61</a></div></div>
<div class="ttc" id="structredis_server_html_a4546e03b0256d4d50b71681b6cd45f52"><div class="ttname"><a href="structredis_server.html#a4546e03b0256d4d50b71681b6cd45f52">redisServer::aof_buf</a></div><div class="ttdeci">sds aof_buf</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l01064">server.h:1064</a></div></div>
<div class="ttc" id="server_8h_html_acfb35db5cb30ed113ed23aeb1a224c4c"><div class="ttname"><a href="server_8h.html#acfb35db5cb30ed113ed23aeb1a224c4c">OBJ_ENCODING_SKIPLIST</a></div><div class="ttdeci">#define OBJ_ENCODING_SKIPLIST</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00593">server.h:593</a></div></div>
<div class="ttc" id="object_8c_html_a4678c8cf824a0745311c39fb8f300290"><div class="ttname"><a href="object_8c.html#a4678c8cf824a0745311c39fb8f300290">freeModuleObject</a></div><div class="ttdeci">void freeModuleObject(robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00339">object.c:339</a></div></div>
<div class="ttc" id="structzset_html"><div class="ttname"><a href="structzset.html">zset</a></div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00812">server.h:812</a></div></div>
<div class="ttc" id="object_8c_html_a0fb3848777c9ddaac670a2ee174546dd"><div class="ttname"><a href="object_8c.html#a0fb3848777c9ddaac670a2ee174546dd">equalStringObjects</a></div><div class="ttdeci">int equalStringObjects(robj *a, robj *b)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00574">object.c:574</a></div></div>
<div class="ttc" id="object_8c_html_a3157a90055dab4dce92cc76500c3a51b"><div class="ttname"><a href="object_8c.html#a3157a90055dab4dce92cc76500c3a51b">inputCatSds</a></div><div class="ttdeci">void inputCatSds(void *result, const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l01072">object.c:1072</a></div></div>
<div class="ttc" id="dict_8h_html_a3271c334309904a3086deca94f96e46e"><div class="ttname"><a href="dict_8h.html#a3271c334309904a3086deca94f96e46e">dictGetKey</a></div><div class="ttdeci">#define dictGetKey(he)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8h_source.html#l00141">dict.h:141</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a0e982a0e14543ef6e17073a6d4afe191"><div class="ttname"><a href="structredis_mem_overhead.html#a0e982a0e14543ef6e17073a6d4afe191">redisMemOverhead::startup_allocated</a></div><div class="ttdeci">size_t startup_allocated</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00854">server.h:854</a></div></div>
<div class="ttc" id="object_8c_html_a6c17958992e396575864ce48574349c7"><div class="ttname"><a href="object_8c.html#a6c17958992e396575864ce48574349c7">isObjectRepresentableAsLongLong</a></div><div class="ttdeci">int isObjectRepresentableAsLongLong(robj *o, long long *llval)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00408">object.c:408</a></div></div>
<div class="ttc" id="structzset_html_aad961c2f260766ff3627bf363fef3551"><div class="ttname"><a href="structzset.html#aad961c2f260766ff3627bf363fef3551">zset::dict</a></div><div class="ttdeci">dict * dict</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00813">server.h:813</a></div></div>
<div class="ttc" id="dict_8h_html_a5fcb59103f176d193e100c23c998bae5"><div class="ttname"><a href="dict_8h.html#a5fcb59103f176d193e100c23c998bae5">dict</a></div><div class="ttdeci">struct dict dict</div></div>
<div class="ttc" id="structrax_html_aeb57ec87f1c4514577f9ed22bfc1041d"><div class="ttname"><a href="structrax.html#aeb57ec87f1c4514577f9ed22bfc1041d">rax::numele</a></div><div class="ttdeci">uint64_t numele</div><div class="ttdef"><b>Definition:</b> <a href="rax_8h_source.html#l00135">rax.h:135</a></div></div>
<div class="ttc" id="zmalloc_8h_html_a374c6d7cf6c9817e1243093e03df7319"><div class="ttname"><a href="zmalloc_8h.html#a374c6d7cf6c9817e1243093e03df7319">ZMALLOC_LIB</a></div><div class="ttdeci">#define ZMALLOC_LIB</div><div class="ttdef"><b>Definition:</b> <a href="zmalloc_8h_source.html#l00065">zmalloc.h:65</a></div></div>
<div class="ttc" id="sds_8h_html_ad69abac3df4532879db9642c95f5ef6f"><div class="ttname"><a href="sds_8h.html#ad69abac3df4532879db9642c95f5ef6f">sds</a></div><div class="ttdeci">char * sds</div><div class="ttdef"><b>Definition:</b> <a href="sds_8h_source.html#l00043">sds.h:43</a></div></div>
<div class="ttc" id="networking_8c_html_a1212877b63a97d8b0e209e441d998704"><div class="ttname"><a href="networking_8c.html#a1212877b63a97d8b0e209e441d998704">addReplyHelp</a></div><div class="ttdeci">void addReplyHelp(client *c, const char **help)</div><div class="ttdef"><b>Definition:</b> <a href="networking_8c_source.html#l00609">networking.c:609</a></div></div>
<div class="ttc" id="structredis_server_html_a7f900ab67c16f474082be15af9380a78"><div class="ttname"><a href="structredis_server.html#a7f900ab67c16f474082be15af9380a78">redisServer::maxmemory</a></div><div class="ttdeci">unsigned long long maxmemory</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l01184">server.h:1184</a></div></div>
<div class="ttc" id="adlist_8h_html_af109d357e4f8eabf6ebb533ca9e45ab9"><div class="ttname"><a href="adlist_8h.html#af109d357e4f8eabf6ebb533ca9e45ab9">listNode</a></div><div class="ttdeci">struct listNode listNode</div></div>
<div class="ttc" id="server_8c_html_a6d37ca075aa0bff83305ecd2823ef744"><div class="ttname"><a href="server_8c.html#a6d37ca075aa0bff83305ecd2823ef744">setDictType</a></div><div class="ttdeci">dictType setDictType</div><div class="ttdef"><b>Definition:</b> <a href="server_8c_source.html#l00592">server.c:592</a></div></div>
<div class="ttc" id="object_8c_html_a2dcf3148f7c5b6631b3d42c3f6d1e29c"><div class="ttname"><a href="object_8c.html#a2dcf3148f7c5b6631b3d42c3f6d1e29c">createQuicklistObject</a></div><div class="ttdeci">robj * createQuicklistObject(void)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00214">object.c:214</a></div></div>
<div class="ttc" id="util_8c_html_a57f59b3ee2509f5ed9cae449e0a4d81a"><div class="ttname"><a href="util_8c.html#a57f59b3ee2509f5ed9cae449e0a4d81a">ld2string</a></div><div class="ttdeci">int ld2string(char *buf, size_t len, long double value, int humanfriendly)</div><div class="ttdef"><b>Definition:</b> <a href="util_8c_source.html#l00503">util.c:503</a></div></div>
<div class="ttc" id="structmalloc__stats_html_a78e452f18e74cbf8be28858f49c0ff0b"><div class="ttname"><a href="structmalloc__stats.html#a78e452f18e74cbf8be28858f49c0ff0b">malloc_stats::allocator_active</a></div><div class="ttdeci">size_t allocator_active</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00906">server.h:906</a></div></div>
<div class="ttc" id="rax_8c_html_ac44bf6b27f6af45dd9b3b7308161322c"><div class="ttname"><a href="rax_8c.html#ac44bf6b27f6af45dd9b3b7308161322c">raxSize</a></div><div class="ttdeci">uint64_t raxSize(rax *rax)</div><div class="ttdef"><b>Definition:</b> <a href="rax_8c_source.html#l01816">rax.c:1816</a></div></div>
<div class="ttc" id="evict_8c_html_a88b01fac0bdcdbf799459a4046b18067"><div class="ttname"><a href="evict_8c.html#a88b01fac0bdcdbf799459a4046b18067">estimateObjectIdleTime</a></div><div class="ttdeci">unsigned long long estimateObjectIdleTime(robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="evict_8c_source.html#l00090">evict.c:90</a></div></div>
<div class="ttc" id="sds_8h_html_a504136356f04bfa2fd616dd4c8fdd71c"><div class="ttname"><a href="sds_8h.html#a504136356f04bfa2fd616dd4c8fdd71c">SDS_TYPE_8</a></div><div class="ttdeci">#define SDS_TYPE_8</div><div class="ttdef"><b>Definition:</b> <a href="sds_8h_source.html#l00077">sds.h:77</a></div></div>
<div class="ttc" id="object_8c_html_abb5873d69dbe9b2c5034c686d17d8c1d"><div class="ttname"><a href="object_8c.html#abb5873d69dbe9b2c5034c686d17d8c1d">createStringObjectFromLongLong</a></div><div class="ttdeci">robj * createStringObjectFromLongLong(long long value)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00161">object.c:161</a></div></div>
<div class="ttc" id="structmodule_value_html_a0f61d63b009d0880a89c843bd50d8d76"><div class="ttname"><a href="structmodule_value.html#a0f61d63b009d0880a89c843bd50d8d76">moduleValue::value</a></div><div class="ttdeci">void * value</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00540">server.h:540</a></div></div>
<div class="ttc" id="object_8c_html_ae793c69b79f7e18a50ec3ee4a9cb4d3a"><div class="ttname"><a href="object_8c.html#ae793c69b79f7e18a50ec3ee4a9cb4d3a">objectSetLRUOrLFU</a></div><div class="ttdeci">void objectSetLRUOrLFU(robj *val, long long lfu_freq, long long lru_idle, long long lru_clock)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l01197">object.c:1197</a></div></div>
<div class="ttc" id="object_8c_html_a2b5eada89b890fd9bf2859c9bc7185d6"><div class="ttname"><a href="object_8c.html#a2b5eada89b890fd9bf2859c9bc7185d6">dupStringObject</a></div><div class="ttdeci">robj * dupStringObject(const robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00193">object.c:193</a></div></div>
<div class="ttc" id="server_8h_html_a540f174d2685422fbd7d12e3cd44c8e2"><div class="ttname"><a href="server_8h.html#a540f174d2685422fbd7d12e3cd44c8e2">robj</a></div><div class="ttdeci">struct redisObject robj</div></div>
<div class="ttc" id="redis-benchmark_8c_html_a6bf8c3f34a9af09c5f641d813a37d0a7"><div class="ttname"><a href="redis-benchmark_8c.html#a6bf8c3f34a9af09c5f641d813a37d0a7">client</a></div><div class="ttdeci">struct _client * client</div></div>
<div class="ttc" id="sds_8c_html_a784d6789da0c845fdecf1c4caf49f9f7"><div class="ttname"><a href="sds_8c.html#a784d6789da0c845fdecf1c4caf49f9f7">SDS_NOINIT</a></div><div class="ttdeci">const char * SDS_NOINIT</div><div class="ttdef"><b>Definition:</b> <a href="sds_8c_source.html#l00042">sds.c:42</a></div></div>
<div class="ttc" id="object_8c_html_af22e46f03c49934062838d3208bd3fa1"><div class="ttname"><a href="object_8c.html#af22e46f03c49934062838d3208bd3fa1">resetRefCount</a></div><div class="ttdeci">robj * resetRefCount(robj *obj)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00391">object.c:391</a></div></div>
<div class="ttc" id="zmalloc_8c_html_a027ae46ed3662b0911304294f218d0b9"><div class="ttname"><a href="zmalloc_8c.html#a027ae46ed3662b0911304294f218d0b9">zcalloc</a></div><div class="ttdeci">void * zcalloc(size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="zmalloc_8c_source.html#l00130">zmalloc.c:130</a></div></div>
<div class="ttc" id="dict_8h_html_aca9596be4bcc2caa07c17dd8cebcceec"><div class="ttname"><a href="dict_8h.html#aca9596be4bcc2caa07c17dd8cebcceec">dictSlots</a></div><div class="ttdeci">#define dictSlots(d)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8h_source.html#l00146">dict.h:146</a></div></div>
<div class="ttc" id="structquicklist_html_a9768476640799c4dc25850d7dfb5f436"><div class="ttname"><a href="structquicklist.html#a9768476640799c4dc25850d7dfb5f436">quicklist::head</a></div><div class="ttdeci">quicklistNode * head</div><div class="ttdef"><b>Definition:</b> <a href="quicklist_8h_source.html#l00074">quicklist.h:74</a></div></div>
<div class="ttc" id="object_8c_html_a4163ff8fa0cd1864c6ea78bcffa54589"><div class="ttname"><a href="object_8c.html#a4163ff8fa0cd1864c6ea78bcffa54589">createZsetZiplistObject</a></div><div class="ttdeci">robj * createZsetZiplistObject(void)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00260">object.c:260</a></div></div>
<div class="ttc" id="redis-check-rdb_8c_html_adc0ee0ed345db513fb6fac27511be4f1"><div class="ttname"><a href="redis-check-rdb_8c.html#adc0ee0ed345db513fb6fac27511be4f1">key</a></div><div class="ttdeci">robj * key</div><div class="ttdef"><b>Definition:</b> <a href="redis-check-rdb_8c_source.html#l00041">redis-check-rdb.c:41</a></div></div>
<div class="ttc" id="object_8c_html_a828cbcce5d59a527c9a3d7c19bde3f3f"><div class="ttname"><a href="object_8c.html#a828cbcce5d59a527c9a3d7c19bde3f3f">createStringObjectFromLongDouble</a></div><div class="ttdeci">robj * createStringObjectFromLongDouble(long double value, int humanfriendly)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00179">object.c:179</a></div></div>
<div class="ttc" id="server_8h_html_af98ac28d5f4d23d7ed5985188e6fb7d1"><div class="ttname"><a href="server_8h.html#af98ac28d5f4d23d7ed5985188e6fb7d1">C_ERR</a></div><div class="ttdeci">#define C_ERR</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00078">server.h:78</a></div></div>
<div class="ttc" id="object_8c_html_a45ffbf979c99e0a0985141ae4d9316a2"><div class="ttname"><a href="object_8c.html#a45ffbf979c99e0a0985141ae4d9316a2">getDoubleFromObject</a></div><div class="ttdeci">int getDoubleFromObject(const robj *o, double *target)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00594">object.c:594</a></div></div>
<div class="ttc" id="object_8c_html_ac18b9b0bcb75a95609aea70a882863d2"><div class="ttname"><a href="object_8c.html#ac18b9b0bcb75a95609aea70a882863d2">createZsetObject</a></div><div class="ttdeci">robj * createZsetObject(void)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00249">object.c:249</a></div></div>
<div class="ttc" id="server_8h_html_a92c1fed85f709180fda0ff10d37d649b"><div class="ttname"><a href="server_8h.html#a92c1fed85f709180fda0ff10d37d649b">OBJ_MODULE</a></div><div class="ttdeci">#define OBJ_MODULE</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00483">server.h:483</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a8379ee7de31460d30fac72e27c81fd7a"><div class="ttname"><a href="structredis_mem_overhead.html#a8379ee7de31460d30fac72e27c81fd7a">redisMemOverhead::dbid</a></div><div class="ttdeci">size_t dbid</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00876">server.h:876</a></div></div>
<div class="ttc" id="networking_8c_html_aa9a8085743464110cd10338fa89d22cd"><div class="ttname"><a href="networking_8c.html#aa9a8085743464110cd10338fa89d22cd">addReplyBulkSds</a></div><div class="ttdeci">void addReplyBulkSds(client *c, sds s)</div><div class="ttdef"><b>Definition:</b> <a href="networking_8c_source.html#l00581">networking.c:581</a></div></div>
<div class="ttc" id="util_8c_html_a0ec291923d3b4034b8200ac45b97d1b6"><div class="ttname"><a href="util_8c.html#a0ec291923d3b4034b8200ac45b97d1b6">ll2string</a></div><div class="ttdeci">int ll2string(char *dst, size_t dstlen, long long svalue)</div><div class="ttdef"><b>Definition:</b> <a href="util_8c_source.html#l00277">util.c:277</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_aede1fc4f53c4e19111df241fe70fb77c"><div class="ttname"><a href="structredis_mem_overhead.html#aede1fc4f53c4e19111df241fe70fb77c">redisMemOverhead::lua_caches</a></div><div class="ttdeci">size_t lua_caches</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00859">server.h:859</a></div></div>
<div class="ttc" id="structdict_html"><div class="ttname"><a href="structdict.html">dict</a></div><div class="ttdef"><b>Definition:</b> <a href="dict_8h_source.html#l00076">dict.h:76</a></div></div>
<div class="ttc" id="server_8c_html_a8d73c25eebeb3e3656b34e7807cb15b4"><div class="ttname"><a href="server_8c.html#a8d73c25eebeb3e3656b34e7807cb15b4">server</a></div><div class="ttdeci">struct redisServer server</div><div class="ttdef"><b>Definition:</b> <a href="server_8c_source.html#l00072">server.c:72</a></div></div>
<div class="ttc" id="server_8h_html_a7724350e4f0ddbf1c80740699fac78be"><div class="ttname"><a href="server_8h.html#a7724350e4f0ddbf1c80740699fac78be">CLIENT_MONITOR</a></div><div class="ttdeci">#define CLIENT_MONITOR</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00230">server.h:230</a></div></div>
<div class="ttc" id="structclient_html_a9bee04e09635a42fef289e42a89f5502"><div class="ttname"><a href="structclient.html#a9bee04e09635a42fef289e42a89f5502">client::db</a></div><div class="ttdeci">redisDb * db</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00712">server.h:712</a></div></div>
<div class="ttc" id="server_8h_html_ad139d741d814f1bf2927845ea6509e04"><div class="ttname"><a href="server_8h.html#ad139d741d814f1bf2927845ea6509e04">zslCreate</a></div><div class="ttdeci">zskiplist * zslCreate(void)</div><div class="ttdef"><b>Definition:</b> <a href="t__zset_8c_source.html#l00080">t_zset.c:80</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a26a9170a61aa6eb593f9e57a2396a706"><div class="ttname"><a href="structredis_mem_overhead.html#a26a9170a61aa6eb593f9e57a2396a706">redisMemOverhead::overhead_ht_expires</a></div><div class="ttdeci">size_t overhead_ht_expires</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00878">server.h:878</a></div></div>
<div class="ttc" id="structstream_html_a16c7dae1e1c61411ffe37afabe67de80"><div class="ttname"><a href="structstream.html#a16c7dae1e1c61411ffe37afabe67de80">stream::cgroups</a></div><div class="ttdeci">rax * cgroups</div><div class="ttdef"><b>Definition:</b> <a href="stream_8h_source.html#l00020">stream.h:20</a></div></div>
<div class="ttc" id="server_8h_html_a303769ef1065076e68731584e758d3e1"><div class="ttname"><a href="server_8h.html#a303769ef1065076e68731584e758d3e1">C_OK</a></div><div class="ttdeci">#define C_OK</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00077">server.h:77</a></div></div>
<div class="ttc" id="object_8c_html_ab1682abd71cd968dc006d34d20550e9f"><div class="ttname"><a href="object_8c.html#ab1682abd71cd968dc006d34d20550e9f">getLongDoubleFromObject</a></div><div class="ttdeci">int getLongDoubleFromObject(robj *o, long double *target)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00636">object.c:636</a></div></div>
<div class="ttc" id="structstream_c_g_html_a2fc8aed22096d11568cb29885cf08cb2"><div class="ttname"><a href="structstream_c_g.html#a2fc8aed22096d11568cb29885cf08cb2">streamCG::pel</a></div><div class="ttdeci">rax * pel</div><div class="ttdef"><b>Definition:</b> <a href="stream_8h_source.html#l00055">stream.h:55</a></div></div>
<div class="ttc" id="structredis_object_html_add9af9569af79ec26dd741fb226b38ba"><div class="ttname"><a href="structredis_object.html#add9af9569af79ec26dd741fb226b38ba">redisObject::ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00610">server.h:610</a></div></div>
<div class="ttc" id="adlist_8c_html_a722ffca86d8746e6c68a146359683dfa"><div class="ttname"><a href="adlist_8c.html#a722ffca86d8746e6c68a146359683dfa">listNext</a></div><div class="ttdeci">listNode * listNext(listIter *iter)</div><div class="ttdef"><b>Definition:</b> <a href="adlist_8c_source.html#l00229">adlist.c:229</a></div></div>
<div class="ttc" id="networking_8c_html_a22f3761ad780e2f1a0d7bcd213f34eb1"><div class="ttname"><a href="networking_8c.html#a22f3761ad780e2f1a0d7bcd213f34eb1">addReplyDouble</a></div><div class="ttdeci">void addReplyDouble(client *c, double d)</div><div class="ttdef"><b>Definition:</b> <a href="networking_8c_source.html#l00477">networking.c:477</a></div></div>
<div class="ttc" id="networking_8c_html_a77d66bf68cf67c87521b97d59bd2fb84"><div class="ttname"><a href="networking_8c.html#a77d66bf68cf67c87521b97d59bd2fb84">addReplyLongLong</a></div><div class="ttdeci">void addReplyLongLong(client *c, long long ll)</div><div class="ttdef"><b>Definition:</b> <a href="networking_8c_source.html#l00524">networking.c:524</a></div></div>
<div class="ttc" id="object_8c_html_aa471c38fc2e9e96a23693e7ff5e73209"><div class="ttname"><a href="object_8c.html#aa471c38fc2e9e96a23693e7ff5e73209">REDIS_COMPARE_COLL</a></div><div class="ttdeci">#define REDIS_COMPARE_COLL</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00526">object.c:526</a></div></div>
<div class="ttc" id="object_8c_html_a27f308f6b75cf83cde04d51399a6e014"><div class="ttname"><a href="object_8c.html#a27f308f6b75cf83cde04d51399a6e014">collateStringObjects</a></div><div class="ttdeci">int collateStringObjects(robj *a, robj *b)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00566">object.c:566</a></div></div>
<div class="ttc" id="server_8h_html_a311fc8b18b93af94e1ad418f1386b519"><div class="ttname"><a href="server_8h.html#a311fc8b18b93af94e1ad418f1386b519">OBJ_SHARED_INTEGERS</a></div><div class="ttdeci">#define OBJ_SHARED_INTEGERS</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00094">server.h:94</a></div></div>
<div class="ttc" id="server_8h_html_a15f4654e0f62585fa6ea50ede84598d5"><div class="ttname"><a href="server_8h.html#a15f4654e0f62585fa6ea50ede84598d5">MAXMEMORY_FLAG_NO_SHARED_INTEGERS</a></div><div class="ttdeci">#define MAXMEMORY_FLAG_NO_SHARED_INTEGERS</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00385">server.h:385</a></div></div>
<div class="ttc" id="object_8c_html_a9137654b1169778bf6c8b8439667e44e"><div class="ttname"><a href="object_8c.html#a9137654b1169778bf6c8b8439667e44e">objectCommandLookup</a></div><div class="ttdeci">robj * objectCommandLookup(client *c, robj *key)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l01222">object.c:1222</a></div></div>
<div class="ttc" id="structshared_objects_struct_html_a72d93f8c752cbe76e225113137ac21ec"><div class="ttname"><a href="structshared_objects_struct.html#a72d93f8c752cbe76e225113137ac21ec">sharedObjectsStruct::wrongtypeerr</a></div><div class="ttdeci">robj * wrongtypeerr</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00780">server.h:780</a></div></div>
<div class="ttc" id="object_8c_html_a42d455241ac5e34b9db676b6e7a23cef"><div class="ttname"><a href="object_8c.html#a42d455241ac5e34b9db676b6e7a23cef">getDecodedObject</a></div><div class="ttdeci">robj * getDecodedObject(robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00499">object.c:499</a></div></div>
<div class="ttc" id="object_8c_html_a1b107d21fcb90b8c57203904e96c02f3"><div class="ttname"><a href="object_8c.html#a1b107d21fcb90b8c57203904e96c02f3">compareStringObjects</a></div><div class="ttdeci">int compareStringObjects(robj *a, robj *b)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00561">object.c:561</a></div></div>
<div class="ttc" id="adlist_8h_html_aa8dc514bbe217bb2e87c1c77cfa84690"><div class="ttname"><a href="adlist_8h.html#aa8dc514bbe217bb2e87c1c77cfa84690">listFirst</a></div><div class="ttdeci">#define listFirst(l)</div><div class="ttdef"><b>Definition:</b> <a href="adlist_8h_source.html#l00058">adlist.h:58</a></div></div>
<div class="ttc" id="object_8c_html_a85905658f263d18a5d422d275e5c18ac"><div class="ttname"><a href="object_8c.html#a85905658f263d18a5d422d275e5c18ac">createRawStringObject</a></div><div class="ttdeci">robj * createRawStringObject(const char *ptr, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00077">object.c:77</a></div></div>
<div class="ttc" id="quicklist_8h_html_af7ba3e3c181ca13bfc890a7de367ee84"><div class="ttname"><a href="quicklist_8h.html#af7ba3e3c181ca13bfc890a7de367ee84">quicklist</a></div><div class="ttdeci">struct quicklist quicklist</div></div>
<div class="ttc" id="structquicklist_node_html_aa4be5244c2097b8fc8bdf053a0793ac8"><div class="ttname"><a href="structquicklist_node.html#aa4be5244c2097b8fc8bdf053a0793ac8">quicklistNode::next</a></div><div class="ttdeci">struct quicklistNode * next</div><div class="ttdef"><b>Definition:</b> <a href="quicklist_8h_source.html#l00046">quicklist.h:46</a></div></div>
<div class="ttc" id="structredis_server_html_acabb38054cd6d1d619d7c19d3e57bf28"><div class="ttname"><a href="structredis_server.html#acabb38054cd6d1d619d7c19d3e57bf28">redisServer::repl_backlog</a></div><div class="ttdeci">char * repl_backlog</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l01129">server.h:1129</a></div></div>
<div class="ttc" id="rax_8h_html_a4430f1fc12afa59bcca60a2cb39b6ab2"><div class="ttname"><a href="rax_8h.html#a4430f1fc12afa59bcca60a2cb39b6ab2">raxNode</a></div><div class="ttdeci">struct raxNode raxNode</div></div>
<div class="ttc" id="object_8c_html_a6ba807c719b2ce522847bd794a789c85"><div class="ttname"><a href="object_8c.html#a6ba807c719b2ce522847bd794a789c85">createStreamObject</a></div><div class="ttdeci">robj * createStreamObject(void)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00267">object.c:267</a></div></div>
<div class="ttc" id="structredis_server_html_a412e66c4f2ef9fdb6601bcc2e09b5da9"><div class="ttname"><a href="structredis_server.html#a412e66c4f2ef9fdb6601bcc2e09b5da9">redisServer::lua_scripts_mem</a></div><div class="ttdeci">unsigned long long lua_scripts_mem</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l01246">server.h:1246</a></div></div>
<div class="ttc" id="object_8c_html_a8c2fcb5a9e55b784002397ecee2619d7"><div class="ttname"><a href="object_8c.html#a8c2fcb5a9e55b784002397ecee2619d7">checkType</a></div><div class="ttdeci">int checkType(client *c, robj *o, int type)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00396">object.c:396</a></div></div>
<div class="ttc" id="server_8h_html_aabf064ede983103f1fd0df2086e84eee"><div class="ttname"><a href="server_8h.html#aabf064ede983103f1fd0df2086e84eee">OBJ_ENCODING_ZIPLIST</a></div><div class="ttdeci">#define OBJ_ENCODING_ZIPLIST</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00591">server.h:591</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a92e2261ab8290fdc2955b81e5901203d"><div class="ttname"><a href="structredis_mem_overhead.html#a92e2261ab8290fdc2955b81e5901203d">redisMemOverhead::db</a></div><div class="ttdeci">struct redisMemOverhead::@12 * db</div></div>
<div class="ttc" id="structintset_html_abf20f154dd41a6f1b64b0cbfbfb05052"><div class="ttname"><a href="structintset.html#abf20f154dd41a6f1b64b0cbfbfb05052">intset::encoding</a></div><div class="ttdeci">uint32_t encoding</div><div class="ttdef"><b>Definition:</b> <a href="intset_8h_source.html#l00036">intset.h:36</a></div></div>
<div class="ttc" id="sds_8c_html_a4d9266a6b2d5a98f0df0ac62f51324fd"><div class="ttname"><a href="sds_8c.html#a4d9266a6b2d5a98f0df0ac62f51324fd">sdsfree</a></div><div class="ttdeci">void sdsfree(sds s)</div><div class="ttdef"><b>Definition:</b> <a href="sds_8c_source.html#l00165">sds.c:165</a></div></div>
<div class="ttc" id="listpack_8c_html_a087b2b4c2fcb972fb8c4b9466828d2e6"><div class="ttname"><a href="listpack_8c.html#a087b2b4c2fcb972fb8c4b9466828d2e6">lpBytes</a></div><div class="ttdeci">uint32_t lpBytes(unsigned char *lp)</div><div class="ttdef"><b>Definition:</b> <a href="listpack_8c_source.html#l00751">listpack.c:751</a></div></div>
<div class="ttc" id="object_8c_html_a1404413f92cc603c272880c75415321b"><div class="ttname"><a href="object_8c.html#a1404413f92cc603c272880c75415321b">isSdsRepresentableAsLongLong</a></div><div class="ttdeci">int isSdsRepresentableAsLongLong(sds s, long long *llval)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00404">object.c:404</a></div></div>
<div class="ttc" id="object_8c_html_a7a7968bc470b0da48ead4e8191c454d8"><div class="ttname"><a href="object_8c.html#a7a7968bc470b0da48ead4e8191c454d8">getDoubleFromObjectOrReply</a></div><div class="ttdeci">int getDoubleFromObjectOrReply(client *c, robj *o, double *target, const char *msg)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00622">object.c:622</a></div></div>
<div class="ttc" id="structclient_html_ac8bf36fe0577cba66bccda3a6f7e80a4"><div class="ttname"><a href="structclient.html#ac8bf36fe0577cba66bccda3a6f7e80a4">client::flags</a></div><div class="ttdeci">int flags</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00734">server.h:734</a></div></div>
<div class="ttc" id="object_8c_html_a9d03597c960b9cbed2bd71bd2d6fd5f1"><div class="ttname"><a href="object_8c.html#a9d03597c960b9cbed2bd71bd2d6fd5f1">freeSetObject</a></div><div class="ttdeci">void freeSetObject(robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00295">object.c:295</a></div></div>
<div class="ttc" id="object_8c_html_ab09baeae3f0b14d5e0f36b7a8af2bdcf"><div class="ttname"><a href="object_8c.html#ab09baeae3f0b14d5e0f36b7a8af2bdcf">freeMemoryOverheadData</a></div><div class="ttdeci">void freeMemoryOverheadData(struct redisMemOverhead *mh)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00935">object.c:935</a></div></div>
<div class="ttc" id="structrax_html"><div class="ttname"><a href="structrax.html">rax</a></div><div class="ttdef"><b>Definition:</b> <a href="rax_8h_source.html#l00133">rax.h:133</a></div></div>
<div class="ttc" id="structstream_html_a5e94d4d7ba0112aeda6ee7b1ec15cf54"><div class="ttname"><a href="structstream.html#a5e94d4d7ba0112aeda6ee7b1ec15cf54">stream::rax</a></div><div class="ttdeci">rax * rax</div><div class="ttdef"><b>Definition:</b> <a href="stream_8h_source.html#l00017">stream.h:17</a></div></div>
<div class="ttc" id="structclient_html"><div class="ttname"><a href="structclient.html">client</a></div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00709">server.h:709</a></div></div>
<div class="ttc" id="structredis_object_html_abe5aec51795e89d8bdaf84d58d8eb00a"><div class="ttname"><a href="structredis_object.html#abe5aec51795e89d8bdaf84d58d8eb00a">redisObject::lru</a></div><div class="ttdeci">unsigned lru</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00606">server.h:606</a></div></div>
<div class="ttc" id="server_8h_html_a8cec44bf7da67aac58839ab5033bdc0a"><div class="ttname"><a href="server_8h.html#a8cec44bf7da67aac58839ab5033bdc0a">LFU_INIT_VAL</a></div><div class="ttdeci">#define LFU_INIT_VAL</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l01912">server.h:1912</a></div></div>
<div class="ttc" id="structintset_html_aebb70c2aab3407a9f05334c47131a43b"><div class="ttname"><a href="structintset.html#aebb70c2aab3407a9f05334c47131a43b">intset::length</a></div><div class="ttdeci">uint32_t length</div><div class="ttdef"><b>Definition:</b> <a href="intset_8h_source.html#l00037">intset.h:37</a></div></div>
<div class="ttc" id="zmalloc_8c_html_ae6638523882220721b9e7cdc7b2cd58d"><div class="ttname"><a href="zmalloc_8c.html#ae6638523882220721b9e7cdc7b2cd58d">zfree</a></div><div class="ttdeci">void zfree(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="zmalloc_8c_source.html#l00190">zmalloc.c:190</a></div></div>
<div class="ttc" id="object_8c_html_a794a7928c34cfe1ae50146fe13e9179a"><div class="ttname"><a href="object_8c.html#a794a7928c34cfe1ae50146fe13e9179a">createModuleObject</a></div><div class="ttdeci">robj * createModuleObject(moduleType *mt, void *value)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00274">object.c:274</a></div></div>
<div class="ttc" id="sds_8c_html_a8924a4a105d0f6dc359685357ceaef57"><div class="ttname"><a href="sds_8c.html#a8924a4a105d0f6dc359685357ceaef57">sdsnew</a></div><div class="ttdeci">sds sdsnew(const char *init)</div><div class="ttdef"><b>Definition:</b> <a href="sds_8c_source.html#l00154">sds.c:154</a></div></div>
<div class="ttc" id="networking_8c_html_abe873add36c720d962820c00176f7490"><div class="ttname"><a href="networking_8c.html#abe873add36c720d962820c00176f7490">addReplyMultiBulkLen</a></div><div class="ttdeci">void addReplyMultiBulkLen(client *c, long length)</div><div class="ttdef"><b>Definition:</b> <a href="networking_8c_source.html#l00533">networking.c:533</a></div></div>
<div class="ttc" id="object_8c_html_a1032572b4b3b6e9425744bb86d98ec15"><div class="ttname"><a href="object_8c.html#a1032572b4b3b6e9425744bb86d98ec15">getMemoryOverheadData</a></div><div class="ttdeci">struct redisMemOverhead * getMemoryOverheadData(void)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00943">object.c:943</a></div></div>
<div class="ttc" id="structintset_html"><div class="ttname"><a href="structintset.html">intset</a></div><div class="ttdef"><b>Definition:</b> <a href="intset_8h_source.html#l00035">intset.h:35</a></div></div>
<div class="ttc" id="server_8h_html"><div class="ttname"><a href="server_8h.html">server.h</a></div></div>
<div class="ttc" id="server_8h_html_a214173987de21c3b7661fddd42b05873"><div class="ttname"><a href="server_8h.html#a214173987de21c3b7661fddd42b05873">OBJ_ENCODING_INTSET</a></div><div class="ttdeci">#define OBJ_ENCODING_INTSET</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00592">server.h:592</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_af21382aaf8f931d992586bbfe5f8aca2"><div class="ttname"><a href="structredis_mem_overhead.html#af21382aaf8f931d992586bbfe5f8aca2">redisMemOverhead::clients_normal</a></div><div class="ttdeci">size_t clients_normal</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00857">server.h:857</a></div></div>
<div class="ttc" id="server_8h_html_aac2d3ad7a604f87e06e25233dbd01c9b"><div class="ttname"><a href="server_8h.html#aac2d3ad7a604f87e06e25233dbd01c9b">MAXMEMORY_FLAG_LFU</a></div><div class="ttdeci">#define MAXMEMORY_FLAG_LFU</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00383">server.h:383</a></div></div>
<div class="ttc" id="stream_8h_html_a7feb7e95b8c6a01a8359be263f921eb9"><div class="ttname"><a href="stream_8h.html#a7feb7e95b8c6a01a8359be263f921eb9">streamNew</a></div><div class="ttdeci">stream * streamNew(void)</div><div class="ttdef"><b>Definition:</b> <a href="t__stream_8c_source.html#l00052">t_stream.c:52</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a7dcfd2bdf329730a992f30f52b145dbb"><div class="ttname"><a href="structredis_mem_overhead.html#a7dcfd2bdf329730a992f30f52b145dbb">redisMemOverhead::allocator_frag_bytes</a></div><div class="ttdeci">size_t allocator_frag_bytes</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00869">server.h:869</a></div></div>
<div class="ttc" id="server_8h_html_a9c10219f68afc557d510d108257d238b"><div class="ttname"><a href="server_8h.html#a9c10219f68afc557d510d108257d238b">OBJ_ENCODING_HT</a></div><div class="ttdeci">#define OBJ_ENCODING_HT</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00588">server.h:588</a></div></div>
<div class="ttc" id="server_8h_html_aa1a892baaa2587c7787c2e9bcf34abfd"><div class="ttname"><a href="server_8h.html#aa1a892baaa2587c7787c2e9bcf34abfd">zslFree</a></div><div class="ttdeci">void zslFree(zskiplist *zsl)</div><div class="ttdef"><b>Definition:</b> <a href="t__zset_8c_source.html#l00106">t_zset.c:106</a></div></div>
<div class="ttc" id="structmalloc__stats_html_a35a8adbf64bc20a4ab20cf3872ea5e54"><div class="ttname"><a href="structmalloc__stats.html#a35a8adbf64bc20a4ab20cf3872ea5e54">malloc_stats::allocator_allocated</a></div><div class="ttdeci">size_t allocator_allocated</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00905">server.h:905</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a5fff22cf574851b502f713e7db2980fe"><div class="ttname"><a href="structredis_mem_overhead.html#a5fff22cf574851b502f713e7db2980fe">redisMemOverhead::num_dbs</a></div><div class="ttdeci">size_t num_dbs</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00874">server.h:874</a></div></div>
<div class="ttc" id="sds_8c_html_af0bb695d269439f719caca4129989090"><div class="ttname"><a href="sds_8c.html#af0bb695d269439f719caca4129989090">sdsempty</a></div><div class="ttdeci">sds sdsempty(void)</div><div class="ttdef"><b>Definition:</b> <a href="sds_8c_source.html#l00149">sds.c:149</a></div></div>
<div class="ttc" id="object_8c_html_a46d9ae99d237582e21c70e7de56a032e"><div class="ttname"><a href="object_8c.html#a46d9ae99d237582e21c70e7de56a032e">OBJ_COMPUTE_SIZE_DEF_SAMPLES</a></div><div class="ttdeci">#define OBJ_COMPUTE_SIZE_DEF_SAMPLES</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00771">object.c:771</a></div></div>
<div class="ttc" id="object_8c_html_a5f534218574d15e8333875d10d7e7316"><div class="ttname"><a href="object_8c.html#a5f534218574d15e8333875d10d7e7316">createObject</a></div><div class="ttdeci">robj * createObject(int type, void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00041">object.c:41</a></div></div>
<div class="ttc" id="object_8c_html_a4a1211c9a32ce830f9f6682bc310357c"><div class="ttname"><a href="object_8c.html#a4a1211c9a32ce830f9f6682bc310357c">createZiplistObject</a></div><div class="ttdeci">robj * createZiplistObject(void)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00221">object.c:221</a></div></div>
<div class="ttc" id="structmodule_value_html_a05eee39e39e34439ea77af35b597b1ae"><div class="ttname"><a href="structmodule_value.html#a05eee39e39e34439ea77af35b597b1ae">moduleValue::type</a></div><div class="ttdeci">moduleType * type</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00539">server.h:539</a></div></div>
<div class="ttc" id="structstream_consumer_html"><div class="ttname"><a href="structstream_consumer.html">streamConsumer</a></div><div class="ttdef"><b>Definition:</b> <a href="stream_8h_source.html#l00067">stream.h:67</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a1a15c326f9a9953cd14a0ba78aaea439"><div class="ttname"><a href="structredis_mem_overhead.html#a1a15c326f9a9953cd14a0ba78aaea439">redisMemOverhead::overhead_ht_main</a></div><div class="ttdeci">size_t overhead_ht_main</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00877">server.h:877</a></div></div>
<div class="ttc" id="rax_8c_html_abafdb51bd58d96e97618cfefc83f3737"><div class="ttname"><a href="rax_8c.html#abafdb51bd58d96e97618cfefc83f3737">raxNext</a></div><div class="ttdeci">int raxNext(raxIterator *it)</div><div class="ttdef"><b>Definition:</b> <a href="rax_8c_source.html#l01693">rax.c:1693</a></div></div>
<div class="ttc" id="rax_8c_html_a89bfe37114c7be78b37f5f669c7e690e"><div class="ttname"><a href="rax_8c.html#a89bfe37114c7be78b37f5f669c7e690e">raxStart</a></div><div class="ttdeci">void raxStart(raxIterator *it, rax *rt)</div><div class="ttdef"><b>Definition:</b> <a href="rax_8c_source.html#l01256">rax.c:1256</a></div></div>
<div class="ttc" id="zmalloc_8c_html_ac24423a93cab2fbf18e28cc2f42f7f97"><div class="ttname"><a href="zmalloc_8c.html#ac24423a93cab2fbf18e28cc2f42f7f97">zrealloc</a></div><div class="ttdeci">void * zrealloc(void *ptr, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="zmalloc_8c_source.html#l00144">zmalloc.c:144</a></div></div>
<div class="ttc" id="zmalloc_8c_html_a879ee0956348fd24dc2ac69c2d4f220b"><div class="ttname"><a href="zmalloc_8c.html#a879ee0956348fd24dc2ac69c2d4f220b">zmalloc</a></div><div class="ttdeci">void * zmalloc(size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="zmalloc_8c_source.html#l00098">zmalloc.c:98</a></div></div>
<div class="ttc" id="structlist_iter_html"><div class="ttname"><a href="structlist_iter.html">listIter</a></div><div class="ttdef"><b>Definition:</b> <a href="adlist_8h_source.html#l00042">adlist.h:42</a></div></div>
<div class="ttc" id="structredis_server_html_a1e552149c10f70ef055718ed88837bc3"><div class="ttname"><a href="structredis_server.html#a1e552149c10f70ef055718ed88837bc3">redisServer::initial_memory_usage</a></div><div class="ttdeci">size_t initial_memory_usage</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00951">server.h:951</a></div></div>
<div class="ttc" id="rax_8c_html_a4ad909fa19602d916b8781ad11444803"><div class="ttname"><a href="rax_8c.html#a4ad909fa19602d916b8781ad11444803">raxSeek</a></div><div class="ttdeci">int raxSeek(raxIterator *it, const char *op, unsigned char *ele, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="rax_8c_source.html#l01508">rax.c:1508</a></div></div>
<div class="ttc" id="object_8c_html_aa14f89ea2cc52c4e3d9ba91d85478a1c"><div class="ttname"><a href="object_8c.html#aa14f89ea2cc52c4e3d9ba91d85478a1c">makeObjectShared</a></div><div class="ttdeci">robj * makeObjectShared(robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00069">object.c:69</a></div></div>
<div class="ttc" id="structclient_html_accf8e4a2bc6b80403d3f0f024eaa8a1b"><div class="ttname"><a href="structclient.html#accf8e4a2bc6b80403d3f0f024eaa8a1b">client::querybuf</a></div><div class="ttdeci">sds querybuf</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00714">server.h:714</a></div></div>
<div class="ttc" id="structquicklist_node_html_a1ae48f85ded0fe46acd8864ac807f6b8"><div class="ttname"><a href="structquicklist_node.html#a1ae48f85ded0fe46acd8864ac807f6b8">quicklistNode::zl</a></div><div class="ttdeci">unsigned char * zl</div><div class="ttdef"><b>Definition:</b> <a href="quicklist_8h_source.html#l00047">quicklist.h:47</a></div></div>
<div class="ttc" id="server_8h_html_a7308f76cbff9a8d3797fe78190b91282"><div class="ttname"><a href="server_8h.html#a7308f76cbff9a8d3797fe78190b91282">serverAssertWithInfo</a></div><div class="ttdeci">#define serverAssertWithInfo(_c, _o, _e)</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00455">server.h:455</a></div></div>
<div class="ttc" id="object_8c_html_afc552e6090cf7fa56b3db458078be7f1"><div class="ttname"><a href="object_8c.html#afc552e6090cf7fa56b3db458078be7f1">createEmbeddedStringObject</a></div><div class="ttdeci">robj * createEmbeddedStringObject(const char *ptr, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00084">object.c:84</a></div></div>
<div class="ttc" id="networking_8c_html_acebfaa11c5c3aa617fcc3679a58e6f17"><div class="ttname"><a href="networking_8c.html#acebfaa11c5c3aa617fcc3679a58e6f17">addReplyBulkCString</a></div><div class="ttdeci">void addReplyBulkCString(client *c, const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="networking_8c_source.html#l00588">networking.c:588</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a213b026c5bb4a2421289b34e620eb4ef"><div class="ttname"><a href="structredis_mem_overhead.html#a213b026c5bb4a2421289b34e620eb4ef">redisMemOverhead::allocator_rss</a></div><div class="ttdeci">float allocator_rss</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00870">server.h:870</a></div></div>
<div class="ttc" id="structzskiplist_node_html_ac99cd495189c228ff8d538f04489805e"><div class="ttname"><a href="structzskiplist_node.html#ac99cd495189c228ff8d538f04489805e">zskiplistNode::ele</a></div><div class="ttdeci">sds ele</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00797">server.h:797</a></div></div>
<div class="ttc" id="server_8h_html_a8c356422ddbc03bd77694880a30a1953"><div class="ttname"><a href="server_8h.html#a8c356422ddbc03bd77694880a30a1953">OBJ_ZSET</a></div><div class="ttdeci">#define OBJ_ZSET</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00469">server.h:469</a></div></div>
<div class="ttc" id="evict_8c_html_a4b537077f1fe662170675678d354d93c"><div class="ttname"><a href="evict_8c.html#a4b537077f1fe662170675678d354d93c">LFUGetTimeInMinutes</a></div><div class="ttdeci">unsigned long LFUGetTimeInMinutes(void)</div><div class="ttdef"><b>Definition:</b> <a href="evict_8c_source.html#l00299">evict.c:299</a></div></div>
<div class="ttc" id="object_8c_html_a3e762d5fac271c94b01875920ff57fb2"><div class="ttname"><a href="object_8c.html#a3e762d5fac271c94b01875920ff57fb2">OBJ_ENCODING_EMBSTR_SIZE_LIMIT</a></div><div class="ttdeci">#define OBJ_ENCODING_EMBSTR_SIZE_LIMIT</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00118">object.c:118</a></div></div>
<div class="ttc" id="object_8c_html_aae30d790d50c2301ada8c68f9c554dd6"><div class="ttname"><a href="object_8c.html#aae30d790d50c2301ada8c68f9c554dd6">freeHashObject</a></div><div class="ttdeci">void freeHashObject(robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00325">object.c:325</a></div></div>
<div class="ttc" id="structzskiplist_node_1_1zskiplist_level_html_aaa7319c399716d20dfa04890a648f04a"><div class="ttname"><a href="structzskiplist_node_1_1zskiplist_level.html#aaa7319c399716d20dfa04890a648f04a">zskiplistNode::zskiplistLevel::forward</a></div><div class="ttdeci">struct zskiplistNode * forward</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00801">server.h:801</a></div></div>
<div class="ttc" id="structstream_html"><div class="ttname"><a href="structstream.html">stream</a></div><div class="ttdef"><b>Definition:</b> <a href="stream_8h_source.html#l00016">stream.h:16</a></div></div>
<div class="ttc" id="structredis_object_html_afa65f328561a1fb0d243d9be5d7f37dd"><div class="ttname"><a href="structredis_object.html#afa65f328561a1fb0d243d9be5d7f37dd">redisObject::type</a></div><div class="ttdeci">unsigned type</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00604">server.h:604</a></div></div>
<div class="ttc" id="evict_8c_html_ae9e90615ee90c071a3fcade8ec7c72b3"><div class="ttname"><a href="evict_8c.html#ae9e90615ee90c071a3fcade8ec7c72b3">LRU_CLOCK</a></div><div class="ttdeci">unsigned int LRU_CLOCK(void)</div><div class="ttdef"><b>Definition:</b> <a href="evict_8c_source.html#l00078">evict.c:78</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a8747868103d88dad18f00837aaeca24a"><div class="ttname"><a href="structredis_mem_overhead.html#a8747868103d88dad18f00837aaeca24a">redisMemOverhead::dataset</a></div><div class="ttdeci">size_t dataset</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00861">server.h:861</a></div></div>
<div class="ttc" id="structstream_consumer_html_a2fc8aed22096d11568cb29885cf08cb2"><div class="ttname"><a href="structstream_consumer.html#a2fc8aed22096d11568cb29885cf08cb2">streamConsumer::pel</a></div><div class="ttdeci">rax * pel</div><div class="ttdef"><b>Definition:</b> <a href="stream_8h_source.html#l00072">stream.h:72</a></div></div>
<div class="ttc" id="quicklist_8h_html_ad4ba8011cebbeb7d38053e29638c3e05"><div class="ttname"><a href="quicklist_8h.html#ad4ba8011cebbeb7d38053e29638c3e05">quicklistNode</a></div><div class="ttdeci">struct quicklistNode quicklistNode</div></div>
<div class="ttc" id="structredis_mem_overhead_html"><div class="ttname"><a href="structredis_mem_overhead.html">redisMemOverhead</a></div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00851">server.h:851</a></div></div>
<div class="ttc" id="structdict_entry_html"><div class="ttname"><a href="structdict_entry.html">dictEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="dict_8h_source.html#l00047">dict.h:47</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_ad441a7ae10a5fee32c6d0b0dbfc92791"><div class="ttname"><a href="structredis_mem_overhead.html#ad441a7ae10a5fee32c6d0b0dbfc92791">redisMemOverhead::aof_buffer</a></div><div class="ttdeci">size_t aof_buffer</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00858">server.h:858</a></div></div>
<div class="ttc" id="server_8h_html_a65236ea160f69cdef33ec942092af88f"><div class="ttname"><a href="server_8h.html#a65236ea160f69cdef33ec942092af88f">OBJ_STRING</a></div><div class="ttdeci">#define OBJ_STRING</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00466">server.h:466</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a5e5705378e7ceb2bcfa33b637a7a6fd2"><div class="ttname"><a href="structredis_mem_overhead.html#a5e5705378e7ceb2bcfa33b637a7a6fd2">redisMemOverhead::total_frag_bytes</a></div><div class="ttdeci">size_t total_frag_bytes</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00867">server.h:867</a></div></div>
<div class="ttc" id="server_8h_html_a87c05ba4f7f36741864277f02a4423fb"><div class="ttname"><a href="server_8h.html#a87c05ba4f7f36741864277f02a4423fb">OBJ_HASH</a></div><div class="ttdeci">#define OBJ_HASH</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00470">server.h:470</a></div></div>
<div class="ttc" id="struct_redis_module_type_html"><div class="ttname"><a href="struct_redis_module_type.html">RedisModuleType</a></div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00511">server.h:511</a></div></div>
<div class="ttc" id="structrax_html_abbdb3a945f35e1cd7a50bcabf1bb6828"><div class="ttname"><a href="structrax.html#abbdb3a945f35e1cd7a50bcabf1bb6828">rax::numnodes</a></div><div class="ttdeci">uint64_t numnodes</div><div class="ttdef"><b>Definition:</b> <a href="rax_8h_source.html#l00136">rax.h:136</a></div></div>
<div class="ttc" id="dict_8c_html_a2e3683dd52e527ad0df8d203d8943fb6"><div class="ttname"><a href="dict_8c.html#a2e3683dd52e527ad0df8d203d8943fb6">dictCreate</a></div><div class="ttdeci">dict * dictCreate(dictType *type, void *privDataPtr)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8c_source.html#l00111">dict.c:111</a></div></div>
<div class="ttc" id="structquicklist_html_af2e72f8a5bf4bcdb77566c2936d5f13d"><div class="ttname"><a href="structquicklist.html#af2e72f8a5bf4bcdb77566c2936d5f13d">quicklist::len</a></div><div class="ttdeci">unsigned long len</div><div class="ttdef"><b>Definition:</b> <a href="quicklist_8h_source.html#l00077">quicklist.h:77</a></div></div>
<div class="ttc" id="ziplist_8c_html_a732833b234259c9c9b3d0dfd859f4f97"><div class="ttname"><a href="ziplist_8c.html#a732833b234259c9c9b3d0dfd859f4f97">ziplistNew</a></div><div class="ttdeci">unsigned char * ziplistNew(void)</div><div class="ttdef"><b>Definition:</b> <a href="ziplist_8c_source.html#l00578">ziplist.c:578</a></div></div>
<div class="ttc" id="sds_8c_html_a9153a5245ad08630651c7f4f212b5c6f"><div class="ttname"><a href="sds_8c.html#a9153a5245ad08630651c7f4f212b5c6f">sdscat</a></div><div class="ttdeci">sds sdscat(sds s, const char *t)</div><div class="ttdef"><b>Definition:</b> <a href="sds_8c_source.html#l00408">sds.c:408</a></div></div>
<div class="ttc" id="adlist_8c_html_ae35a3ee8d5580afa77f9f5430837d8a4"><div class="ttname"><a href="adlist_8c.html#ae35a3ee8d5580afa77f9f5430837d8a4">listRewind</a></div><div class="ttdeci">void listRewind(list *list, listIter *li)</div><div class="ttdef"><b>Definition:</b> <a href="adlist_8c_source.html#l00205">adlist.c:205</a></div></div>
<div class="ttc" id="structredis_object_html_adecc103e438ee35843ae312812d974a0"><div class="ttname"><a href="structredis_object.html#adecc103e438ee35843ae312812d974a0">redisObject::encoding</a></div><div class="ttdeci">unsigned encoding</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00605">server.h:605</a></div></div>
<div class="ttc" id="sds_8c_html_a500e60fc7a55cfcc571348ed422ba1de"><div class="ttname"><a href="sds_8c.html#a500e60fc7a55cfcc571348ed422ba1de">sdsfromlonglong</a></div><div class="ttdeci">sds sdsfromlonglong(long long value)</div><div class="ttdef"><b>Definition:</b> <a href="sds_8c_source.html#l00510">sds.c:510</a></div></div>
<div class="ttc" id="networking_8c_html_a0ea8df2930509a88eb4e98348b85a51d"><div class="ttname"><a href="networking_8c.html#a0ea8df2930509a88eb4e98348b85a51d">addReplyError</a></div><div class="ttdeci">void addReplyError(client *c, const char *err)</div><div class="ttdef"><b>Definition:</b> <a href="networking_8c_source.html#l00384">networking.c:384</a></div></div>
<div class="ttc" id="structquicklist_html"><div class="ttname"><a href="structquicklist.html">quicklist</a></div><div class="ttdef"><b>Definition:</b> <a href="quicklist_8h_source.html#l00073">quicklist.h:73</a></div></div>
<div class="ttc" id="evict_8c_html_a9f342de41fcca27af0539524ab2cf97d"><div class="ttname"><a href="evict_8c.html#a9f342de41fcca27af0539524ab2cf97d">LFUDecrAndReturn</a></div><div class="ttdeci">unsigned long LFUDecrAndReturn(robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="evict_8c_source.html#l00335">evict.c:335</a></div></div>
<div class="ttc" id="server_8c_html_ae8605e2b78cd4a81b6c6b5c30cb7366a"><div class="ttname"><a href="server_8c.html#ae8605e2b78cd4a81b6c6b5c30cb7366a">usage</a></div><div class="ttdeci">void usage(void)</div><div class="ttdef"><b>Definition:</b> <a href="server_8c_source.html#l03727">server.c:3727</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_ac8bdd246c25c91aa5ae7af8362ff9188"><div class="ttname"><a href="structredis_mem_overhead.html#ac8bdd246c25c91aa5ae7af8362ff9188">redisMemOverhead::total_frag</a></div><div class="ttdeci">float total_frag</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00866">server.h:866</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a2a959b51b26f4ced3ab179af23f19fba"><div class="ttname"><a href="structredis_mem_overhead.html#a2a959b51b26f4ced3ab179af23f19fba">redisMemOverhead::overhead_total</a></div><div class="ttdeci">size_t overhead_total</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00860">server.h:860</a></div></div>
<div class="ttc" id="struct_redis_module_type_html_a966c47580ef5f4abf50e4109df7168ad"><div class="ttname"><a href="struct_redis_module_type.html#a966c47580ef5f4abf50e4109df7168ad">RedisModuleType::free</a></div><div class="ttdeci">moduleTypeFreeFunc free</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00519">server.h:519</a></div></div>
<div class="ttc" id="stream_8h_html_ae56cb2569f04ff411da836b3e13b486d"><div class="ttname"><a href="stream_8h.html#ae56cb2569f04ff411da836b3e13b486d">streamNACK</a></div><div class="ttdeci">struct streamNACK streamNACK</div></div>
<div class="ttc" id="object_8c_html_ae6b84426afc2eaecaffcaa0628fa5a47"><div class="ttname"><a href="object_8c.html#ae6b84426afc2eaecaffcaa0628fa5a47">compareStringObjectsWithFlags</a></div><div class="ttdeci">int compareStringObjectsWithFlags(robj *a, robj *b, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00528">object.c:528</a></div></div>
<div class="ttc" id="server_8h_html_a4a5f22a280949c97a0cb0d4213275126"><div class="ttname"><a href="server_8h.html#a4a5f22a280949c97a0cb0d4213275126">OBJ_LIST</a></div><div class="ttdeci">#define OBJ_LIST</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00467">server.h:467</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a52004d56324eaeaabb6686b05052ca55"><div class="ttname"><a href="structredis_mem_overhead.html#a52004d56324eaeaabb6686b05052ca55">redisMemOverhead::peak_allocated</a></div><div class="ttdeci">size_t peak_allocated</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00852">server.h:852</a></div></div>
<div class="ttc" id="struct_redis_module_type_html_ae3702833db2444b2ec958b5116dc00d3"><div class="ttname"><a href="struct_redis_module_type.html#ae3702833db2444b2ec958b5116dc00d3">RedisModuleType::mem_usage</a></div><div class="ttdeci">moduleTypeMemUsageFunc mem_usage</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00517">server.h:517</a></div></div>
<div class="ttc" id="structshared_objects_struct_html_aff4b27537592388d89ec9788325cc134"><div class="ttname"><a href="structshared_objects_struct.html#aff4b27537592388d89ec9788325cc134">sharedObjectsStruct::syntaxerr</a></div><div class="ttdeci">robj * syntaxerr</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00780">server.h:780</a></div></div>
<div class="ttc" id="dict_8c_html_ad6a0d56f36a07445b16ffedcf5aec005"><div class="ttname"><a href="dict_8c.html#ad6a0d56f36a07445b16ffedcf5aec005">dictRelease</a></div><div class="ttdeci">void dictRelease(dict *d)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8c_source.html#l00469">dict.c:469</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a9cafe99c292b52f795f9ceef838f4249"><div class="ttname"><a href="structredis_mem_overhead.html#a9cafe99c292b52f795f9ceef838f4249">redisMemOverhead::rss_extra_bytes</a></div><div class="ttdeci">size_t rss_extra_bytes</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00873">server.h:873</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a3bb14855f7c280e92d0c01bbbc9b4c3c"><div class="ttname"><a href="structredis_mem_overhead.html#a3bb14855f7c280e92d0c01bbbc9b4c3c">redisMemOverhead::total_allocated</a></div><div class="ttdeci">size_t total_allocated</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00853">server.h:853</a></div></div>
<div class="ttc" id="sds_8c_html_a151062948f5ba54c50936e5d5317c417"><div class="ttname"><a href="sds_8c.html#a151062948f5ba54c50936e5d5317c417">sdsnewlen</a></div><div class="ttdeci">sds sdsnewlen(const void *init, size_t initlen)</div><div class="ttdef"><b>Definition:</b> <a href="sds_8c_source.html#l00089">sds.c:89</a></div></div>
<div class="ttc" id="dict_8h_html_ae8d2cc391873b2bea2b87c4f80f43120"><div class="ttname"><a href="dict_8h.html#ae8d2cc391873b2bea2b87c4f80f43120">dictGetVal</a></div><div class="ttdeci">#define dictGetVal(he)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8h_source.html#l00142">dict.h:142</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_ae1d7b7b42904d9ebb1698ab3ac79a2e9"><div class="ttname"><a href="structredis_mem_overhead.html#ae1d7b7b42904d9ebb1698ab3ac79a2e9">redisMemOverhead::rss_extra</a></div><div class="ttdeci">float rss_extra</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00872">server.h:872</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_aa8888087ab630e5da0b3a0e179298d86"><div class="ttname"><a href="structredis_mem_overhead.html#aa8888087ab630e5da0b3a0e179298d86">redisMemOverhead::bytes_per_key</a></div><div class="ttdeci">size_t bytes_per_key</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00863">server.h:863</a></div></div>
<div class="ttc" id="util_8c_html_ae96ca73089ed65eac700a6241bd52266"><div class="ttname"><a href="util_8c.html#ae96ca73089ed65eac700a6241bd52266">sdigits10</a></div><div class="ttdeci">uint32_t sdigits10(int64_t v)</div><div class="ttdef"><b>Definition:</b> <a href="util_8c_source.html#l00255">util.c:255</a></div></div>
<div class="ttc" id="structredis_server_html_a6a317d8f5c5ed50aa4c4756bb5e95ee9"><div class="ttname"><a href="structredis_server.html#a6a317d8f5c5ed50aa4c4756bb5e95ee9">redisServer::slaves</a></div><div class="ttdeci">list * slaves</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00974">server.h:974</a></div></div>
<div class="ttc" id="structredis_mem_overhead_html_a4377a6a963ee32e22c7c7f14180a4a31"><div class="ttname"><a href="structredis_mem_overhead.html#a4377a6a963ee32e22c7c7f14180a4a31">redisMemOverhead::repl_backlog</a></div><div class="ttdeci">size_t repl_backlog</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00855">server.h:855</a></div></div>
<div class="ttc" id="stream_8h_html_ad7e8b00284de80524315e851a3027ac2"><div class="ttname"><a href="stream_8h.html#ad7e8b00284de80524315e851a3027ac2">streamID</a></div><div class="ttdeci">struct streamID streamID</div></div>
<div class="ttc" id="dict_8h_html_af193430dd3d5579a52b194512f72c1f0"><div class="ttname"><a href="dict_8h.html#af193430dd3d5579a52b194512f72c1f0">dictSize</a></div><div class="ttdeci">#define dictSize(d)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8h_source.html#l00147">dict.h:147</a></div></div>
<div class="ttc" id="server_8h_html_aec792aeed6d4bf83966672e6a23043b8"><div class="ttname"><a href="server_8h.html#aec792aeed6d4bf83966672e6a23043b8">OBJ_ENCODING_QUICKLIST</a></div><div class="ttdeci">#define OBJ_ENCODING_QUICKLIST</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00595">server.h:595</a></div></div>
<div class="ttc" id="object_8c_html_aa84594b5dd7a5dda8201c15c85b1457a"><div class="ttname"><a href="object_8c.html#aa84594b5dd7a5dda8201c15c85b1457a">incrRefCount</a></div><div class="ttdeci">void incrRefCount(robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00349">object.c:349</a></div></div>
<div class="ttc" id="structmodule_value_html"><div class="ttname"><a href="structmodule_value.html">moduleValue</a></div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00538">server.h:538</a></div></div>
<div class="ttc" id="server_8h_html_a1dc2a137875b0c8ee0fa1df43684a7b8"><div class="ttname"><a href="server_8h.html#a1dc2a137875b0c8ee0fa1df43684a7b8">OBJ_SHARED_REFCOUNT</a></div><div class="ttdeci">#define OBJ_SHARED_REFCOUNT</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00602">server.h:602</a></div></div>
<div class="ttc" id="stream_8h_html_a7273f6aa620d8e38a087bf59dd070547"><div class="ttname"><a href="stream_8h.html#a7273f6aa620d8e38a087bf59dd070547">freeStream</a></div><div class="ttdeci">void freeStream(stream *s)</div><div class="ttdef"><b>Definition:</b> <a href="t__stream_8c_source.html#l00063">t_stream.c:63</a></div></div>
<div class="ttc" id="object_8c_html_ade9e166ea7caa357b0f742e63ba37c7f"><div class="ttname"><a href="object_8c.html#ade9e166ea7caa357b0f742e63ba37c7f">getLongLongFromObject</a></div><div class="ttdeci">int getLongLongFromObject(robj *o, long long *target)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00678">object.c:678</a></div></div>
<div class="ttc" id="dict_8c_html_a4d5d9616ce7b918632afcc9bd03f6a90"><div class="ttname"><a href="dict_8c.html#a4d5d9616ce7b918632afcc9bd03f6a90">dictFind</a></div><div class="ttdeci">dictEntry * dictFind(dict *d, const void *key)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8c_source.html#l00476">dict.c:476</a></div></div>
<div class="ttc" id="structmalloc__stats_html_a93e17e92b02c3ad2a4e6bf903154b3d2"><div class="ttname"><a href="structmalloc__stats.html#a93e17e92b02c3ad2a4e6bf903154b3d2">malloc_stats::process_rss</a></div><div class="ttdeci">size_t process_rss</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00904">server.h:904</a></div></div>
<div class="ttc" id="structredis_object_html_a6022c8a609170c7365fb96e83cb2df48"><div class="ttname"><a href="structredis_object.html#a6022c8a609170c7365fb96e83cb2df48">redisObject::refcount</a></div><div class="ttdeci">int refcount</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00609">server.h:609</a></div></div>
<div class="ttc" id="structredis_server_html_a98440b0fba87820830ee90965c9f54f4"><div class="ttname"><a href="structredis_server.html#a98440b0fba87820830ee90965c9f54f4">redisServer::maxmemory_policy</a></div><div class="ttdeci">int maxmemory_policy</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l01185">server.h:1185</a></div></div>
<div class="ttc" id="object_8c_html_a2fbd492cd9e05cd09febb2d82aeb695b"><div class="ttname"><a href="object_8c.html#a2fbd492cd9e05cd09febb2d82aeb695b">getLongDoubleFromObjectOrReply</a></div><div class="ttdeci">int getLongDoubleFromObjectOrReply(client *c, robj *o, long double *target, const char *msg)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00664">object.c:664</a></div></div>
<div class="ttc" id="dict_8c_html_a63b2ad9054199271795e33d67fb6d6da"><div class="ttname"><a href="dict_8c.html#a63b2ad9054199271795e33d67fb6d6da">dictGetIterator</a></div><div class="ttdeci">dictIterator * dictGetIterator(dict *d)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8c_source.html#l00542">dict.c:542</a></div></div>
<div class="ttc" id="structredis_server_html_a9bee04e09635a42fef289e42a89f5502"><div class="ttname"><a href="structredis_server.html#a9bee04e09635a42fef289e42a89f5502">redisServer::db</a></div><div class="ttdeci">redisDb * db</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00937">server.h:937</a></div></div>
<div class="ttc" id="structredis_server_html_a61642879c8697309e0a0b1f8e27d79a0"><div class="ttname"><a href="structredis_server.html#a61642879c8697309e0a0b1f8e27d79a0">redisServer::repl_scriptcache_fifo</a></div><div class="ttdeci">list * repl_scriptcache_fifo</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l01177">server.h:1177</a></div></div>
<div class="ttc" id="sds_8c_html_a12cf0d8aca38e55eef468cc0265ef473"><div class="ttname"><a href="sds_8c.html#a12cf0d8aca38e55eef468cc0265ef473">sdsRemoveFreeSpace</a></div><div class="ttdeci">sds sdsRemoveFreeSpace(sds s)</div><div class="ttdef"><b>Definition:</b> <a href="sds_8c_source.html#l00255">sds.c:255</a></div></div>
<div class="ttc" id="structstream_consumer_html_a78d661a433637c5e0fac8a377e3ddeb6"><div class="ttname"><a href="structstream_consumer.html#a78d661a433637c5e0fac8a377e3ddeb6">streamConsumer::name</a></div><div class="ttdeci">sds name</div><div class="ttdef"><b>Definition:</b> <a href="stream_8h_source.html#l00069">stream.h:69</a></div></div>
<div class="ttc" id="sds_8c_html_a2f541b6443d075056a706b5b666066af"><div class="ttname"><a href="sds_8c.html#a2f541b6443d075056a706b5b666066af">sdscatprintf</a></div><div class="ttdeci">sds sdscatprintf(sds s, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="sds_8c_source.html#l00571">sds.c:571</a></div></div>
<div class="ttc" id="object_8c_html_a860552c3f312632c9481eb8fdc5108bb"><div class="ttname"><a href="object_8c.html#a860552c3f312632c9481eb8fdc5108bb">freeZsetObject</a></div><div class="ttdeci">void freeZsetObject(robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00308">object.c:308</a></div></div>
<div class="ttc" id="structredis_db_html_af8dcf36ca4b084db164becc8e1c71b67"><div class="ttname"><a href="structredis_db.html#af8dcf36ca4b084db164becc8e1c71b67">redisDb::expires</a></div><div class="ttdeci">dict * expires</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00638">server.h:638</a></div></div>
<div class="ttc" id="structstream_c_g_html"><div class="ttname"><a href="structstream_c_g.html">streamCG</a></div><div class="ttdef"><b>Definition:</b> <a href="stream_8h_source.html#l00051">stream.h:51</a></div></div>
<div class="ttc" id="server_8h_html_a8d179375a4aac33d3fa7aa80c8ccc75f"><div class="ttname"><a href="server_8h.html#a8d179375a4aac33d3fa7aa80c8ccc75f">OBJ_SET</a></div><div class="ttdeci">#define OBJ_SET</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00468">server.h:468</a></div></div>
<div class="ttc" id="structmalloc__stats_html_abaf85ea7348d3c27fea44dcc7cebd639"><div class="ttname"><a href="structmalloc__stats.html#abaf85ea7348d3c27fea44dcc7cebd639">malloc_stats::allocator_resident</a></div><div class="ttdeci">size_t allocator_resident</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00907">server.h:907</a></div></div>
<div class="ttc" id="structzset_html_a38454c6ad0755efc07170e913ec10b5a"><div class="ttname"><a href="structzset.html#a38454c6ad0755efc07170e913ec10b5a">zset::zsl</a></div><div class="ttdeci">zskiplist * zsl</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00814">server.h:814</a></div></div>
<div class="ttc" id="object_8c_html_ac672f1c478e4a045035444729510d946"><div class="ttname"><a href="object_8c.html#ac672f1c478e4a045035444729510d946">REDIS_COMPARE_BINARY</a></div><div class="ttdeci">#define REDIS_COMPARE_BINARY</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00525">object.c:525</a></div></div>
<div class="ttc" id="object_8c_html_a8362c0e483b38b8debe5979f4dbe883b"><div class="ttname"><a href="object_8c.html#a8362c0e483b38b8debe5979f4dbe883b">decrRefCountVoid</a></div><div class="ttdeci">void decrRefCountVoid(void *o)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00375">object.c:375</a></div></div>
<div class="ttc" id="networking_8c_html_a774d738883e0b621147923b2b4d44282"><div class="ttname"><a href="networking_8c.html#a774d738883e0b621147923b2b4d44282">sdsZmallocSize</a></div><div class="ttdeci">size_t sdsZmallocSize(sds s)</div><div class="ttdef"><b>Definition:</b> <a href="networking_8c_source.html#l00041">networking.c:41</a></div></div>
<div class="ttc" id="object_8c_html_a39155431bb51f438f1e38f0ec06366a2"><div class="ttname"><a href="object_8c.html#a39155431bb51f438f1e38f0ec06366a2">getLongLongFromObjectOrReply</a></div><div class="ttdeci">int getLongLongFromObjectOrReply(client *c, robj *o, long long *target, const char *msg)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00697">object.c:697</a></div></div>
<div class="ttc" id="aof_8c_html_ac13e9eab03e6ba37d7567e805b54e12f"><div class="ttname"><a href="aof_8c.html#ac13e9eab03e6ba37d7567e805b54e12f">aofRewriteBufferSize</a></div><div class="ttdeci">unsigned long aofRewriteBufferSize(void)</div><div class="ttdef"><b>Definition:</b> <a href="aof_8c_source.html#l00079">aof.c:79</a></div></div>
<div class="ttc" id="server_8h_html_ae934cf008a0be0ef009c92c2d006a816"><div class="ttname"><a href="server_8h.html#ae934cf008a0be0ef009c92c2d006a816">OBJ_ENCODING_INT</a></div><div class="ttdeci">#define OBJ_ENCODING_INT</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00587">server.h:587</a></div></div>
<div class="ttc" id="zmalloc_8c_html_aa841265e1d698c82d390308cb5dd0051"><div class="ttname"><a href="zmalloc_8c.html#aa841265e1d698c82d390308cb5dd0051">zmalloc_size</a></div><div class="ttdeci">size_t zmalloc_size(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="zmalloc_8c_source.html#l00177">zmalloc.c:177</a></div></div>
<div class="ttc" id="structredis_server_html_a7f3d3d90cccad86c685008f3f02492fe"><div class="ttname"><a href="structredis_server.html#a7f3d3d90cccad86c685008f3f02492fe">redisServer::lua_scripts</a></div><div class="ttdeci">dict * lua_scripts</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l01245">server.h:1245</a></div></div>
<div class="ttc" id="object_8c_html_a69038fedc976828a3dfc5f106c478544"><div class="ttname"><a href="object_8c.html#a69038fedc976828a3dfc5f106c478544">tryObjectEncoding</a></div><div class="ttdeci">robj * tryObjectEncoding(robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00419">object.c:419</a></div></div>
<div class="ttc" id="server_8h_html_afc6f1280f32cbb707bf231806ea3b884"><div class="ttname"><a href="server_8h.html#afc6f1280f32cbb707bf231806ea3b884">zset</a></div><div class="ttdeci">struct zset zset</div></div>
<div class="ttc" id="server_8h_html_afcfb5bd97af52d1dbce331745cae030c"><div class="ttname"><a href="server_8h.html#afcfb5bd97af52d1dbce331745cae030c">sdsEncodedObject</a></div><div class="ttdeci">#define sdsEncodedObject(objptr)</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l01564">server.h:1564</a></div></div>
<div class="ttc" id="server_8c_html_a9ace62050a85a5451725d854408867df"><div class="ttname"><a href="server_8c.html#a9ace62050a85a5451725d854408867df">lru_clock</a></div><div class="ttdeci">volatile unsigned long lru_clock</div><div class="ttdef"><b>Definition:</b> <a href="server_8c_source.html#l00073">server.c:73</a></div></div>
<div class="ttc" id="server_8h_html_a2c2cc41300ca6b9daca7ea8a6d66edc6"><div class="ttname"><a href="server_8h.html#a2c2cc41300ca6b9daca7ea8a6d66edc6">OBJ_STREAM</a></div><div class="ttdeci">#define OBJ_STREAM</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00484">server.h:484</a></div></div>
<div class="ttc" id="structrax_iterator_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="structrax_iterator.html#a735984d41155bc1032e09bece8f8d66d">raxIterator::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="rax_8h_source.html#l00179">rax.h:179</a></div></div>
<div class="ttc" id="structredis_server_html_a9142dcad31984d994f392be24e91daff"><div class="ttname"><a href="structredis_server.html#a9142dcad31984d994f392be24e91daff">redisServer::aof_state</a></div><div class="ttdeci">int aof_state</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l01053">server.h:1053</a></div></div>
<div class="ttc" id="object_8c_html_a58920b17e6783e82f49a2baba4261093"><div class="ttname"><a href="object_8c.html#a58920b17e6783e82f49a2baba4261093">createSetObject</a></div><div class="ttdeci">robj * createSetObject(void)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00228">object.c:228</a></div></div>
<div class="ttc" id="object_8c_html_a6bdcf469e2903315a2ecf46c2e058e1c"><div class="ttname"><a href="object_8c.html#a6bdcf469e2903315a2ecf46c2e058e1c">freeStreamObject</a></div><div class="ttdeci">void freeStreamObject(robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00345">object.c:345</a></div></div>
<div class="ttc" id="structshared_objects_struct_html_a9b39b9335155d55eb2e631def6827b82"><div class="ttname"><a href="structshared_objects_struct.html#a9b39b9335155d55eb2e631def6827b82">sharedObjectsStruct::nullbulk</a></div><div class="ttdeci">robj * nullbulk</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00780">server.h:780</a></div></div>
<div class="ttc" id="structredis_server_html_a4a23db6c6bac41afb7aee155283dbf9b"><div class="ttname"><a href="structredis_server.html#a4a23db6c6bac41afb7aee155283dbf9b">redisServer::dbnum</a></div><div class="ttdeci">int dbnum</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l01047">server.h:1047</a></div></div>
<div class="ttc" id="server_8h_html_a148bc85e3074e324a6dc5eebcad1bcd5"><div class="ttname"><a href="server_8h.html#a148bc85e3074e324a6dc5eebcad1bcd5">OBJ_ENCODING_RAW</a></div><div class="ttdeci">#define OBJ_ENCODING_RAW</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00586">server.h:586</a></div></div>
<div class="ttc" id="object_8c_html_a03474153296385df26f24b265d2a22eb"><div class="ttname"><a href="object_8c.html#a03474153296385df26f24b265d2a22eb">decrRefCount</a></div><div class="ttdeci">void decrRefCount(robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00353">object.c:353</a></div></div>
<div class="ttc" id="structzskiplist_node_html"><div class="ttname"><a href="structzskiplist_node.html">zskiplistNode</a></div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00796">server.h:796</a></div></div>
<div class="ttc" id="server_8c_html_a3b638a07aaedd8dc871d0bbd18a662b6"><div class="ttname"><a href="server_8c.html#a3b638a07aaedd8dc871d0bbd18a662b6">zsetDictType</a></div><div class="ttdeci">dictType zsetDictType</div><div class="ttdef"><b>Definition:</b> <a href="server_8c_source.html#l00602">server.c:602</a></div></div>
<div class="ttc" id="quicklist_8c_html_a75c42e6e2bf61575be3806910d0afea2"><div class="ttname"><a href="quicklist_8c.html#a75c42e6e2bf61575be3806910d0afea2">quicklistRelease</a></div><div class="ttdeci">void quicklistRelease(quicklist *quicklist)</div><div class="ttdef"><b>Definition:</b> <a href="quicklist_8c_source.html#l00155">quicklist.c:155</a></div></div>
<div class="ttc" id="object_8c_html_a3f9054ae0c2ce0a1fd35c1863d14177c"><div class="ttname"><a href="object_8c.html#a3f9054ae0c2ce0a1fd35c1863d14177c">objectComputeSize</a></div><div class="ttdeci">size_t objectComputeSize(robj *o, size_t sample_size)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00772">object.c:772</a></div></div>
<div class="ttc" id="server_8h_html_a8ed2d5ecb3c5343c4286f9c3a2346045"><div class="ttname"><a href="server_8h.html#a8ed2d5ecb3c5343c4286f9c3a2346045">OBJ_ENCODING_STREAM</a></div><div class="ttdeci">#define OBJ_ENCODING_STREAM</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00596">server.h:596</a></div></div>
<div class="ttc" id="dict_8h_html_a950194070759a1e4bbdf8e107bec7df1"><div class="ttname"><a href="dict_8h.html#a950194070759a1e4bbdf8e107bec7df1">dictEntry</a></div><div class="ttdeci">struct dictEntry dictEntry</div></div>
<div class="ttc" id="object_8c_html_a94b3dee86e33a84f45d37fc957227559"><div class="ttname"><a href="object_8c.html#a94b3dee86e33a84f45d37fc957227559">createStringObjectFromLongLongForValue</a></div><div class="ttdeci">robj * createStringObjectFromLongLongForValue(long long value)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00169">object.c:169</a></div></div>
<div class="ttc" id="structredis_server_html_a268febb2b0b1add2594f2d7c8999567e"><div class="ttname"><a href="structredis_server.html#a268febb2b0b1add2594f2d7c8999567e">redisServer::clients</a></div><div class="ttdeci">list * clients</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00971">server.h:971</a></div></div>
<div class="ttc" id="server_8h_html_a88114b5169b4c382df6b56506285e56a"><div class="ttname"><a href="server_8h.html#a88114b5169b4c382df6b56506285e56a">serverAssert</a></div><div class="ttdeci">#define serverAssert(_e)</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00456">server.h:456</a></div></div>
<div class="ttc" id="structmalloc__stats_html_a24fe6607486bb69f2f446830dbf6c8fb"><div class="ttname"><a href="structmalloc__stats.html#a24fe6607486bb69f2f446830dbf6c8fb">malloc_stats::zmalloc_used</a></div><div class="ttdeci">size_t zmalloc_used</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00903">server.h:903</a></div></div>
<div class="ttc" id="object_8c_html_a89772282d38fe17fe42ec0087c0e9bd5"><div class="ttname"><a href="object_8c.html#a89772282d38fe17fe42ec0087c0e9bd5">strEncoding</a></div><div class="ttdeci">char * strEncoding(int encoding)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00727">object.c:727</a></div></div>
<div class="ttc" id="server_8h_html_ae9f6995948253652bc9454d79a72f4a7"><div class="ttname"><a href="server_8h.html#ae9f6995948253652bc9454d79a72f4a7">CLIENT_SLAVE</a></div><div class="ttdeci">#define CLIENT_SLAVE</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00228">server.h:228</a></div></div>
<div class="ttc" id="structredis_db_html_aad961c2f260766ff3627bf363fef3551"><div class="ttname"><a href="structredis_db.html#aad961c2f260766ff3627bf363fef3551">redisDb::dict</a></div><div class="ttdeci">dict * dict</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00637">server.h:637</a></div></div>
<div class="ttc" id="structdict_iterator_html"><div class="ttname"><a href="structdict_iterator.html">dictIterator</a></div><div class="ttdef"><b>Definition:</b> <a href="dict_8h_source.html#l00088">dict.h:88</a></div></div>
<div class="ttc" id="dict_8c_html_ab51f7613d1fe7b63edecd24efbcc7d2b"><div class="ttname"><a href="dict_8c.html#ab51f7613d1fe7b63edecd24efbcc7d2b">dictNext</a></div><div class="ttdeci">dictEntry * dictNext(dictIterator *iter)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8c_source.html#l00562">dict.c:562</a></div></div>
<div class="ttc" id="structzskiplist_node_html_ab6e002b167ff0de655b16debe293180c"><div class="ttname"><a href="structzskiplist_node.html#ab6e002b167ff0de655b16debe293180c">zskiplistNode::level</a></div><div class="ttdeci">struct zskiplistNode::zskiplistLevel level[]</div></div>
<div class="ttc" id="object_8c_html_a4b47bf3e99f2b333ee7f6106c532d6b5"><div class="ttname"><a href="object_8c.html#a4b47bf3e99f2b333ee7f6106c532d6b5">objectCommandLookupOrReply</a></div><div class="ttdeci">robj * objectCommandLookupOrReply(client *c, robj *key, robj *reply)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l01229">object.c:1229</a></div></div>
<div class="ttc" id="object_8c_html_a869b8cea49f26cb18bf1138839696480"><div class="ttname"><a href="object_8c.html#a869b8cea49f26cb18bf1138839696480">stringObjectLen</a></div><div class="ttdeci">size_t stringObjectLen(robj *o)</div><div class="ttdef"><b>Definition:</b> <a href="object_8c_source.html#l00585">object.c:585</a></div></div>
<div class="ttc" id="structredis_server_html_ade120d8eb790ebd186e7c4468002177f"><div class="ttname"><a href="structredis_server.html#ade120d8eb790ebd186e7c4468002177f">redisServer::repl_scriptcache_dict</a></div><div class="ttdeci">dict * repl_scriptcache_dict</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l01176">server.h:1176</a></div></div>
<div class="ttc" id="structshared_objects_struct_html_a0a900c43b0635b0afef2c83d7def52c7"><div class="ttname"><a href="structshared_objects_struct.html#a0a900c43b0635b0afef2c83d7def52c7">sharedObjectsStruct::integers</a></div><div class="ttdeci">robj * integers[OBJ_SHARED_INTEGERS]</div><div class="ttdef"><b>Definition:</b> <a href="server_8h_source.html#l00780">server.h:780</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
